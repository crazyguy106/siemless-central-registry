version: '1.0'
vendor: Amazon Web Services
product: AWS WAF
product_full_name: AWS Web Application Firewall
log_type: structured
source_document: AWS WAF Logging Fields
source_url: https://docs.aws.amazon.com/waf/latest/developerguide/logging-fields.html
extraction_date: '2026-01-02'
source_file: aws-waf-signatures.json
generated_at: '2026-02-12T18:54:27.236361'
categories:
- TopLevel
- CaptchaChallenge
- ExcludedRules
- NonTerminating
- RateBased
- TerminatingRule
field_count: 57
fields:
- field_name: action
  field_type: string
  description: 'Terminating action: allow, block, CAPTCHA, or challenge'
  category: TopLevel
  ecs_field: event.action
  cim_field: action
  asim_field: EventType
- field_name: args
  field_type: string
  description: The query string
  category: TopLevel
  ecs_field: amazonwebservices.awswaf.args
  cim_field: amazonwebservices.awswaf.args
  asim_field: amazonwebservices.awswaf.args
- field_name: captchaResponse
  field_type: object
  description: CAPTCHA action status for the request
  category: TopLevel
  ecs_field: event.action
  cim_field: ''
  asim_field: ''
- field_name: captchaResponse.failureReason
  field_type: string
  description: CAPTCHA failure reason
  category: CaptchaChallenge
  ecs_field: event.reason
  cim_field: ''
  asim_field: ''
- field_name: captchaResponse.responseCode
  field_type: integer
  description: CAPTCHA response code
  category: CaptchaChallenge
  ecs_field: http.response.status_code
  cim_field: ''
  asim_field: ''
- field_name: captchaResponse.solveTimestamp
  field_type: integer
  description: CAPTCHA solve timestamp
  category: CaptchaChallenge
  ecs_field: amazonwebservices.awswaf.captcharesponse_solvetimestamp
  cim_field: amazonwebservices.awswaf.captcharesponse_solvetimestamp
  asim_field: amazonwebservices.awswaf.captcharesponse_solvetimestamp
- field_name: cfDistributionTenantId
  field_type: string
  description: CloudFront distribution tenant identifier
  category: TopLevel
  ecs_field: amazonwebservices.awswaf.cfdistributiontenantid
  cim_field: amazonwebservices.awswaf.cfdistributiontenantid
  asim_field: amazonwebservices.awswaf.cfdistributiontenantid
- field_name: challengeResponse
  field_type: object
  description: Challenge action status for the request
  category: TopLevel
  ecs_field: event.action
  cim_field: ''
  asim_field: ''
- field_name: challengeResponse.failureReason
  field_type: string
  description: Challenge failure reason
  category: CaptchaChallenge
  ecs_field: event.reason
  cim_field: ''
  asim_field: ''
- field_name: challengeResponse.responseCode
  field_type: integer
  description: Challenge response code
  category: CaptchaChallenge
  ecs_field: http.response.status_code
  cim_field: ''
  asim_field: ''
- field_name: challengeResponse.solveTimestamp
  field_type: integer
  description: Challenge solve timestamp
  category: CaptchaChallenge
  ecs_field: amazonwebservices.awswaf.challengeresponse_solvetimestamp
  cim_field: amazonwebservices.awswaf.challengeresponse_solvetimestamp
  asim_field: amazonwebservices.awswaf.challengeresponse_solvetimestamp
- field_name: clientAsn
  field_type: string
  description: ASN associated with the client IP address
  category: TopLevel
  ecs_field: source.ip
  cim_field: ''
  asim_field: ''
- field_name: clientIp
  field_type: ip
  description: IP address of the client sending the request
  category: TopLevel
  ecs_field: source.ip
  cim_field: ''
  asim_field: ''
- field_name: country
  field_type: string
  description: Source country of the request
  category: TopLevel
  ecs_field: source.geo.country_name
  cim_field: src_country
  asim_field: SrcGeoCountry
- field_name: excludedRules
  field_type: array
  description: List of rules excluded with Count action
  category: TopLevel
  ecs_field: event.action
  cim_field: ''
  asim_field: ''
- field_name: excludedRules.exclusionType
  field_type: string
  description: Type indicating rule has action Count
  category: ExcludedRules
  ecs_field: event.action
  cim_field: ''
  asim_field: ''
- field_name: excludedRules.ruleId
  field_type: string
  description: ID of excluded rule within rule group
  category: ExcludedRules
  ecs_field: amazonwebservices.awswaf.excludedrules_ruleid
  cim_field: amazonwebservices.awswaf.excludedrules_ruleid
  asim_field: amazonwebservices.awswaf.excludedrules_ruleid
- field_name: formatVersion
  field_type: string
  description: Format version for the log
  category: TopLevel
  ecs_field: amazonwebservices.awswaf.formatversion
  cim_field: amazonwebservices.awswaf.formatversion
  asim_field: amazonwebservices.awswaf.formatversion
- field_name: forwardedAsn
  field_type: string
  description: ASN of the forwarding entity
  category: TopLevel
  ecs_field: amazonwebservices.awswaf.forwardedasn
  cim_field: amazonwebservices.awswaf.forwardedasn
  asim_field: amazonwebservices.awswaf.forwardedasn
- field_name: fragment
  field_type: string
  description: 'URL fragment after # symbol'
  category: TopLevel
  ecs_field: url.full
  cim_field: ''
  asim_field: ''
- field_name: headers
  field_type: array
  description: List of request headers
  category: TopLevel
  ecs_field: amazonwebservices.awswaf.headers
  cim_field: amazonwebservices.awswaf.headers
  asim_field: amazonwebservices.awswaf.headers
- field_name: httpMethod
  field_type: string
  description: HTTP method in the request
  category: TopLevel
  ecs_field: http.request.method
  cim_field: ''
  asim_field: ''
- field_name: httpRequest
  field_type: object
  description: Metadata about the request
  category: TopLevel
  ecs_field: http.request.body.content
  cim_field: http_request
  asim_field: HttpRequestBody
- field_name: httpSourceId
  field_type: string
  description: ID of associated resource (CloudFront/ALB/API Gateway/etc.)
  category: TopLevel
  ecs_field: observer.id
  cim_field: http_source_id
  asim_field: DvcId
- field_name: httpSourceName
  field_type: string
  description: 'Source of request: CF, APIGW, ALB, APPSYNC, COGNITOIDP, APPRUNNER,
    VERIFIED_ACCESS'
  category: TopLevel
  ecs_field: observer.name
  cim_field: http_source
  asim_field: DvcHostname
- field_name: httpVersion
  field_type: string
  description: HTTP version
  category: TopLevel
  ecs_field: http.version
  cim_field: http_version
  asim_field: HttpVersion
- field_name: ja3Fingerprint
  field_type: string
  description: 32-char MD5 hash from TLS Client Hello
  category: TopLevel
  ecs_field: tls.client.ja3
  cim_field: ''
  asim_field: ''
- field_name: ja4Fingerprint
  field_type: string
  description: 36-char hash from TLS Client Hello
  category: TopLevel
  ecs_field: amazonwebservices.awswaf.ja4fingerprint
  cim_field: amazonwebservices.awswaf.ja4fingerprint
  asim_field: amazonwebservices.awswaf.ja4fingerprint
- field_name: labels
  field_type: array
  description: Labels applied by matching rules (first 100)
  category: TopLevel
  ecs_field: tags
  cim_field: tag
  asim_field: EventTag
- field_name: nonTerminatingMatchingRules
  field_type: array
  description: List of non-terminating rules that matched
  category: TopLevel
  ecs_field: amazonwebservices.awswaf.nonterminatingmatchingrules
  cim_field: amazonwebservices.awswaf.nonterminatingmatchingrules
  asim_field: amazonwebservices.awswaf.nonterminatingmatchingrules
- field_name: nonTerminatingMatchingRules.action
  field_type: string
  description: 'Action: count, CAPTCHA, or challenge'
  category: NonTerminating
  ecs_field: event.action
  cim_field: ''
  asim_field: ''
- field_name: nonTerminatingMatchingRules.ruleId
  field_type: string
  description: ID of matching non-terminating rule
  category: NonTerminating
  ecs_field: amazonwebservices.awswaf.nonterminatingmatchingrules_ruleid
  cim_field: amazonwebservices.awswaf.nonterminatingmatchingrules_ruleid
  asim_field: amazonwebservices.awswaf.nonterminatingmatchingrules_ruleid
- field_name: nonTerminatingMatchingRules.ruleMatchDetails
  field_type: array
  description: Match details for SQLi/XSS
  category: NonTerminating
  ecs_field: amazonwebservices.awswaf.nonterminatingmatchingrules_rulematchdetails
  cim_field: amazonwebservices.awswaf.nonterminatingmatchingrules_rulematchdetails
  asim_field: amazonwebservices.awswaf.nonterminatingmatchingrules_rulematchdetails
- field_name: oversizeFields
  field_type: array
  description: 'Fields over inspection limit: REQUEST_BODY, REQUEST_JSON_BODY, REQUEST_HEADERS,
    REQUEST_COOKIES'
  category: TopLevel
  ecs_field: amazonwebservices.awswaf.oversizefields
  cim_field: amazonwebservices.awswaf.oversizefields
  asim_field: amazonwebservices.awswaf.oversizefields
- field_name: rateBasedRuleList
  field_type: array
  description: List of rate-based rules that acted
  category: TopLevel
  ecs_field: amazonwebservices.awswaf.ratebasedrulelist
  cim_field: amazonwebservices.awswaf.ratebasedrulelist
  asim_field: amazonwebservices.awswaf.ratebasedrulelist
- field_name: rateBasedRuleList.customValues
  field_type: array
  description: Custom aggregation values
  category: RateBased
  ecs_field: amazonwebservices.awswaf.ratebasedrulelist_customvalues
  cim_field: amazonwebservices.awswaf.ratebasedrulelist_customvalues
  asim_field: amazonwebservices.awswaf.ratebasedrulelist_customvalues
- field_name: rateBasedRuleList.evaluationWindowSec
  field_type: integer
  description: Time window for request counts in seconds
  category: RateBased
  ecs_field: amazonwebservices.awswaf.ratebasedrulelist_evaluationwindowsec
  cim_field: amazonwebservices.awswaf.ratebasedrulelist_evaluationwindowsec
  asim_field: amazonwebservices.awswaf.ratebasedrulelist_evaluationwindowsec
- field_name: rateBasedRuleList.limitKey
  field_type: string
  description: 'Aggregation type: IP, FORWARDED_IP, CUSTOMKEYS, CONSTANT'
  category: RateBased
  ecs_field: amazonwebservices.awswaf.ratebasedrulelist_limitkey
  cim_field: amazonwebservices.awswaf.ratebasedrulelist_limitkey
  asim_field: amazonwebservices.awswaf.ratebasedrulelist_limitkey
- field_name: rateBasedRuleList.limitValue
  field_type: string
  description: Value for single IP rate limiting
  category: RateBased
  ecs_field: amazonwebservices.awswaf.ratebasedrulelist_limitvalue
  cim_field: amazonwebservices.awswaf.ratebasedrulelist_limitvalue
  asim_field: amazonwebservices.awswaf.ratebasedrulelist_limitvalue
- field_name: rateBasedRuleList.maxRateAllowed
  field_type: integer
  description: Max requests allowed in time window
  category: RateBased
  ecs_field: amazonwebservices.awswaf.ratebasedrulelist_maxrateallowed
  cim_field: amazonwebservices.awswaf.ratebasedrulelist_maxrateallowed
  asim_field: amazonwebservices.awswaf.ratebasedrulelist_maxrateallowed
- field_name: rateBasedRuleList.rateBasedRuleId
  field_type: string
  description: ID of rate-based rule
  category: RateBased
  ecs_field: amazonwebservices.awswaf.ratebasedrulelist_ratebasedruleid
  cim_field: amazonwebservices.awswaf.ratebasedrulelist_ratebasedruleid
  asim_field: amazonwebservices.awswaf.ratebasedrulelist_ratebasedruleid
- field_name: rateBasedRuleList.rateBasedRuleName
  field_type: string
  description: Name of rate-based rule
  category: RateBased
  ecs_field: amazonwebservices.awswaf.ratebasedrulelist_ratebasedrulename
  cim_field: amazonwebservices.awswaf.ratebasedrulelist_ratebasedrulename
  asim_field: amazonwebservices.awswaf.ratebasedrulelist_ratebasedrulename
- field_name: requestHeadersInserted
  field_type: array
  description: Headers inserted for custom request handling
  category: TopLevel
  ecs_field: amazonwebservices.awswaf.requestheadersinserted
  cim_field: amazonwebservices.awswaf.requestheadersinserted
  asim_field: amazonwebservices.awswaf.requestheadersinserted
- field_name: requestId
  field_type: string
  description: Request ID from underlying host service
  category: TopLevel
  ecs_field: event.id
  cim_field: ''
  asim_field: ''
- field_name: responseCodeSent
  field_type: string
  description: Response code sent with custom response
  category: TopLevel
  ecs_field: http.response.status_code
  cim_field: ''
  asim_field: ''
- field_name: ruleGroupId
  field_type: string
  description: ID of the rule group
  category: TopLevel
  ecs_field: amazonwebservices.awswaf.rulegroupid
  cim_field: amazonwebservices.awswaf.rulegroupid
  asim_field: amazonwebservices.awswaf.rulegroupid
- field_name: ruleGroupList
  field_type: array
  description: List of rule groups that acted on the request
  category: TopLevel
  ecs_field: amazonwebservices.awswaf.rulegrouplist
  cim_field: amazonwebservices.awswaf.rulegrouplist
  asim_field: amazonwebservices.awswaf.rulegrouplist
- field_name: terminatingRule
  field_type: object
  description: The rule that terminated the request
  category: TopLevel
  ecs_field: amazonwebservices.awswaf.terminatingrule
  cim_field: amazonwebservices.awswaf.terminatingrule
  asim_field: amazonwebservices.awswaf.terminatingrule
- field_name: terminatingRule.action
  field_type: string
  description: 'Action: allow, block, CAPTCHA, or challenge'
  category: TerminatingRule
  ecs_field: event.action
  cim_field: ''
  asim_field: ''
- field_name: terminatingRule.ruleId
  field_type: string
  description: ID of matching rule
  category: TerminatingRule
  ecs_field: amazonwebservices.awswaf.terminatingrule_ruleid
  cim_field: amazonwebservices.awswaf.terminatingrule_ruleid
  asim_field: amazonwebservices.awswaf.terminatingrule_ruleid
- field_name: terminatingRule.ruleMatchDetails
  field_type: array
  description: Match details for SQLi/XSS
  category: TerminatingRule
  ecs_field: amazonwebservices.awswaf.terminatingrule_rulematchdetails
  cim_field: amazonwebservices.awswaf.terminatingrule_rulematchdetails
  asim_field: amazonwebservices.awswaf.terminatingrule_rulematchdetails
- field_name: terminatingRuleId
  field_type: string
  description: ID of terminating rule (Default_Action if none)
  category: TopLevel
  ecs_field: event.action
  cim_field: ''
  asim_field: ''
- field_name: terminatingRuleMatchDetails
  field_type: array
  description: Details for SQL injection/XSS matches
  category: TopLevel
  ecs_field: amazonwebservices.awswaf.terminatingrulematchdetails
  cim_field: amazonwebservices.awswaf.terminatingrulematchdetails
  asim_field: amazonwebservices.awswaf.terminatingrulematchdetails
- field_name: terminatingRuleType
  field_type: string
  description: 'Type: RATE_BASED, REGULAR, GROUP, MANAGED_RULE_GROUP'
  category: TopLevel
  ecs_field: amazonwebservices.awswaf.terminatingruletype
  cim_field: amazonwebservices.awswaf.terminatingruletype
  asim_field: amazonwebservices.awswaf.terminatingruletype
- field_name: timestamp
  field_type: integer
  description: Timestamp in milliseconds
  category: TopLevel
  ecs_field: '@timestamp'
  cim_field: _time
  asim_field: EventTime
- field_name: uri
  field_type: string
  description: URI of the request
  category: TopLevel
  ecs_field: url.path
  cim_field: uri_path
  asim_field: UrlPath
- field_name: webaclId
  field_type: string
  description: GUID of the web ACL
  category: TopLevel
  ecs_field: amazonwebservices.awswaf.webaclid
  cim_field: amazonwebservices.awswaf.webaclid
  asim_field: amazonwebservices.awswaf.webaclid
mapped_field_count: 57
notes: AWS WAF logs capture detailed information about web requests inspected by WAF.
  Supports CloudFront, API Gateway, ALB, AppSync, Cognito, App Runner, and Verified
  Access.
