version: '1.0'
vendor: Squid Cache
product: Squid Proxy Access Logs
product_full_name: Squid Proxy Cache (logformat directive)
log_type: structured
source_document: 'Squid Configuration Directive: logformat'
source_url: http://www.squid-cache.org/Doc/config/logformat/
extraction_date: '2026-01-02'
source_file: squid-signatures.json
generated_at: '2026-02-13T09:25:26.238563'
categories:
- Connection
- Time
- HTTP
- SSL
- Size
- Headers
- Cache
- Adaptation
- Notes
- ICAP
field_count: 79
fields:
- field_name: '%>a'
  field_type: ip
  description: Client source IP address
  ecs_field: source.ip
  cim_field: src_ip
  asim_field: SrcIpAddr
  category: Connection
- field_name: '%>A'
  field_type: string
  description: Client FQDN (if resolved)
  ecs_field: source.ip
  cim_field: src_ip
  asim_field: SrcIpAddr
  category: Connection
- field_name: '%>p'
  field_type: integer
  description: Client source port
  ecs_field: source.port
  cim_field: src_port
  asim_field: SrcPortNumber
  category: Connection
- field_name: '%<a'
  field_type: ip
  description: Server/peer IP address
  ecs_field: destination.ip
  cim_field: dest_ip
  asim_field: DstIpAddr
  category: Connection
- field_name: '%<A'
  field_type: string
  description: Server FQDN (if resolved)
  ecs_field: destination.ip
  cim_field: dest_ip
  asim_field: DstIpAddr
  category: Connection
- field_name: '%<p'
  field_type: integer
  description: Server/peer port number
  ecs_field: destination.port
  cim_field: dest_port
  asim_field: DstPortNumber
  category: Connection
- field_name: '%la'
  field_type: ip
  description: Local IP address client connected to
  ecs_field: observer.ip
  cim_field: proxy_ip
  asim_field: DvcIpAddr
  category: Connection
- field_name: '%lp'
  field_type: integer
  description: Local port client connected to
  ecs_field: destination.port
  cim_field: dest_port
  asim_field: DstPortNumber
  category: Connection
- field_name: '%>eui'
  field_type: string
  description: Client EUI-48 MAC address (if available)
  ecs_field: source.mac
  cim_field: src_mac
  asim_field: SrcMacAddr
  category: Connection
- field_name: '%ts'
  field_type: integer
  description: Timestamp as Unix epoch seconds
  ecs_field: '@timestamp'
  cim_field: _time
  asim_field: EventTime
  category: Time
- field_name: '%tu'
  field_type: integer
  description: Subsecond timestamp (milliseconds)
  ecs_field: event.created
  cim_field: _time
  asim_field: EventTime
  category: Time
- field_name: '%tl'
  field_type: datetime
  description: Local time in Common Log Format
  ecs_field: '@timestamp'
  cim_field: _time
  asim_field: EventTime
  category: Time
- field_name: '%tg'
  field_type: datetime
  description: GMT/UTC time in Common Log Format
  ecs_field: '@timestamp'
  cim_field: _time
  asim_field: EventTime
  category: Time
- field_name: '%tr'
  field_type: integer
  description: Total response time in milliseconds
  ecs_field: event.duration
  cim_field: duration
  asim_field: EventDuration
  category: Time
- field_name: '%dt'
  field_type: integer
  description: Total time spent making DNS lookups (ms)
  ecs_field: event.duration
  cim_field: dns_time
  asim_field: EventDuration
  category: Time
- field_name: '%>tt'
  field_type: integer
  description: Request transmission time (ms)
  ecs_field: event.duration
  cim_field: duration
  asim_field: squid.squidproxyaccesslogs.__tt
  category: Time
- field_name: '%<tt'
  field_type: integer
  description: Response transmission time (ms)
  ecs_field: event.duration
  cim_field: '%<tt'
  asim_field: '%<tt'
  category: Time
- field_name: '%rm'
  field_type: string
  description: HTTP request method (GET, POST, etc.)
  ecs_field: http.request.method
  cim_field: http_method
  asim_field: HttpRequestMethod
  category: HTTP
- field_name: '%ru'
  field_type: string
  description: Request URL received (or computed)
  ecs_field: url.original
  cim_field: url
  asim_field: Url
  category: HTTP
- field_name: '%rp'
  field_type: string
  description: Request URL path excluding hostname
  ecs_field: url.path
  cim_field: uri_path
  asim_field: UrlPath
  category: HTTP
- field_name: '%rv'
  field_type: string
  description: HTTP request protocol version
  ecs_field: http.version
  cim_field: http_version
  asim_field: HttpVersion
  category: HTTP
- field_name: '%>h'
  field_type: string
  description: Original request header (use %{Header}>h)
  ecs_field: http.request.headers
  cim_field: squid.squidproxyaccesslogs.__h
  asim_field: squid.squidproxyaccesslogs.__h
  category: HTTP
- field_name: '%{Referer}>h'
  field_type: string
  description: Referer request header
  ecs_field: http.request.referrer
  cim_field: http_referrer
  asim_field: squid.squidproxyaccesslogs.__referer__h
  category: HTTP
- field_name: '%{User-Agent}>h'
  field_type: string
  description: User-Agent request header
  ecs_field: user_agent.original
  cim_field: '%{User-Agent}>h'
  asim_field: '%{User-Agent}>h'
  category: HTTP
- field_name: '%{Host}>h'
  field_type: string
  description: Host request header
  ecs_field: url.domain
  cim_field: squid.squidproxyaccesslogs.__host__h
  asim_field: squid.squidproxyaccesslogs.__host__h
  category: HTTP
- field_name: '%>Hs'
  field_type: integer
  description: HTTP status code sent to client
  ecs_field: http.response.status_code
  cim_field: '%>Hs'
  asim_field: '%>Hs'
  category: HTTP
- field_name: '%<Hs'
  field_type: integer
  description: HTTP status code received from server/peer
  ecs_field: http.response.status_code
  cim_field: '%<Hs'
  asim_field: '%<Hs'
  category: HTTP
- field_name: '%<h'
  field_type: string
  description: Response header (use %{Header}<h)
  ecs_field: http.response.headers
  cim_field: squid.squidproxyaccesslogs.__h
  asim_field: squid.squidproxyaccesslogs.__h
  category: HTTP
- field_name: '%mt'
  field_type: string
  description: MIME content type of the response
  ecs_field: http.response.mime_type
  cim_field: http_content_type
  asim_field: HttpContentType
  category: HTTP
- field_name: '%Ss'
  field_type: string
  description: Squid request status (TCP_HIT, TCP_MISS, etc.)
  ecs_field: event.outcome
  cim_field: '%Ss'
  asim_field: '%Ss'
  category: Cache
- field_name: '%Sh'
  field_type: string
  description: Squid hierarchy status (DIRECT, PARENT_HIT, etc.)
  ecs_field: event.outcome
  cim_field: '%Sh'
  asim_field: '%Sh'
  category: Cache
- field_name: '%>st'
  field_type: integer
  description: Total size of request (headers + body)
  ecs_field: http.request.bytes
  cim_field: bytes_in
  asim_field: SrcBytes
  category: Size
- field_name: '%<st'
  field_type: integer
  description: Total size of reply (headers + body)
  ecs_field: http.response.bytes
  cim_field: bytes_out
  asim_field: DstBytes
  category: Size
- field_name: '%st'
  field_type: integer
  description: Total request+reply size
  ecs_field: http.response.bytes
  cim_field: bytes_out
  asim_field: DstBytes
  category: Size
- field_name: '%>sh'
  field_type: integer
  description: Size of request headers
  ecs_field: http.request.body.bytes
  cim_field: bytes_in
  asim_field: SrcBytes
  category: Size
- field_name: '%<sh'
  field_type: integer
  description: Size of reply headers received
  ecs_field: http.response.body.bytes
  cim_field: bytes_out
  asim_field: DstBytes
  category: Size
- field_name: '%>sH'
  field_type: integer
  description: Size of request headers sent to server
  ecs_field: http.request.body.bytes
  cim_field: bytes_in
  asim_field: SrcBytes
  category: Size
- field_name: '%<sH'
  field_type: integer
  description: Size of reply headers sent to client
  ecs_field: http.response.body.bytes
  cim_field: bytes_out
  asim_field: DstBytes
  category: Size
- field_name: '%>sb'
  field_type: integer
  description: Size of request body
  ecs_field: http.request.body.bytes
  cim_field: bytes_in
  asim_field: squid.squidproxyaccesslogs.__sb
  category: Size
- field_name: '%<sb'
  field_type: integer
  description: Size of reply body
  ecs_field: http.response.body.bytes
  cim_field: bytes_out
  asim_field: squid.squidproxyaccesslogs.__sb
  category: Size
- field_name: '%un'
  field_type: string
  description: User name (from auth or ident)
  ecs_field: user.name
  cim_field: user
  asim_field: TargetUsername
  category: Connection
- field_name: '%[un'
  field_type: string
  description: User name (- if none)
  ecs_field: user.name
  cim_field: '%[un'
  asim_field: '%[un'
  category: Connection
- field_name: '%ul'
  field_type: string
  description: User login name (before auth)
  ecs_field: user.name
  cim_field: user
  asim_field: SrcUsername
  category: Connection
- field_name: '%ue'
  field_type: string
  description: User external ACL name
  ecs_field: user.name
  cim_field: user
  asim_field: TargetUsername
  category: Connection
- field_name: '%ui'
  field_type: string
  description: User ident (from RFC 1413)
  ecs_field: user.name
  cim_field: user
  asim_field: TargetUsername
  category: Connection
- field_name: '%credentials'
  field_type: string
  description: Client credentials or auth method
  ecs_field: user.name
  cim_field: user
  asim_field: ActorUsername
  category: Connection
- field_name: '%ssl::bump_mode'
  field_type: string
  description: SSL bump mode (client-first, server-first, peek, stare, etc.)
  ecs_field: squid.squidproxyaccesslogs._ssl__bump_mode
  cim_field: squid.squidproxyaccesslogs._ssl__bump_mode
  asim_field: squid.squidproxyaccesslogs._ssl__bump_mode
  category: SSL
- field_name: '%ssl::>sni'
  field_type: string
  description: TLS Server Name Indication from client
  ecs_field: tls.client.server_name
  cim_field: squid.squidproxyaccesslogs._ssl___sni
  asim_field: squid.squidproxyaccesslogs._ssl___sni
  category: SSL
- field_name: '%ssl::>cert_subject'
  field_type: string
  description: Client SSL certificate subject (if provided)
  ecs_field: tls.client.subject
  cim_field: ssl_client_subject
  asim_field: TlsClientSubject
  category: SSL
- field_name: '%ssl::>cert_issuer'
  field_type: string
  description: Client SSL certificate issuer
  ecs_field: tls.client.issuer
  cim_field: ssl_client_issuer
  asim_field: TlsClientIssuer
  category: SSL
- field_name: '%ssl::<cert_subject'
  field_type: string
  description: Server SSL certificate subject
  ecs_field: tls.server.subject
  cim_field: ssl_server_subject
  asim_field: TlsServerSubject
  category: SSL
- field_name: '%ssl::<cert_issuer'
  field_type: string
  description: Server SSL certificate issuer
  ecs_field: tls.server.issuer
  cim_field: ssl_server_issuer
  asim_field: TlsServerIssuer
  category: SSL
- field_name: '%ssl::<cert_errors'
  field_type: integer
  description: Count of server certificate errors
  ecs_field: squid.squidproxyaccesslogs._ssl___cert_errors
  cim_field: squid.squidproxyaccesslogs._ssl___cert_errors
  asim_field: squid.squidproxyaccesslogs._ssl___cert_errors
  category: SSL
- field_name: '%ssl::>negotiated_version'
  field_type: string
  description: Negotiated TLS version to client
  ecs_field: tls.version
  cim_field: '%ssl::>negotiated_version'
  asim_field: '%ssl::>negotiated_version'
  category: SSL
- field_name: '%ssl::<negotiated_version'
  field_type: string
  description: Negotiated TLS version to server
  ecs_field: tls.version
  cim_field: '%ssl::<negotiated_version'
  asim_field: '%ssl::<negotiated_version'
  category: SSL
- field_name: '%ssl::>negotiated_cipher'
  field_type: string
  description: Negotiated cipher suite to client
  ecs_field: tls.cipher
  cim_field: '%ssl::>negotiated_cipher'
  asim_field: '%ssl::>negotiated_cipher'
  category: SSL
- field_name: '%ssl::<negotiated_cipher'
  field_type: string
  description: Negotiated cipher suite to server
  ecs_field: tls.cipher
  cim_field: '%ssl::<negotiated_cipher'
  asim_field: '%ssl::<negotiated_cipher'
  category: SSL
- field_name: '%ssl::>received_hello_version'
  field_type: string
  description: TLS version from client hello
  ecs_field: tls.version
  cim_field: '%ssl::>received_hello_version'
  asim_field: '%ssl::>received_hello_version'
  category: SSL
- field_name: '%ssl::<received_hello_version'
  field_type: string
  description: TLS version from server hello
  ecs_field: tls.version
  cim_field: '%ssl::<received_hello_version'
  asim_field: '%ssl::<received_hello_version'
  category: SSL
- field_name: '%lc'
  field_type: string
  description: PROXY protocol client IP (if PROXY protocol used)
  ecs_field: source.ip
  cim_field: '%lc'
  asim_field: '%lc'
  category: Connection
- field_name: '%lp'
  field_type: integer
  description: PROXY protocol client port
  ecs_field: source.port
  cim_field: proxy_port
  asim_field: DvcPort
  category: Connection
- field_name: '%icap::tt'
  field_type: integer
  description: Total ICAP processing time (ms)
  ecs_field: event.duration
  cim_field: duration
  asim_field: squid.squidproxyaccesslogs._icap__tt
  category: ICAP
- field_name: '%icap::>st'
  field_type: integer
  description: Bytes sent to ICAP server
  ecs_field: source.bytes
  cim_field: '%icap::>st'
  asim_field: '%icap::>st'
  category: ICAP
- field_name: '%icap::<st'
  field_type: integer
  description: Bytes received from ICAP server
  ecs_field: destination.bytes
  cim_field: '%icap::<st'
  asim_field: '%icap::<st'
  category: ICAP
- field_name: '%icap::>h'
  field_type: string
  description: ICAP request header
  ecs_field: squid.squidproxyaccesslogs._icap___h
  cim_field: squid.squidproxyaccesslogs._icap___h
  asim_field: squid.squidproxyaccesslogs._icap___h
  category: ICAP
- field_name: '%icap::<h'
  field_type: string
  description: ICAP response header
  ecs_field: squid.squidproxyaccesslogs._icap___h
  cim_field: squid.squidproxyaccesslogs._icap___h
  asim_field: squid.squidproxyaccesslogs._icap___h
  category: ICAP
- field_name: '%icap::tr'
  field_type: integer
  description: ICAP transaction response time
  ecs_field: event.action
  cim_field: '%icap::tr'
  asim_field: '%icap::tr'
  category: ICAP
- field_name: '%icap::to'
  field_type: string
  description: ICAP transaction outcome
  ecs_field: event.action
  cim_field: '%icap::to'
  asim_field: '%icap::to'
  category: ICAP
- field_name: '%icap::Hs'
  field_type: integer
  description: ICAP response status code
  ecs_field: http.response.status_code
  cim_field: '%icap::Hs'
  asim_field: '%icap::Hs'
  category: ICAP
- field_name: '%icap::ru'
  field_type: string
  description: ICAP server URI used
  ecs_field: url.full
  cim_field: url
  asim_field: UrlOriginal
  category: ICAP
- field_name: '%adapt::sum_trs'
  field_type: string
  description: Adaptation transaction response summary
  ecs_field: event.action
  cim_field: '%adapt::sum_trs'
  asim_field: '%adapt::sum_trs'
  category: Adaptation
- field_name: '%adapt::all_trs'
  field_type: string
  description: All adaptation transaction responses
  ecs_field: event.action
  cim_field: '%adapt::all_trs'
  asim_field: '%adapt::all_trs'
  category: Adaptation
- field_name: '%note'
  field_type: string
  description: Annotation/note set during request processing
  ecs_field: squid.squidproxyaccesslogs._note
  cim_field: squid.squidproxyaccesslogs._note
  asim_field: squid.squidproxyaccesslogs._note
  category: Notes
- field_name: '%{key}note'
  field_type: string
  description: Specific note value by key
  ecs_field: squid.squidproxyaccesslogs.__key_note
  cim_field: squid.squidproxyaccesslogs.__key_note
  asim_field: squid.squidproxyaccesslogs.__key_note
  category: Notes
- field_name: '%master_xaction'
  field_type: string
  description: Master transaction ID for aggregation
  ecs_field: event.action
  cim_field: '%master_xaction'
  asim_field: '%master_xaction'
  category: Notes
- field_name: '%err_code'
  field_type: string
  description: Squid error code
  ecs_field: error.code
  cim_field: error_code
  asim_field: ErrorCode
  category: Notes
- field_name: '%err_detail'
  field_type: string
  description: Squid error detail message
  ecs_field: error.message
  cim_field: error_detail
  asim_field: ErrorMessage
  category: Notes
- field_name: '%02x'
  field_type: string
  description: 'Format modifier: pad with zeros to 2 digits'
  ecs_field: squid.squidproxyaccesslogs._02x
  cim_field: squid.squidproxyaccesslogs._02x
  asim_field: squid.squidproxyaccesslogs._02x
  category: Notes
- field_name: '%#x'
  field_type: string
  description: 'Format modifier: output in alternative format'
  ecs_field: squid.squidproxyaccesslogs.__x
  cim_field: squid.squidproxyaccesslogs.__x
  asim_field: squid.squidproxyaccesslogs.__x
  category: Notes
notes: Access log format codes for Squid proxy. Supports custom log formats via logformat
  directive. All codes prefixed with %.
log_formats:
- name: Squid Native Format
  format: '%ts.%03tu %6tr %>a %Ss/%03>Hs %<st %rm %ru %[un %Sh/%<a %mt'
  description: Default Squid log format
- name: Common Log Format
  format: '%>a - %[un [%tl] "%rm %ru HTTP/%rv" %>Hs %<st'
  description: NCSA Common Log Format for compatibility
- name: Combined Log Format
  format: '%>a - %[un [%tl] "%rm %ru HTTP/%rv" %>Hs %<st "%{Referer}>h" "%{User-Agent}>h"'
  description: NCSA Combined Log Format with Referer and User-Agent
