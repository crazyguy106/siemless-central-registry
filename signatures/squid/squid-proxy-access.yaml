version: '1.0'
vendor: Squid Cache
product: Squid Proxy Access Logs
product_full_name: Squid Proxy Cache (logformat directive)
log_type: structured
source_document: 'Squid Configuration Directive: logformat'
source_url: http://www.squid-cache.org/Doc/config/logformat/
extraction_date: '2026-01-02'
source_file: squid-signatures.json
generated_at: '2026-01-29T12:25:01.412976'
categories:
- Connection
- Time
- HTTP
- SSL
- Size
- Headers
- Cache
- Adaptation
- Notes
- ICAP
field_count: 79
fields:
- field_name: '%>a'
  field_type: ip
  description: Client source IP address
  category: Connection
  ecs_field: vendor.%>a
  cim_field: '%>a'
  asim_field: '%>a'
- field_name: '%>A'
  field_type: string
  description: Client FQDN (if resolved)
  category: Connection
  ecs_field: vendor.%>A
  cim_field: '%>A'
  asim_field: '%>A'
- field_name: '%>p'
  field_type: integer
  description: Client source port
  category: Connection
  ecs_field: vendor.%>p
  cim_field: '%>p'
  asim_field: '%>p'
- field_name: '%<a'
  field_type: ip
  description: Server/peer IP address
  category: Connection
  ecs_field: vendor.%<a
  cim_field: '%<a'
  asim_field: '%<a'
- field_name: '%<A'
  field_type: string
  description: Server FQDN (if resolved)
  category: Connection
  ecs_field: vendor.%<A
  cim_field: '%<A'
  asim_field: '%<A'
- field_name: '%<p'
  field_type: integer
  description: Server/peer port number
  category: Connection
  ecs_field: vendor.%<p
  cim_field: '%<p'
  asim_field: '%<p'
- field_name: '%la'
  field_type: ip
  description: Local IP address client connected to
  category: Connection
  ecs_field: vendor.%la
  cim_field: '%la'
  asim_field: '%la'
- field_name: '%lp'
  field_type: integer
  description: Local port client connected to
  category: Connection
  ecs_field: vendor.%lp
  cim_field: '%lp'
  asim_field: '%lp'
- field_name: '%>eui'
  field_type: string
  description: Client EUI-48 MAC address (if available)
  category: Connection
  ecs_field: vendor.%>eui
  cim_field: '%>eui'
  asim_field: '%>eui'
- field_name: '%ts'
  field_type: integer
  description: Timestamp as Unix epoch seconds
  category: Time
  ecs_field: vendor.%ts
  cim_field: '%ts'
  asim_field: '%ts'
- field_name: '%tu'
  field_type: integer
  description: Subsecond timestamp (milliseconds)
  category: Time
  ecs_field: vendor.%tu
  cim_field: '%tu'
  asim_field: '%tu'
- field_name: '%tl'
  field_type: datetime
  description: Local time in Common Log Format
  category: Time
  ecs_field: vendor.%tl
  cim_field: '%tl'
  asim_field: '%tl'
- field_name: '%tg'
  field_type: datetime
  description: GMT/UTC time in Common Log Format
  category: Time
  ecs_field: vendor.%tg
  cim_field: '%tg'
  asim_field: '%tg'
- field_name: '%tr'
  field_type: integer
  description: Total response time in milliseconds
  category: Time
  ecs_field: vendor.%tr
  cim_field: '%tr'
  asim_field: '%tr'
- field_name: '%dt'
  field_type: integer
  description: Total time spent making DNS lookups (ms)
  category: Time
  ecs_field: vendor.%dt
  cim_field: '%dt'
  asim_field: '%dt'
- field_name: '%>tt'
  field_type: integer
  description: Request transmission time (ms)
  category: Time
  ecs_field: vendor.%>tt
  cim_field: '%>tt'
  asim_field: '%>tt'
- field_name: '%<tt'
  field_type: integer
  description: Response transmission time (ms)
  category: Time
  ecs_field: vendor.%<tt
  cim_field: '%<tt'
  asim_field: '%<tt'
- field_name: '%rm'
  field_type: string
  description: HTTP request method (GET, POST, etc.)
  category: HTTP
  ecs_field: vendor.%rm
  cim_field: '%rm'
  asim_field: '%rm'
- field_name: '%ru'
  field_type: string
  description: Request URL received (or computed)
  category: HTTP
  ecs_field: vendor.%ru
  cim_field: '%ru'
  asim_field: '%ru'
- field_name: '%rp'
  field_type: string
  description: Request URL path excluding hostname
  category: HTTP
  ecs_field: vendor.%rp
  cim_field: '%rp'
  asim_field: '%rp'
- field_name: '%rv'
  field_type: string
  description: HTTP request protocol version
  category: HTTP
  ecs_field: vendor.%rv
  cim_field: '%rv'
  asim_field: '%rv'
- field_name: '%>h'
  field_type: string
  description: Original request header (use %{Header}>h)
  category: HTTP
  ecs_field: vendor.%>h
  cim_field: '%>h'
  asim_field: '%>h'
- field_name: '%{Referer}>h'
  field_type: string
  description: Referer request header
  category: HTTP
  ecs_field: vendor.%{Referer}>h
  cim_field: '%{Referer}>h'
  asim_field: '%{Referer}>h'
- field_name: '%{User-Agent}>h'
  field_type: string
  description: User-Agent request header
  category: HTTP
  ecs_field: vendor.%{User-Agent}>h
  cim_field: '%{User-Agent}>h'
  asim_field: '%{User-Agent}>h'
- field_name: '%{Host}>h'
  field_type: string
  description: Host request header
  category: HTTP
  ecs_field: vendor.%{Host}>h
  cim_field: '%{Host}>h'
  asim_field: '%{Host}>h'
- field_name: '%>Hs'
  field_type: integer
  description: HTTP status code sent to client
  category: HTTP
  ecs_field: vendor.%>Hs
  cim_field: '%>Hs'
  asim_field: '%>Hs'
- field_name: '%<Hs'
  field_type: integer
  description: HTTP status code received from server/peer
  category: HTTP
  ecs_field: vendor.%<Hs
  cim_field: '%<Hs'
  asim_field: '%<Hs'
- field_name: '%<h'
  field_type: string
  description: Response header (use %{Header}<h)
  category: HTTP
  ecs_field: vendor.%<h
  cim_field: '%<h'
  asim_field: '%<h'
- field_name: '%mt'
  field_type: string
  description: MIME content type of the response
  category: HTTP
  ecs_field: vendor.%mt
  cim_field: '%mt'
  asim_field: '%mt'
- field_name: '%Ss'
  field_type: string
  description: Squid request status (TCP_HIT, TCP_MISS, etc.)
  category: Cache
  ecs_field: vendor.%Ss
  cim_field: '%Ss'
  asim_field: '%Ss'
- field_name: '%Sh'
  field_type: string
  description: Squid hierarchy status (DIRECT, PARENT_HIT, etc.)
  category: Cache
  ecs_field: vendor.%Sh
  cim_field: '%Sh'
  asim_field: '%Sh'
- field_name: '%>st'
  field_type: integer
  description: Total size of request (headers + body)
  category: Size
  ecs_field: vendor.%>st
  cim_field: '%>st'
  asim_field: '%>st'
- field_name: '%<st'
  field_type: integer
  description: Total size of reply (headers + body)
  category: Size
  ecs_field: vendor.%<st
  cim_field: '%<st'
  asim_field: '%<st'
- field_name: '%st'
  field_type: integer
  description: Total request+reply size
  category: Size
  ecs_field: vendor.%st
  cim_field: '%st'
  asim_field: '%st'
- field_name: '%>sh'
  field_type: integer
  description: Size of request headers
  category: Size
  ecs_field: vendor.%>sh
  cim_field: '%>sh'
  asim_field: '%>sh'
- field_name: '%<sh'
  field_type: integer
  description: Size of reply headers received
  category: Size
  ecs_field: vendor.%<sh
  cim_field: '%<sh'
  asim_field: '%<sh'
- field_name: '%>sH'
  field_type: integer
  description: Size of request headers sent to server
  category: Size
  ecs_field: vendor.%>sH
  cim_field: '%>sH'
  asim_field: '%>sH'
- field_name: '%<sH'
  field_type: integer
  description: Size of reply headers sent to client
  category: Size
  ecs_field: vendor.%<sH
  cim_field: '%<sH'
  asim_field: '%<sH'
- field_name: '%>sb'
  field_type: integer
  description: Size of request body
  category: Size
  ecs_field: vendor.%>sb
  cim_field: '%>sb'
  asim_field: '%>sb'
- field_name: '%<sb'
  field_type: integer
  description: Size of reply body
  category: Size
  ecs_field: vendor.%<sb
  cim_field: '%<sb'
  asim_field: '%<sb'
- field_name: '%un'
  field_type: string
  description: User name (from auth or ident)
  category: Connection
  ecs_field: vendor.%un
  cim_field: '%un'
  asim_field: '%un'
- field_name: '%[un'
  field_type: string
  description: User name (- if none)
  category: Connection
  ecs_field: vendor.%[un
  cim_field: '%[un'
  asim_field: '%[un'
- field_name: '%ul'
  field_type: string
  description: User login name (before auth)
  category: Connection
  ecs_field: vendor.%ul
  cim_field: '%ul'
  asim_field: '%ul'
- field_name: '%ue'
  field_type: string
  description: User external ACL name
  category: Connection
  ecs_field: vendor.%ue
  cim_field: '%ue'
  asim_field: '%ue'
- field_name: '%ui'
  field_type: string
  description: User ident (from RFC 1413)
  category: Connection
  ecs_field: vendor.%ui
  cim_field: '%ui'
  asim_field: '%ui'
- field_name: '%credentials'
  field_type: string
  description: Client credentials or auth method
  category: Connection
  ecs_field: vendor.%credentials
  cim_field: '%credentials'
  asim_field: '%credentials'
- field_name: '%ssl::bump_mode'
  field_type: string
  description: SSL bump mode (client-first, server-first, peek, stare, etc.)
  category: SSL
  ecs_field: vendor.%ssl::bump_mode
  cim_field: '%ssl::bump_mode'
  asim_field: '%ssl::bump_mode'
- field_name: '%ssl::>sni'
  field_type: string
  description: TLS Server Name Indication from client
  category: SSL
  ecs_field: vendor.%ssl::>sni
  cim_field: '%ssl::>sni'
  asim_field: '%ssl::>sni'
- field_name: '%ssl::>cert_subject'
  field_type: string
  description: Client SSL certificate subject (if provided)
  category: SSL
  ecs_field: vendor.%ssl::>cert_subject
  cim_field: '%ssl::>cert_subject'
  asim_field: '%ssl::>cert_subject'
- field_name: '%ssl::>cert_issuer'
  field_type: string
  description: Client SSL certificate issuer
  category: SSL
  ecs_field: vendor.%ssl::>cert_issuer
  cim_field: '%ssl::>cert_issuer'
  asim_field: '%ssl::>cert_issuer'
- field_name: '%ssl::<cert_subject'
  field_type: string
  description: Server SSL certificate subject
  category: SSL
  ecs_field: vendor.%ssl::<cert_subject
  cim_field: '%ssl::<cert_subject'
  asim_field: '%ssl::<cert_subject'
- field_name: '%ssl::<cert_issuer'
  field_type: string
  description: Server SSL certificate issuer
  category: SSL
  ecs_field: vendor.%ssl::<cert_issuer
  cim_field: '%ssl::<cert_issuer'
  asim_field: '%ssl::<cert_issuer'
- field_name: '%ssl::<cert_errors'
  field_type: integer
  description: Count of server certificate errors
  category: SSL
  ecs_field: vendor.%ssl::<cert_errors
  cim_field: '%ssl::<cert_errors'
  asim_field: '%ssl::<cert_errors'
- field_name: '%ssl::>negotiated_version'
  field_type: string
  description: Negotiated TLS version to client
  category: SSL
  ecs_field: vendor.%ssl::>negotiated_version
  cim_field: '%ssl::>negotiated_version'
  asim_field: '%ssl::>negotiated_version'
- field_name: '%ssl::<negotiated_version'
  field_type: string
  description: Negotiated TLS version to server
  category: SSL
  ecs_field: vendor.%ssl::<negotiated_version
  cim_field: '%ssl::<negotiated_version'
  asim_field: '%ssl::<negotiated_version'
- field_name: '%ssl::>negotiated_cipher'
  field_type: string
  description: Negotiated cipher suite to client
  category: SSL
  ecs_field: vendor.%ssl::>negotiated_cipher
  cim_field: '%ssl::>negotiated_cipher'
  asim_field: '%ssl::>negotiated_cipher'
- field_name: '%ssl::<negotiated_cipher'
  field_type: string
  description: Negotiated cipher suite to server
  category: SSL
  ecs_field: vendor.%ssl::<negotiated_cipher
  cim_field: '%ssl::<negotiated_cipher'
  asim_field: '%ssl::<negotiated_cipher'
- field_name: '%ssl::>received_hello_version'
  field_type: string
  description: TLS version from client hello
  category: SSL
  ecs_field: vendor.%ssl::>received_hello_version
  cim_field: '%ssl::>received_hello_version'
  asim_field: '%ssl::>received_hello_version'
- field_name: '%ssl::<received_hello_version'
  field_type: string
  description: TLS version from server hello
  category: SSL
  ecs_field: vendor.%ssl::<received_hello_version
  cim_field: '%ssl::<received_hello_version'
  asim_field: '%ssl::<received_hello_version'
- field_name: '%lc'
  field_type: string
  description: PROXY protocol client IP (if PROXY protocol used)
  category: Connection
  ecs_field: vendor.%lc
  cim_field: '%lc'
  asim_field: '%lc'
- field_name: '%lp'
  field_type: integer
  description: PROXY protocol client port
  category: Connection
  ecs_field: vendor.%lp
  cim_field: '%lp'
  asim_field: '%lp'
- field_name: '%icap::tt'
  field_type: integer
  description: Total ICAP processing time (ms)
  category: ICAP
  ecs_field: vendor.%icap::tt
  cim_field: '%icap::tt'
  asim_field: '%icap::tt'
- field_name: '%icap::>st'
  field_type: integer
  description: Bytes sent to ICAP server
  category: ICAP
  ecs_field: vendor.%icap::>st
  cim_field: '%icap::>st'
  asim_field: '%icap::>st'
- field_name: '%icap::<st'
  field_type: integer
  description: Bytes received from ICAP server
  category: ICAP
  ecs_field: vendor.%icap::<st
  cim_field: '%icap::<st'
  asim_field: '%icap::<st'
- field_name: '%icap::>h'
  field_type: string
  description: ICAP request header
  category: ICAP
  ecs_field: vendor.%icap::>h
  cim_field: '%icap::>h'
  asim_field: '%icap::>h'
- field_name: '%icap::<h'
  field_type: string
  description: ICAP response header
  category: ICAP
  ecs_field: vendor.%icap::<h
  cim_field: '%icap::<h'
  asim_field: '%icap::<h'
- field_name: '%icap::tr'
  field_type: integer
  description: ICAP transaction response time
  category: ICAP
  ecs_field: vendor.%icap::tr
  cim_field: '%icap::tr'
  asim_field: '%icap::tr'
- field_name: '%icap::to'
  field_type: string
  description: ICAP transaction outcome
  category: ICAP
  ecs_field: vendor.%icap::to
  cim_field: '%icap::to'
  asim_field: '%icap::to'
- field_name: '%icap::Hs'
  field_type: integer
  description: ICAP response status code
  category: ICAP
  ecs_field: vendor.%icap::Hs
  cim_field: '%icap::Hs'
  asim_field: '%icap::Hs'
- field_name: '%icap::ru'
  field_type: string
  description: ICAP server URI used
  category: ICAP
  ecs_field: vendor.%icap::ru
  cim_field: '%icap::ru'
  asim_field: '%icap::ru'
- field_name: '%adapt::sum_trs'
  field_type: string
  description: Adaptation transaction response summary
  category: Adaptation
  ecs_field: vendor.%adapt::sum_trs
  cim_field: '%adapt::sum_trs'
  asim_field: '%adapt::sum_trs'
- field_name: '%adapt::all_trs'
  field_type: string
  description: All adaptation transaction responses
  category: Adaptation
  ecs_field: vendor.%adapt::all_trs
  cim_field: '%adapt::all_trs'
  asim_field: '%adapt::all_trs'
- field_name: '%note'
  field_type: string
  description: Annotation/note set during request processing
  category: Notes
  ecs_field: vendor.%note
  cim_field: '%note'
  asim_field: '%note'
- field_name: '%{key}note'
  field_type: string
  description: Specific note value by key
  category: Notes
  ecs_field: vendor.%{key}note
  cim_field: '%{key}note'
  asim_field: '%{key}note'
- field_name: '%master_xaction'
  field_type: string
  description: Master transaction ID for aggregation
  category: Notes
  ecs_field: vendor.%master_xaction
  cim_field: '%master_xaction'
  asim_field: '%master_xaction'
- field_name: '%err_code'
  field_type: string
  description: Squid error code
  category: Notes
  ecs_field: vendor.%err_code
  cim_field: '%err_code'
  asim_field: '%err_code'
- field_name: '%err_detail'
  field_type: string
  description: Squid error detail message
  category: Notes
  ecs_field: vendor.%err_detail
  cim_field: '%err_detail'
  asim_field: '%err_detail'
- field_name: '%02x'
  field_type: string
  description: 'Format modifier: pad with zeros to 2 digits'
  category: Notes
  ecs_field: vendor.%02x
  cim_field: '%02x'
  asim_field: '%02x'
- field_name: '%#x'
  field_type: string
  description: 'Format modifier: output in alternative format'
  category: Notes
  ecs_field: vendor.%#x
  cim_field: '%#x'
  asim_field: '%#x'
mapped_field_count: 0
notes: Access log format codes for Squid proxy. Supports custom log formats via logformat
  directive. All codes prefixed with %.
log_formats:
- name: Squid Native Format
  format: '%ts.%03tu %6tr %>a %Ss/%03>Hs %<st %rm %ru %[un %Sh/%<a %mt'
  description: Default Squid log format
- name: Common Log Format
  format: '%>a - %[un [%tl] "%rm %ru HTTP/%rv" %>Hs %<st'
  description: NCSA Common Log Format for compatibility
- name: Combined Log Format
  format: '%>a - %[un [%tl] "%rm %ru HTTP/%rv" %>Hs %<st "%{Referer}>h" "%{User-Agent}>h"'
  description: NCSA Combined Log Format with Referer and User-Agent
