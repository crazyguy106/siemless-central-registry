version: '1.0'
vendor: Microsoft
product: Azure NSG Flow Logs
product_full_name: Azure Network Security Group Flow Logs
log_type: structured
source_document: NSG Flow Logs Overview
source_url: https://learn.microsoft.com/en-us/azure/network-watcher/network-watcher-nsg-flow-logging-overview
extraction_date: '2026-01-02'
source_file: azure-nsg-flow-signatures.json
generated_at: '2026-02-12T11:02:51.993470'
categories:
- LogRecord
- FlowTupleV2
- FlowTupleV1
- Flow
- Rule
- Properties
field_count: 25
fields:
- field_name: category
  field_type: string
  description: Category of the event (NetworkSecurityGroupFlowEvent)
  ecs_field: event.category
  cim_field: category
  asim_field: EventCategory
  category: LogRecord
- field_name: flowTuple.bytesReceived
  field_type: integer
  description: TCP bytes sent from destination to source
  ecs_field: source.bytes
  cim_field: flowTuple.bytesReceived
  asim_field: flowTuple.bytesReceived
  category: FlowTupleV2
- field_name: flowTuple.bytesSent
  field_type: integer
  description: TCP bytes sent from source to destination
  ecs_field: source.bytes
  cim_field: flowTuple.bytesSent
  asim_field: flowTuple.bytesSent
  category: FlowTupleV2
- field_name: flowTuple.destinationIP
  field_type: ip
  description: Destination IP address
  ecs_field: destination.ip
  cim_field: flowTuple.destinationIP
  asim_field: flowTuple.destinationIP
  category: FlowTupleV1
- field_name: flowTuple.destinationPort
  field_type: port
  description: Destination port number
  ecs_field: destination.port
  cim_field: flowTuple.destinationPort
  asim_field: flowTuple.destinationPort
  category: FlowTupleV1
- field_name: flowTuple.flowState
  field_type: string
  description: 'State: B (Begin), C (Continuing), E (End)'
  ecs_field: microsoft.azurensgflowlogs.flowtuple_flowstate
  cim_field: microsoft.azurensgflowlogs.flowtuple_flowstate
  asim_field: microsoft.azurensgflowlogs.flowtuple_flowstate
  category: FlowTupleV2
- field_name: flowTuple.packetsReceived
  field_type: integer
  description: TCP packets sent from destination to source
  ecs_field: destination.packets
  cim_field: packets_in
  asim_field: DstPackets
  category: FlowTupleV2
- field_name: flowTuple.packetsSent
  field_type: integer
  description: TCP packets sent from source to destination
  ecs_field: source.packets
  cim_field: packets_out
  asim_field: SrcPackets
  category: FlowTupleV2
- field_name: flowTuple.protocol
  field_type: string
  description: 'Protocol: T (TCP) or U (UDP)'
  ecs_field: network.transport
  cim_field: flowTuple.protocol
  asim_field: flowTuple.protocol
  category: FlowTupleV1
- field_name: flowTuple.sourceIP
  field_type: ip
  description: Source IP address
  ecs_field: source.ip
  cim_field: flowTuple.sourceIP
  asim_field: flowTuple.sourceIP
  category: FlowTupleV1
- field_name: flowTuple.sourcePort
  field_type: port
  description: Source port number
  ecs_field: source.port
  cim_field: flowTuple.sourcePort
  asim_field: flowTuple.sourcePort
  category: FlowTupleV1
- field_name: flowTuple.timestamp
  field_type: integer
  description: Time stamp in UNIX epoch format
  ecs_field: microsoft.azurensgflowlogs.flowtuple_timestamp
  cim_field: microsoft.azurensgflowlogs.flowtuple_timestamp
  asim_field: microsoft.azurensgflowlogs.flowtuple_timestamp
  category: FlowTupleV1
- field_name: flowTuple.trafficDecision
  field_type: string
  description: 'Decision: A (allowed) or D (denied)'
  ecs_field: microsoft.azurensgflowlogs.flowtuple_trafficdecision
  cim_field: microsoft.azurensgflowlogs.flowtuple_trafficdecision
  asim_field: microsoft.azurensgflowlogs.flowtuple_trafficdecision
  category: FlowTupleV1
- field_name: flowTuple.trafficFlow
  field_type: string
  description: 'Direction: I (inbound) or O (outbound)'
  ecs_field: network.direction
  cim_field: flowTuple.trafficFlow
  asim_field: flowTuple.trafficFlow
  category: FlowTupleV1
- field_name: flows.flowTuples
  field_type: array
  description: Comma-separated flow tuple data
  ecs_field: microsoft.azurensgflowlogs.flows_flowtuples
  cim_field: microsoft.azurensgflowlogs.flows_flowtuples
  asim_field: microsoft.azurensgflowlogs.flows_flowtuples
  category: Flow
- field_name: flows.flows
  field_type: array
  description: Collection of individual flow entries
  ecs_field: microsoft.azurensgflowlogs.flows_flows
  cim_field: microsoft.azurensgflowlogs.flows_flows
  asim_field: microsoft.azurensgflowlogs.flows_flows
  category: Rule
- field_name: flows.mac
  field_type: string
  description: MAC address of the NIC where flow was collected
  ecs_field: microsoft.azurensgflowlogs.flows_mac
  cim_field: microsoft.azurensgflowlogs.flows_mac
  asim_field: microsoft.azurensgflowlogs.flows_mac
  category: Flow
- field_name: flows.rule
  field_type: string
  description: Rule name for which flows are listed
  ecs_field: rule.name
  cim_field: flows.rule
  asim_field: flows.rule
  category: Rule
- field_name: operationName
  field_type: string
  description: Always NetworkSecurityGroupFlowEvents
  ecs_field: event.action
  cim_field: operationName
  asim_field: operationName
  category: LogRecord
- field_name: properties
  field_type: object
  description: Collection of properties of the flow
  ecs_field: event.original
  cim_field: properties
  asim_field: properties
  category: LogRecord
- field_name: properties.Version
  field_type: integer
  description: Version number of flow log schema (1 or 2)
  ecs_field: microsoft.azurensgflowlogs.properties_version
  cim_field: microsoft.azurensgflowlogs.properties_version
  asim_field: microsoft.azurensgflowlogs.properties_version
  category: Properties
- field_name: properties.flows
  field_type: array
  description: Collection of flows for different rules
  ecs_field: microsoft.azurensgflowlogs.properties_flows
  cim_field: microsoft.azurensgflowlogs.properties_flows
  asim_field: microsoft.azurensgflowlogs.properties_flows
  category: Properties
- field_name: resourceId
  field_type: string
  description: Resource ID of the network security group
  ecs_field: cloud.instance.id
  cim_field: resourceId
  asim_field: resourceId
  category: LogRecord
- field_name: systemId
  field_type: string
  description: System ID (GUID) of the network security group
  ecs_field: microsoft.azurensgflowlogs.systemid
  cim_field: microsoft.azurensgflowlogs.systemid
  asim_field: microsoft.azurensgflowlogs.systemid
  category: LogRecord
- field_name: time
  field_type: datetime
  description: Time in UTC when the event was logged
  ecs_field: '@timestamp'
  cim_field: _time
  asim_field: EventTime
  category: LogRecord
notes: Azure NSG Flow Logs capture network flow information through Network Security
  Groups. Version 2 adds flow state and bandwidth metrics (packets/bytes).
