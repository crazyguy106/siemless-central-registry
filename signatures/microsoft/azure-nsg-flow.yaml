version: '1.0'
vendor: Microsoft
product: Azure NSG Flow Logs
product_full_name: Azure Network Security Group Flow Logs
log_type: structured
source_document: NSG Flow Logs Overview
source_url: https://learn.microsoft.com/en-us/azure/network-watcher/network-watcher-nsg-flow-logging-overview
extraction_date: '2026-01-02'
source_file: azure-nsg-flow-signatures.json
generated_at: '2026-01-31T04:25:41.185987'
categories:
- LogRecord
- FlowTupleV2
- FlowTupleV1
- Flow
- Rule
- Properties
field_count: 25
fields:
- field_name: category
  field_type: string
  description: Category of the event (NetworkSecurityGroupFlowEvent)
  ecs_field: event.category
  cim_field: category
  asim_field: EventCategory
  category: LogRecord
- field_name: flowTuple.bytesReceived
  field_type: integer
  description: TCP bytes sent from destination to source
  ecs_field: vendor.flowTuple.bytesReceived
  cim_field: flowTuple.bytesReceived
  asim_field: flowTuple.bytesReceived
  category: FlowTupleV2
- field_name: flowTuple.bytesSent
  field_type: integer
  description: TCP bytes sent from source to destination
  ecs_field: vendor.flowTuple.bytesSent
  cim_field: flowTuple.bytesSent
  asim_field: flowTuple.bytesSent
  category: FlowTupleV2
- field_name: flowTuple.destinationIP
  field_type: ip
  description: Destination IP address
  ecs_field: vendor.flowTuple.destinationIP
  cim_field: flowTuple.destinationIP
  asim_field: flowTuple.destinationIP
  category: FlowTupleV1
- field_name: flowTuple.destinationPort
  field_type: port
  description: Destination port number
  ecs_field: vendor.flowTuple.destinationPort
  cim_field: flowTuple.destinationPort
  asim_field: flowTuple.destinationPort
  category: FlowTupleV1
- field_name: flowTuple.flowState
  field_type: string
  description: 'State: B (Begin), C (Continuing), E (End)'
  ecs_field: vendor.flowTuple.flowState
  cim_field: flowTuple.flowState
  asim_field: flowTuple.flowState
  category: FlowTupleV2
- field_name: flowTuple.packetsReceived
  field_type: integer
  description: TCP packets sent from destination to source
  ecs_field: vendor.flowTuple.packetsReceived
  cim_field: flowTuple.packetsReceived
  asim_field: flowTuple.packetsReceived
  category: FlowTupleV2
- field_name: flowTuple.packetsSent
  field_type: integer
  description: TCP packets sent from source to destination
  ecs_field: vendor.flowTuple.packetsSent
  cim_field: flowTuple.packetsSent
  asim_field: flowTuple.packetsSent
  category: FlowTupleV2
- field_name: flowTuple.protocol
  field_type: string
  description: 'Protocol: T (TCP) or U (UDP)'
  ecs_field: vendor.flowTuple.protocol
  cim_field: flowTuple.protocol
  asim_field: flowTuple.protocol
  category: FlowTupleV1
- field_name: flowTuple.sourceIP
  field_type: ip
  description: Source IP address
  ecs_field: vendor.flowTuple.sourceIP
  cim_field: flowTuple.sourceIP
  asim_field: flowTuple.sourceIP
  category: FlowTupleV1
- field_name: flowTuple.sourcePort
  field_type: port
  description: Source port number
  ecs_field: vendor.flowTuple.sourcePort
  cim_field: flowTuple.sourcePort
  asim_field: flowTuple.sourcePort
  category: FlowTupleV1
- field_name: flowTuple.timestamp
  field_type: integer
  description: Time stamp in UNIX epoch format
  ecs_field: vendor.flowTuple.timestamp
  cim_field: flowTuple.timestamp
  asim_field: flowTuple.timestamp
  category: FlowTupleV1
- field_name: flowTuple.trafficDecision
  field_type: string
  description: 'Decision: A (allowed) or D (denied)'
  ecs_field: vendor.flowTuple.trafficDecision
  cim_field: flowTuple.trafficDecision
  asim_field: flowTuple.trafficDecision
  category: FlowTupleV1
- field_name: flowTuple.trafficFlow
  field_type: string
  description: 'Direction: I (inbound) or O (outbound)'
  ecs_field: vendor.flowTuple.trafficFlow
  cim_field: flowTuple.trafficFlow
  asim_field: flowTuple.trafficFlow
  category: FlowTupleV1
- field_name: flows.flowTuples
  field_type: array
  description: Comma-separated flow tuple data
  ecs_field: vendor.flows.flowTuples
  cim_field: flows.flowTuples
  asim_field: flows.flowTuples
  category: Flow
- field_name: flows.flows
  field_type: array
  description: Collection of individual flow entries
  ecs_field: vendor.flows.flows
  cim_field: flows.flows
  asim_field: flows.flows
  category: Rule
- field_name: flows.mac
  field_type: string
  description: MAC address of the NIC where flow was collected
  ecs_field: vendor.flows.mac
  cim_field: flows.mac
  asim_field: flows.mac
  category: Flow
- field_name: flows.rule
  field_type: string
  description: Rule name for which flows are listed
  ecs_field: vendor.flows.rule
  cim_field: flows.rule
  asim_field: flows.rule
  category: Rule
- field_name: operationName
  field_type: string
  description: Always NetworkSecurityGroupFlowEvents
  ecs_field: vendor.operationName
  cim_field: operationName
  asim_field: operationName
  category: LogRecord
- field_name: properties
  field_type: object
  description: Collection of properties of the flow
  ecs_field: vendor.properties
  cim_field: properties
  asim_field: properties
  category: LogRecord
- field_name: properties.Version
  field_type: integer
  description: Version number of flow log schema (1 or 2)
  ecs_field: vendor.properties.Version
  cim_field: properties.Version
  asim_field: properties.Version
  category: Properties
- field_name: properties.flows
  field_type: array
  description: Collection of flows for different rules
  ecs_field: vendor.properties.flows
  cim_field: properties.flows
  asim_field: properties.flows
  category: Properties
- field_name: resourceId
  field_type: string
  description: Resource ID of the network security group
  ecs_field: vendor.resourceId
  cim_field: resourceId
  asim_field: resourceId
  category: LogRecord
- field_name: systemId
  field_type: string
  description: System ID (GUID) of the network security group
  ecs_field: vendor.systemId
  cim_field: systemId
  asim_field: systemId
  category: LogRecord
- field_name: time
  field_type: datetime
  description: Time in UTC when the event was logged
  ecs_field: '@timestamp'
  cim_field: _time
  asim_field: EventTime
  category: LogRecord
notes: Azure NSG Flow Logs capture network flow information through Network Security
  Groups. Version 2 adds flow state and bandwidth metrics (packets/bytes).
