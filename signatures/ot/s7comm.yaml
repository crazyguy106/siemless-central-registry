version: '1.0'
vendor: OT
product: S7comm
product_full_name: Siemens S7 Communication Protocol
log_type: structured
source_document: ''
source_url: ''
extraction_date: '2026-01-29'
source_file: ot-s7comm-signatures.json
generated_at: '2026-01-29T05:59:00.832510'
field_count: 16
fields:
- field_name: source_ip
  field_type: ip
  description: Client/HMI IP address
  ecs_field: vendor.source_ip
  cim_field: source_ip
  asim_field: source_ip
  category: network
- field_name: destination_ip
  field_type: ip
  description: PLC IP address
  ecs_field: vendor.destination_ip
  cim_field: destination_ip
  asim_field: destination_ip
  category: network
- field_name: source_port
  field_type: port
  description: Client port
  ecs_field: vendor.source_port
  cim_field: source_port
  asim_field: source_port
  category: network
- field_name: destination_port
  field_type: port
  description: PLC port (typically 102 for ISO-TSAP)
  ecs_field: vendor.destination_port
  cim_field: destination_port
  asim_field: destination_port
  category: network
- field_name: rosctr
  field_type: number
  description: Remote Operating Service Control (1=Job, 2=Ack, 3=Ack_Data, 7=Userdata)
  ecs_field: vendor.rosctr
  cim_field: rosctr
  asim_field: rosctr
  category: protocol
- field_name: function_code
  field_type: number
  description: S7 function code
  ecs_field: vendor.function_code
  cim_field: function_code
  asim_field: function_code
  category: protocol
- field_name: function_name
  field_type: string
  description: Human-readable function name
  ecs_field: vendor.function_name
  cim_field: function_name
  asim_field: function_name
  category: protocol
- field_name: area
  field_type: string
  description: S7 memory area (I=Inputs, Q=Outputs, M=Markers, DB=Data Block)
  ecs_field: vendor.area
  cim_field: area
  asim_field: area
  category: data
- field_name: db_number
  field_type: number
  description: Data block number (for DB area)
  ecs_field: vendor.db_number
  cim_field: db_number
  asim_field: db_number
  category: data
- field_name: start_address
  field_type: number
  description: Starting byte address
  ecs_field: vendor.start_address
  cim_field: start_address
  asim_field: start_address
  category: data
- field_name: length
  field_type: number
  description: Number of bytes to read/write
  ecs_field: vendor.length
  cim_field: length
  asim_field: length
  category: data
- field_name: data_value
  field_type: string
  description: Read/written data value
  ecs_field: vendor.data_value
  cim_field: data_value
  asim_field: data_value
  category: data
- field_name: error_class
  field_type: number
  description: S7 error class
  ecs_field: vendor.error_class
  cim_field: error_class
  asim_field: error_class
  category: error
- field_name: error_code
  field_type: number
  description: S7 error code
  ecs_field: vendor.error_code
  cim_field: error_code
  asim_field: error_code
  category: error
- field_name: rack
  field_type: number
  description: PLC rack number
  ecs_field: vendor.rack
  cim_field: rack
  asim_field: rack
  category: device
- field_name: slot
  field_type: number
  description: PLC slot number
  ecs_field: vendor.slot
  cim_field: slot
  asim_field: slot
  category: device
signatures:
- name: s7comm_generic
  description: Generic Siemens S7comm protocol detection
  regex_pattern: (?i)s7comm|(?:rosctr|rack|slot|db_number|area)\s*[=:]\s*\d+
  priority: 10
  confidence: 0.85
  log_type: ot_traffic
  log_format: kv
- name: s7_read_var
  pattern: function_code[=:]\s*0?4\b|Read Var|S7.*READ
  description: S7 Read Variable - Read data from PLC memory
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
  - area
  - db_number
  - start_address
  - length
- name: s7_write_var
  pattern: function_code[=:]\s*0?5\b|Write Var|S7.*WRITE
  description: S7 Write Variable - CRITICAL WRITE OPERATION
  event_type: ot_traffic
  severity: high
  fields:
  - source_ip
  - destination_ip
  - area
  - db_number
  - start_address
  - data_value
- name: s7_setup_communication
  pattern: function_code[=:]\s*0?240\b|Setup Communication
  description: S7 Setup Communication - Connection establishment
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
  - rack
  - slot
- name: s7_download_block
  pattern: Download|Start Download|End Download
  description: 'S7 Block Download - CRITICAL: Program modification'
  event_type: ot_traffic
  severity: critical
  fields:
  - source_ip
  - destination_ip
  - db_number
- name: s7_upload_block
  pattern: Upload|Start Upload|End Upload
  description: S7 Block Upload - Reading program blocks
  event_type: ot_traffic
  severity: medium
  fields:
  - source_ip
  - destination_ip
  - db_number
- name: s7_plc_stop
  pattern: PLC Stop|CPU Stop|P_PROGRAM.*STOP
  description: 'S7 PLC Stop - CRITICAL: Stopping PLC execution'
  event_type: ot_traffic
  severity: critical
  fields:
  - source_ip
  - destination_ip
- name: s7_plc_start
  pattern: PLC Start|CPU Start|P_PROGRAM.*START
  description: S7 PLC Start - Starting PLC execution
  event_type: ot_traffic
  severity: high
  fields:
  - source_ip
  - destination_ip
- name: s7_szl_read
  pattern: SZL|System Status List|Read SZL
  description: S7 Read System Status List - Device diagnostics
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
- name: s7_password
  pattern: Password|PLC Password|Authentication
  description: S7 Password/Authentication attempt
  event_type: ot_authentication
  fields:
  - source_ip
  - destination_ip
- name: s7_error
  pattern: error_class|S7.*Error|Return Code.*[^0]
  description: S7 Error Response
  event_type: ot_error
  fields:
  - source_ip
  - destination_ip
  - error_class
  - error_code
