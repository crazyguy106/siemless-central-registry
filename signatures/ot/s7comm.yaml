version: '1.0'
vendor: OT
product: S7comm
product_full_name: Siemens S7 Communication Protocol
log_type: structured
source_document: ''
source_url: ''
extraction_date: '2026-02-12'
source_file: ot-s7comm-signatures.json
generated_at: '2026-02-12T11:03:05.207619'
field_count: 16
fields:
- field_name: source_ip
  field_type: ip
  description: Client/HMI IP address
  ecs_field: source.ip
  cim_field: src_ip
  asim_field: SrcIpAddr
  category: network
  display_name: Source IP
- field_name: destination_ip
  field_type: ip
  description: PLC IP address
  ecs_field: destination.ip
  cim_field: dest_ip
  asim_field: DstIpAddr
  category: network
  display_name: Destination IP
- field_name: source_port
  field_type: port
  description: Client port
  ecs_field: source.port
  cim_field: src_port
  asim_field: SrcPortNumber
  category: network
  display_name: Source Port
- field_name: destination_port
  field_type: port
  description: PLC port (typically 102 for ISO-TSAP)
  ecs_field: destination.port
  cim_field: dest_port
  asim_field: DstPortNumber
  category: network
  display_name: Destination Port
- field_name: rosctr
  field_type: number
  description: Remote Operating Service Control (1=Job, 2=Ack, 3=Ack_Data, 7=Userdata)
  ecs_field: event.code
  cim_field: signature_id
  asim_field: EventOriginalType
  category: protocol
  display_name: ROSCTR
- field_name: function_code
  field_type: number
  description: S7 function code
  ecs_field: event.action
  cim_field: action
  asim_field: DvcAction
  category: protocol
  display_name: Function Code
- field_name: function_name
  field_type: string
  description: Human-readable function name
  ecs_field: event.reason
  cim_field: reason
  asim_field: EventResultDetails
  category: protocol
  display_name: Function Name
- field_name: area
  field_type: string
  description: S7 memory area (I=Inputs, Q=Outputs, M=Markers, DB=Data Block)
  ecs_field: file.type
  cim_field: object_category
  asim_field: TargetFileType
  category: data
  display_name: Memory Area
- field_name: db_number
  field_type: number
  description: Data block number (for DB area)
  ecs_field: file.inode
  cim_field: file_id
  asim_field: TargetFileId
  category: data
  display_name: Data Block Number
- field_name: start_address
  field_type: number
  description: Starting byte address
  ecs_field: ot.s7comm.start_address
  cim_field: object_path
  asim_field: TargetFilePath
  category: data
  display_name: Start Address
- field_name: length
  field_type: number
  description: Number of bytes to read/write
  ecs_field: file.size
  cim_field: bytes
  asim_field: SrcBytes
  category: data
  display_name: Data Length
- field_name: data_value
  field_type: string
  description: Read/written data value
  ecs_field: file.hash.md5
  cim_field: file_hash
  asim_field: TargetFileHashMd5
  category: data
  display_name: Data Value
- field_name: error_class
  field_type: number
  description: S7 error class
  ecs_field: error.code
  cim_field: error_code
  asim_field: EventResultDetails
  category: error
  display_name: Error Class
- field_name: error_code
  field_type: number
  description: S7 error code
  ecs_field: error.type
  cim_field: error_type
  asim_field: EventMessage
  category: error
  display_name: Error Code
- field_name: rack
  field_type: number
  description: PLC rack number
  ecs_field: host.geo.region_name
  cim_field: dest_zone
  asim_field: DstZone
  category: device
  display_name: Rack
- field_name: slot
  field_type: number
  description: PLC slot number
  ecs_field: host.geo.city_name
  cim_field: dest_location
  asim_field: DstGeoCity
  category: device
  display_name: Slot
signatures:
- name: s7comm_generic
  description: Generic Siemens S7comm protocol detection
  regex_pattern: (?i)s7comm|(?:rosctr|rack|slot|db_number|area)\s*[=:]\s*\d+
  priority: 10
  confidence: 0.85
  log_type: ot_traffic
  log_format: kv
- name: s7_read_var
  pattern: function_code[=:]\s*0?4\b|Read Var|S7.*READ
  description: S7 Read Variable - Read data from PLC memory
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
  - area
  - db_number
  - start_address
  - length
- name: s7_write_var
  pattern: function_code[=:]\s*0?5\b|Write Var|S7.*WRITE
  description: S7 Write Variable - CRITICAL WRITE OPERATION
  event_type: ot_traffic
  severity: high
  fields:
  - source_ip
  - destination_ip
  - area
  - db_number
  - start_address
  - data_value
- name: s7_setup_communication
  pattern: function_code[=:]\s*0?240\b|Setup Communication
  description: S7 Setup Communication - Connection establishment
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
  - rack
  - slot
- name: s7_download_block
  pattern: Download|Start Download|End Download
  description: 'S7 Block Download - CRITICAL: Program modification'
  event_type: ot_traffic
  severity: critical
  fields:
  - source_ip
  - destination_ip
  - db_number
- name: s7_upload_block
  pattern: Upload|Start Upload|End Upload
  description: S7 Block Upload - Reading program blocks
  event_type: ot_traffic
  severity: medium
  fields:
  - source_ip
  - destination_ip
  - db_number
- name: s7_plc_stop
  pattern: PLC Stop|CPU Stop|P_PROGRAM.*STOP
  description: 'S7 PLC Stop - CRITICAL: Stopping PLC execution'
  event_type: ot_traffic
  severity: critical
  fields:
  - source_ip
  - destination_ip
- name: s7_plc_start
  pattern: PLC Start|CPU Start|P_PROGRAM.*START
  description: S7 PLC Start - Starting PLC execution
  event_type: ot_traffic
  severity: high
  fields:
  - source_ip
  - destination_ip
- name: s7_szl_read
  pattern: SZL|System Status List|Read SZL
  description: S7 Read System Status List - Device diagnostics
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
- name: s7_password
  pattern: PLC.?Password|S7comm.*Auth|s7_password|COTP.*S7
  description: S7 Password/Authentication attempt
  event_type: ot_authentication
  fields:
  - source_ip
  - destination_ip
- name: s7_error
  pattern: error_class|S7.*Error|Return Code.*[^0]
  description: S7 Error Response
  event_type: ot_error
  fields:
  - source_ip
  - destination_ip
  - error_class
  - error_code
