version: '1.0'
vendor: OT
product: OPC-UA
product_full_name: OPC Unified Architecture
log_type: structured
source_document: ''
source_url: ''
extraction_date: '2026-02-12'
source_file: ot-opc_ua-signatures.json
generated_at: '2026-02-12T11:03:05.176392'
field_count: 16
fields:
- field_name: source_ip
  field_type: ip
  description: Client IP address
  ecs_field: source.ip
  cim_field: src_ip
  asim_field: SrcIpAddr
  category: network
  display_name: Source IP
- field_name: destination_ip
  field_type: ip
  description: Server IP address
  ecs_field: destination.ip
  cim_field: dest_ip
  asim_field: DstIpAddr
  category: network
  display_name: Destination IP
- field_name: source_port
  field_type: port
  description: Client port
  ecs_field: source.port
  cim_field: src_port
  asim_field: SrcPortNumber
  category: network
  display_name: Source Port
- field_name: destination_port
  field_type: port
  description: Server port (typically 4840)
  ecs_field: destination.port
  cim_field: dest_port
  asim_field: DstPortNumber
  category: network
  display_name: Destination Port
- field_name: message_type
  field_type: string
  description: OPC UA message type (HEL, ACK, OPN, CLO, MSG, ERR)
  ecs_field: event.code
  cim_field: signature_id
  asim_field: EventOriginalType
  category: protocol
  display_name: Message Type
- field_name: service_id
  field_type: number
  description: OPC UA service request/response ID
  ecs_field: event.action
  cim_field: action
  asim_field: DvcAction
  category: protocol
  display_name: Service ID
- field_name: service_name
  field_type: string
  description: Human-readable service name
  ecs_field: event.reason
  cim_field: reason
  asim_field: EventResultDetails
  category: protocol
  display_name: Service Name
- field_name: session_id
  field_type: string
  description: OPC UA session identifier
  ecs_field: event.id
  cim_field: session_id
  asim_field: DvcScopeId
  category: session
  display_name: Session ID
- field_name: authentication_token
  field_type: string
  description: Session authentication token
  ecs_field: process.entity_id
  cim_field: process_id
  asim_field: TargetProcessId
  category: session
  display_name: Authentication Token
- field_name: node_id
  field_type: string
  description: OPC UA node identifier
  ecs_field: file.path
  cim_field: object_path
  asim_field: TargetFilePath
  category: data
  display_name: Node ID
- field_name: node_value
  field_type: string
  description: Value of the node
  ecs_field: file.hash.md5
  cim_field: file_hash
  asim_field: TargetFileHashMd5
  category: data
  display_name: Node Value
- field_name: security_mode
  field_type: string
  description: Message security mode (None, Sign, SignAndEncrypt)
  ecs_field: tls.cipher
  cim_field: ssl_cipher
  asim_field: TlsCipher
  category: security
  display_name: Security Mode
- field_name: security_policy
  field_type: string
  description: Security policy URI
  ecs_field: tls.version
  cim_field: ssl_version
  asim_field: TlsVersion
  category: security
  display_name: Security Policy
- field_name: user_identity
  field_type: string
  description: Authenticated user identity
  ecs_field: user.name
  cim_field: user
  asim_field: TargetUsername
  category: authentication
  display_name: User Identity
- field_name: status_code
  field_type: number
  description: OPC UA status code
  ecs_field: event.outcome
  cim_field: result
  asim_field: EventResult
  category: result
  display_name: Status Code
- field_name: subscription_id
  field_type: number
  description: Subscription identifier for publish/subscribe
  ecs_field: event.sequence
  cim_field: transaction_id
  asim_field: EventOriginalUid
  category: subscription
  display_name: Subscription ID
signatures:
- name: opcua_hello
  pattern: message_type[=:]\s*HEL|OPC UA Hello
  description: OPC UA Hello - Connection initiation
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
- name: opcua_open_secure_channel
  pattern: message_type[=:]\s*OPN|OpenSecureChannel
  description: OPC UA Open Secure Channel
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
  - security_mode
  - security_policy
- name: opcua_create_session
  pattern: CreateSession|service_id[=:]\s*461
  description: OPC UA Create Session
  event_type: ot_session
  fields:
  - source_ip
  - destination_ip
  - session_id
- name: opcua_activate_session
  pattern: ActivateSession|service_id[=:]\s*467
  description: OPC UA Activate Session - Authentication
  event_type: ot_authentication
  fields:
  - source_ip
  - destination_ip
  - session_id
  - user_identity
- name: opcua_read
  pattern: service_id[=:]\s*631|OPC UA Read
  description: OPC UA Read - Read node values
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
  - node_id
- name: opcua_write
  pattern: service_id[=:]\s*673|OPC UA Write
  description: OPC UA Write - CRITICAL WRITE OPERATION
  event_type: ot_traffic
  severity: high
  fields:
  - source_ip
  - destination_ip
  - node_id
  - node_value
- name: opcua_browse
  pattern: service_id[=:]\s*527|Browse
  description: OPC UA Browse - Discover server address space
  event_type: ot_discovery
  fields:
  - source_ip
  - destination_ip
  - node_id
- name: opcua_call
  pattern: service_id[=:]\s*790|Call
  description: OPC UA Method Call - Execute server method
  event_type: ot_traffic
  severity: medium
  fields:
  - source_ip
  - destination_ip
  - node_id
- name: opcua_create_subscription
  pattern: CreateSubscription|service_id[=:]\s*787
  description: OPC UA Create Subscription
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
  - subscription_id
- name: opcua_error
  pattern: message_type[=:]\s*ERR|ServiceFault|status_code[=:]\s*0x8
  description: OPC UA Error/Fault
  event_type: ot_error
  fields:
  - source_ip
  - destination_ip
  - status_code
