signatures:
- vendor: ot
  product: opc_ua
  log_type: industrial
  version: null
  log_format: syslog
  signature_name: OPC UA Protocol
  primary_pattern: (?:opcua|node_id|namespace_index)\s*[=:]
  confidence: 0.88
  priority: 35
  source: github_sync
  sample_logs:
  - 'opcua: node_id: ns=2;s=Temperature, value: 25.5'
  - namespace_index=2 node_id=1001 browse_name=PLC1.Temperature
  - opc.tcp://server:4840 node_id=i=2258 value=running
  upstream_sources:
  - zeek
  documentation_url: https://opcfoundation.org/
  fields:
  - name: source_ip
    type: ip
    description: Client IP address
    ecs_field: source.ip
    cim_field: src_ip
    asim_field: SrcIpAddr
  - name: destination_ip
    type: ip
    description: Server IP address
    ecs_field: destination.ip
    cim_field: dest_ip
    asim_field: DstIpAddr
  - name: message_type
    type: string
    description: OPC UA message type (HEL, ACK, OPN, CLO, MSG, ERR)
    ecs_field: event.code
    cim_field: signature_id
    asim_field: EventOriginalType
  - name: service_id
    type: number
    description: OPC UA service request/response ID
    ecs_field: event.action
    cim_field: action
    asim_field: DvcAction
  - name: session_id
    type: string
    description: OPC UA session identifier
    ecs_field: event.id
    cim_field: session_id
    asim_field: DvcScopeId
  - name: node_id
    type: string
    description: OPC UA node identifier
    ecs_field: file.path
    cim_field: object_path
    asim_field: TargetFilePath
  - name: node_value
    type: string
    description: Value of the node
    ecs_field: file.hash.md5
    cim_field: file_hash
    asim_field: TargetFileHashMd5
  - name: security_mode
    type: string
    description: Message security mode (None, Sign, SignAndEncrypt)
    ecs_field: tls.cipher
    cim_field: ssl_cipher
    asim_field: TlsCipher
  - name: user_identity
    type: string
    description: Authenticated user identity
    ecs_field: user.name
    cim_field: user
    asim_field: TargetUsername
  - name: status_code
    type: number
    description: OPC UA status code
    ecs_field: event.outcome
    cim_field: result
    asim_field: EventResult
