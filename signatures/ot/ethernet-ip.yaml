signatures:
- vendor: ot
  product: ethernet_ip
  log_type: industrial
  version: null
  log_format: syslog
  signature_name: EtherNet/IP CIP Protocol
  primary_pattern: (?:cip_service|connection_id|originator)
  confidence: 0.9
  priority: 30
  source: github_sync
  sample_logs:
  - cip_service=0x4c connection_id=0x12345678 originator=10.1.1.1
  - 'enip: cip_service: get_attribute_single, connection_id: 12345'
  - ethernet_ip originator=10.0.0.100 target=10.0.0.1 service=read_tag
  upstream_sources:
  - zeek
  - suricata
  documentation_url: https://www.odva.org/
  fields:
  - name: source_ip
    type: ip
    description: Originator IP address
    ecs_field: source.ip
    cim_field: src_ip
    asim_field: SrcIpAddr
  - name: destination_ip
    type: ip
    description: Target IP address
    ecs_field: destination.ip
    cim_field: dest_ip
    asim_field: DstIpAddr
  - name: command
    type: number
    description: EtherNet/IP encapsulation command code
    ecs_field: event.code
    cim_field: signature_id
    asim_field: EventOriginalType
  - name: session_handle
    type: number
    description: Session identifier
    ecs_field: event.id
    cim_field: session_id
    asim_field: DvcScopeId
  - name: cip_service
    type: number
    description: CIP service code
    ecs_field: event.category
    cim_field: category
    asim_field: EventType
  - name: class_id
    type: number
    description: CIP object class ID
    ecs_field: file.type
    cim_field: object_category
    asim_field: TargetFileType
  - name: instance_id
    type: number
    description: CIP object instance ID
    ecs_field: file.inode
    cim_field: file_id
    asim_field: TargetFileId
  - name: attribute_id
    type: number
    description: CIP attribute ID
    ecs_field: file.name
    cim_field: file_name
    asim_field: TargetFileName
  - name: data_value
    type: string
    description: Attribute or tag value
    ecs_field: file.hash.md5
    cim_field: file_hash
    asim_field: TargetFileHashMd5
  - name: status
    type: number
    description: CIP general status code
    ecs_field: event.outcome
    cim_field: result
    asim_field: EventResult
  - name: connection_id
    type: number
    description: I/O connection identifier
    ecs_field: event.sequence
    cim_field: transaction_id
    asim_field: EventOriginalUid
