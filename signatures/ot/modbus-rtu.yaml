signatures:
- vendor: ot
  product: modbus_rtu
  log_type: industrial
  version: null
  log_format: syslog
  signature_name: Modbus RTU Gateway
  primary_pattern: (?:slave_id|crc_error|rtu_frame)
  confidence: 0.85
  priority: 40
  source: github_sync
  sample_logs:
  - slave_id=1 function=3 crc_error=false rtu_frame=true
  - 'modbus_rtu: slave_id: 5, function: 16, crc: valid'
  upstream_sources:
  - suricata
  documentation_url: https://www.modbus.org/specs.php
  note: Modbus RTU uses same protocol as Modbus TCP but with serial transport
  fields:
  - name: slave_id
    type: number
    description: Slave device address (1-247) - equivalent to unit_id in TCP
    ecs_field: destination.address
    cim_field: dest_id
    asim_field: DstDvcId
  - name: function_code
    type: number
    description: Modbus function code (1-127)
    ecs_field: event.code
    cim_field: signature_id
    asim_field: EventOriginalType
  - name: function_name
    type: string
    description: Human-readable function name
    ecs_field: event.action
    cim_field: action
    asim_field: DvcAction
  - name: register_address
    type: number
    description: Starting register/coil address (0-65535)
    ecs_field: file.offset
    cim_field: object_path
    asim_field: TargetFilePath
  - name: register_count
    type: number
    description: Number of registers/coils to read/write
    ecs_field: file.size
    cim_field: bytes
    asim_field: SrcBytes
  - name: register_value
    type: string
    description: Value read from or written to register
    ecs_field: file.hash.md5
    cim_field: file_hash
    asim_field: TargetFileHashMd5
  - name: exception_code
    type: number
    description: Modbus exception code (1-11) for error responses
    ecs_field: error.code
    cim_field: error_code
    asim_field: EventResultDetails
  - name: crc_error
    type: boolean
    description: Whether CRC check failed (RTU-specific)
    ecs_field: event.outcome
    cim_field: result
    asim_field: EventResult
  - name: serial_port
    type: string
    description: Serial port/interface (RTU-specific)
    ecs_field: observer.serial_number
    cim_field: dest_interface
    asim_field: DstInterfaceName
