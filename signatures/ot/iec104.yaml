version: '1.0'
vendor: OT
product: IEC104
product_full_name: IEC 60870-5-104
log_type: structured
source_document: ''
source_url: ''
extraction_date: '2026-01-31'
source_file: ot-iec104-signatures.json
generated_at: '2026-01-31T04:25:54.736999'
field_count: 14
fields:
- field_name: source_ip
  field_type: ip
  description: Controlling station IP
  ecs_field: source.ip
  cim_field: src_ip
  asim_field: SrcIpAddr
  category: network
  display_name: Source IP
- field_name: destination_ip
  field_type: ip
  description: Controlled station IP
  ecs_field: destination.ip
  cim_field: dest_ip
  asim_field: DstIpAddr
  category: network
  display_name: Destination IP
- field_name: source_port
  field_type: port
  description: Client port
  ecs_field: source.port
  cim_field: src_port
  asim_field: SrcPortNumber
  category: network
  display_name: Source Port
- field_name: destination_port
  field_type: port
  description: Server port (typically 2404)
  ecs_field: destination.port
  cim_field: dest_port
  asim_field: DstPortNumber
  category: network
  display_name: Destination Port
- field_name: apdu_type
  field_type: string
  description: Application Protocol Data Unit type (I, S, U)
  ecs_field: event.code
  cim_field: signature_id
  asim_field: EventOriginalType
  category: protocol
  display_name: APDU Type
- field_name: type_id
  field_type: number
  description: ASDU type identification (1-127)
  ecs_field: event.action
  cim_field: action
  asim_field: DvcAction
  category: protocol
  display_name: Type ID
- field_name: type_name
  field_type: string
  description: Human-readable type name
  ecs_field: event.reason
  cim_field: reason
  asim_field: EventResultDetails
  category: protocol
  display_name: Type Name
- field_name: cause_of_transmission
  field_type: number
  description: COT field indicating transmission reason
  ecs_field: event.category
  cim_field: category
  asim_field: EventType
  category: protocol
  display_name: Cause of Transmission
- field_name: common_address
  field_type: number
  description: ASDU address (station address)
  ecs_field: destination.address
  cim_field: dest_id
  asim_field: DstDvcId
  category: device
  display_name: Common Address
- field_name: information_object_address
  field_type: number
  description: Information Object Address
  ecs_field: file.offset
  cim_field: object_path
  asim_field: TargetFilePath
  category: data
  display_name: IOA
- field_name: value
  field_type: string
  description: Data value (measurement, status, command)
  ecs_field: file.hash.md5
  cim_field: file_hash
  asim_field: TargetFileHashMd5
  category: data
  display_name: Value
- field_name: quality
  field_type: string
  description: Data quality flags (IV, NT, SB, BL)
  ecs_field: event.outcome
  cim_field: result
  asim_field: EventResult
  category: data
  display_name: Quality Descriptor
- field_name: sequence_number_tx
  field_type: number
  description: Transmit sequence number
  ecs_field: event.sequence
  cim_field: sequence_number
  asim_field: EventOriginalUid
  category: protocol
  display_name: TX Sequence
- field_name: sequence_number_rx
  field_type: number
  description: Receive sequence number
  ecs_field: event.id
  cim_field: transaction_id
  asim_field: EventOriginalSubType
  category: protocol
  display_name: RX Sequence
signatures:
- name: iec104_single_point
  pattern: type_id[=:]\s*0?1\b|M_SP_NA|Single Point
  description: 'IEC 104 Type 1: Single Point Information'
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
  - common_address
  - information_object_address
  - value
- name: iec104_double_point
  pattern: type_id[=:]\s*0?3\b|M_DP_NA|Double Point
  description: 'IEC 104 Type 3: Double Point Information'
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
  - common_address
  - information_object_address
  - value
- name: iec104_measured_scaled
  pattern: type_id[=:]\s*11\b|M_ME_NB|Measured.*Scaled
  description: 'IEC 104 Type 11: Measured Value, Scaled'
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
  - common_address
  - information_object_address
  - value
  - quality
- name: iec104_measured_float
  pattern: type_id[=:]\s*13\b|M_ME_NC|Measured.*Float
  description: 'IEC 104 Type 13: Measured Value, Short Float'
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
  - common_address
  - information_object_address
  - value
  - quality
- name: iec104_single_command
  pattern: type_id[=:]\s*45\b|C_SC_NA|Single Command
  description: 'IEC 104 Type 45: Single Command - CRITICAL CONTROL'
  event_type: ot_traffic
  severity: critical
  fields:
  - source_ip
  - destination_ip
  - common_address
  - information_object_address
  - value
- name: iec104_double_command
  pattern: type_id[=:]\s*46\b|C_DC_NA|Double Command
  description: 'IEC 104 Type 46: Double Command - CRITICAL CONTROL'
  event_type: ot_traffic
  severity: critical
  fields:
  - source_ip
  - destination_ip
  - common_address
  - information_object_address
  - value
- name: iec104_regulating_step
  pattern: type_id[=:]\s*47\b|C_RC_NA|Regulating Step
  description: 'IEC 104 Type 47: Regulating Step Command - CRITICAL'
  event_type: ot_traffic
  severity: critical
  fields:
  - source_ip
  - destination_ip
  - common_address
  - information_object_address
- name: iec104_setpoint_scaled
  pattern: type_id[=:]\s*49\b|C_SE_NB|Setpoint.*Scaled
  description: 'IEC 104 Type 49: Set-point Command, Scaled - CRITICAL'
  event_type: ot_traffic
  severity: critical
  fields:
  - source_ip
  - destination_ip
  - common_address
  - information_object_address
  - value
- name: iec104_interrogation
  pattern: type_id[=:]\s*100\b|C_IC_NA|Interrogation
  description: 'IEC 104 Type 100: Interrogation Command'
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
  - common_address
- name: iec104_counter_interrogation
  pattern: type_id[=:]\s*101\b|C_CI_NA|Counter Interrogation
  description: 'IEC 104 Type 101: Counter Interrogation Command'
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
  - common_address
- name: iec104_clock_sync
  pattern: type_id[=:]\s*103\b|C_CS_NA|Clock Sync
  description: 'IEC 104 Type 103: Clock Synchronization'
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
  - common_address
- name: iec104_startdt
  pattern: STARTDT|U-format.*STARTDT
  description: IEC 104 STARTDT - Start Data Transfer
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
- name: iec104_stopdt
  pattern: STOPDT|U-format.*STOPDT
  description: IEC 104 STOPDT - Stop Data Transfer
  event_type: ot_traffic
  fields:
  - source_ip
  - destination_ip
