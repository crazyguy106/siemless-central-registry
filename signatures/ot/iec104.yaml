signatures:
- vendor: ot
  product: iec104
  log_type: power_grid
  version: null
  log_format: syslog
  signature_name: IEC 60870-5-104 Protocol
  primary_pattern: (?:asdu_type|information_object|cause_of_transmission)
  confidence: 0.9
  priority: 30
  source: github_sync
  sample_logs:
  - asdu_type=30 information_object=1001
  - "IEC104: M_ME_NC src=192.168.1.100 dst=192.168.1.10 CA=1 IOA=1001 Value=72.5"
  upstream_sources:
  - zeek
  documentation_url: https://webstore.iec.ch/publication/25035
  fields:
  - name: source_ip
    type: ip
    description: Controlling station IP
    ecs_field: source.ip
    cim_field: src_ip
    asim_field: SrcIpAddr
  - name: destination_ip
    type: ip
    description: Controlled station IP
    ecs_field: destination.ip
    cim_field: dest_ip
    asim_field: DstIpAddr
  - name: apdu_type
    type: string
    description: Application Protocol Data Unit type (I, S, U)
    ecs_field: event.code
    cim_field: signature_id
    asim_field: EventOriginalType
  - name: type_id
    type: number
    description: ASDU type identification (1-127)
    ecs_field: event.action
    cim_field: action
    asim_field: DvcAction
  - name: cause_of_transmission
    type: number
    description: COT field indicating transmission reason
    ecs_field: event.category
    cim_field: category
    asim_field: EventType
  - name: common_address
    type: number
    description: ASDU address (station address)
    ecs_field: destination.address
    cim_field: dest_id
    asim_field: DstDvcId
  - name: information_object_address
    type: number
    description: Information Object Address
    ecs_field: file.offset
    cim_field: object_path
    asim_field: TargetFilePath
  - name: value
    type: string
    description: Data value (measurement, status, command)
    ecs_field: file.hash.md5
    cim_field: file_hash
    asim_field: TargetFileHashMd5
  - name: quality
    type: string
    description: Data quality flags (IV, NT, SB, BL)
    ecs_field: event.outcome
    cim_field: result
    asim_field: EventResult
