version: '1.0'
vendor: OT
product: DNP3
product_full_name: Distributed Network Protocol 3
log_type: structured
source_document: ''
source_url: ''
extraction_date: '2026-02-12'
source_file: ot-dnp3-signatures.json
generated_at: '2026-02-12T11:03:05.092767'
field_count: 16
fields:
- field_name: source_address
  field_type: number
  description: DNP3 source station address (0-65519)
  ecs_field: source.address
  cim_field: src_id
  asim_field: SrcDvcId
  category: device
  display_name: Source Address
- field_name: destination_address
  field_type: number
  description: DNP3 destination station address (0-65519)
  ecs_field: destination.address
  cim_field: dest_id
  asim_field: DstDvcId
  category: device
  display_name: Destination Address
- field_name: function_code
  field_type: number
  description: DNP3 function code (0-255)
  ecs_field: event.code
  cim_field: signature_id
  asim_field: EventOriginalType
  category: protocol
  display_name: Function Code
- field_name: function_name
  field_type: string
  description: Human-readable function name
  ecs_field: event.action
  cim_field: action
  asim_field: DvcAction
  category: protocol
  display_name: Function Name
- field_name: object_group
  field_type: number
  description: DNP3 object group (data type category)
  ecs_field: file.type
  cim_field: object_category
  asim_field: TargetFileType
  category: data
  display_name: Object Group
- field_name: object_variation
  field_type: number
  description: DNP3 object variation (data format)
  ecs_field: file.extension
  cim_field: object_type
  asim_field: TargetFileName
  category: data
  display_name: Object Variation
- field_name: point_index
  field_type: number
  description: Data point index within object group
  ecs_field: ot.dnp3.point_index
  cim_field: object_path
  asim_field: TargetFilePath
  category: data
  display_name: Point Index
- field_name: point_value
  field_type: string
  description: Data point value
  ecs_field: file.hash.md5
  cim_field: file_hash
  asim_field: TargetFileHashMd5
  category: data
  display_name: Point Value
- field_name: control_code
  field_type: number
  description: Control relay output block code
  ecs_field: event.outcome
  cim_field: result
  asim_field: EventResult
  category: control
  display_name: Control Code
- field_name: internal_indications
  field_type: string
  description: IIN bits indicating device status
  ecs_field: host.os.type
  cim_field: os
  asim_field: DvcOs
  category: status
  display_name: Internal Indications
- field_name: source_ip
  field_type: ip
  description: Master station IP address (DNP3 over IP)
  ecs_field: source.ip
  cim_field: src_ip
  asim_field: SrcIpAddr
  category: network
  display_name: Source IP
- field_name: destination_ip
  field_type: ip
  description: Outstation IP address (DNP3 over IP)
  ecs_field: destination.ip
  cim_field: dest_ip
  asim_field: DstIpAddr
  category: network
  display_name: Destination IP
- field_name: source_port
  field_type: port
  description: Client port
  ecs_field: source.port
  cim_field: src_port
  asim_field: SrcPortNumber
  category: network
  display_name: Source Port
- field_name: destination_port
  field_type: port
  description: Server port (IANA-registered 20000, but configurable per deployment)
  ecs_field: destination.port
  cim_field: dest_port
  asim_field: DstPortNumber
  category: network
  display_name: Destination Port
- field_name: sequence_number
  field_type: number
  description: Application layer sequence number
  ecs_field: event.sequence
  cim_field: sequence_number
  asim_field: EventOriginalUid
  category: protocol
  display_name: Sequence Number
- field_name: unsolicited
  field_type: string
  description: Whether response is unsolicited (event-driven)
  ecs_field: network.direction
  cim_field: direction
  asim_field: NetworkDirection
  category: protocol
  display_name: Unsolicited Response
signatures:
- name: dnp3_generic
  description: Generic DNP3 (Distributed Network Protocol 3) detection
  regex_pattern: (?i)dnp3|(?:source_address|destination_address|function_code)\s*[=:]\s*\d+.*(?:outstation|master)
  priority: 10
  confidence: 0.85
  log_type: ot_traffic
  log_format: kv
- name: dnp3_read
  pattern: function_code[=:]\s*0?1\b|FC=0?1\b|DNP3.*READ|Read Request
  description: 'DNP3 Function 01: Read - Request data from outstation'
  event_type: ot_traffic
  fields:
  - source_address
  - destination_address
  - function_code
  - object_group
  - object_variation
- name: dnp3_write
  pattern: function_code[=:]\s*0?2\b|FC=0?2\b|DNP3.*WRITE|Write Request
  description: 'DNP3 Function 02: Write - CRITICAL WRITE OPERATION'
  event_type: ot_traffic
  severity: high
  fields:
  - source_address
  - destination_address
  - function_code
  - object_group
  - point_index
  - point_value
- name: dnp3_select
  pattern: function_code[=:]\s*0?3\b|FC=0?3\b|DNP3.*SELECT|Select Request
  description: 'DNP3 Function 03: Select - Pre-authorize control operation'
  event_type: ot_traffic
  severity: medium
  fields:
  - source_address
  - destination_address
  - function_code
  - control_code
- name: dnp3_operate
  pattern: function_code[=:]\s*0?4\b|FC=0?4\b|DNP3.*OPERATE|Operate Request
  description: 'DNP3 Function 04: Operate - Execute control operation - CRITICAL'
  event_type: ot_traffic
  severity: critical
  fields:
  - source_address
  - destination_address
  - function_code
  - control_code
- name: dnp3_direct_operate
  pattern: function_code[=:]\s*0?5\b|FC=0?5\b|DNP3.*DIRECT.*OPERATE|Direct Operate
  description: 'DNP3 Function 05: Direct Operate - Execute without select - CRITICAL'
  event_type: ot_traffic
  severity: critical
  fields:
  - source_address
  - destination_address
  - function_code
  - control_code
- name: dnp3_cold_restart
  pattern: function_code[=:]\s*13\b|FC=13\b|Cold Restart
  description: 'DNP3 Function 13: Cold Restart - Full device restart - CRITICAL'
  event_type: ot_traffic
  severity: critical
  fields:
  - source_address
  - destination_address
  - function_code
- name: dnp3_warm_restart
  pattern: function_code[=:]\s*14\b|FC=14\b|Warm Restart
  description: 'DNP3 Function 14: Warm Restart - Application restart'
  event_type: ot_traffic
  severity: high
  fields:
  - source_address
  - destination_address
  - function_code
- name: dnp3_unsolicited_response
  pattern: unsolicited|UNS=1|Unsolicited Response
  description: DNP3 Unsolicited Response - Event-driven data from outstation
  event_type: ot_traffic
  fields:
  - source_address
  - destination_address
  - object_group
  - point_index
  - point_value
- name: dnp3_authentication
  pattern: function_code[=:]\s*(32|33)\b|FC=(32|33)\b|DNP3.*Auth|Secure.Authentication.*DNP
  description: DNP3 Secure Authentication (SA) messages
  event_type: ot_authentication
  fields:
  - source_address
  - destination_address
  - function_code
- name: dnp3_file_transfer
  pattern: function_code[=:]\s*(25|26|27|28|29|30)\b|File.*Transfer
  description: DNP3 File Transfer operations
  event_type: ot_traffic
  severity: medium
  fields:
  - source_address
  - destination_address
  - function_code
