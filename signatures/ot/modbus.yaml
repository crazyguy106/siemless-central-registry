signatures:
- vendor: ot
  product: modbus
  log_type: industrial
  version: null
  log_format: syslog
  signature_name: Modbus Protocol Traffic
  primary_pattern: (?:function_code|unit_id|transaction_id)\s*[=:]\s*\d+
  confidence: 0.9
  priority: 30
  source: github_sync
  sample_logs:
  - function_code=3 unit_id=1 transaction_id=12345
  - "2026-01-18 10:30:45 modbus: src=192.168.1.100 dst=192.168.1.10 function_code=3 unit_id=1"
  upstream_sources:
  - zeek
  - suricata
  documentation_url: https://www.modbus.org/specs.php
  fields:
  - name: transaction_id
    type: number
    description: Unique identifier for request/response matching (Modbus TCP)
    ecs_field: event.sequence
    cim_field: transaction_id
    asim_field: EventOriginalUid
  - name: unit_id
    type: number
    description: Slave device address (1-247)
    ecs_field: destination.address
    cim_field: dest_id
    asim_field: DstDvcId
  - name: function_code
    type: number
    description: Modbus function code (1-127)
    ecs_field: event.code
    cim_field: signature_id
    asim_field: EventOriginalType
  - name: function_name
    type: string
    description: Human-readable function name
    ecs_field: event.action
    cim_field: action
    asim_field: DvcAction
  - name: register_address
    type: number
    description: Starting register/coil address (0-65535)
    ecs_field: file.offset
    cim_field: object_path
    asim_field: TargetFilePath
  - name: register_count
    type: number
    description: Number of registers/coils to read/write
    ecs_field: file.size
    cim_field: bytes
    asim_field: SrcBytes
  - name: register_value
    type: string
    description: Value read from or written to register
    ecs_field: file.hash.md5
    cim_field: file_hash
    asim_field: TargetFileHashMd5
  - name: exception_code
    type: number
    description: Modbus exception code (1-11) for error responses
    ecs_field: error.code
    cim_field: error_code
    asim_field: EventResultDetails
  - name: source_ip
    type: ip
    description: Master/client IP address
    ecs_field: source.ip
    cim_field: src_ip
    asim_field: SrcIpAddr
  - name: destination_ip
    type: ip
    description: Slave/server IP address
    ecs_field: destination.ip
    cim_field: dest_ip
    asim_field: DstIpAddr
  - name: source_port
    type: port
    description: Client ephemeral port
    ecs_field: source.port
    cim_field: src_port
    asim_field: SrcPortNumber
  - name: destination_port
    type: port
    description: Server port (typically 502)
    ecs_field: destination.port
    cim_field: dest_port
    asim_field: DstPortNumber
