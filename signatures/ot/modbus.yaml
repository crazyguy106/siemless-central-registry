version: '1.0'
vendor: OT
product: Modbus
product_full_name: Modbus TCP/RTU Industrial Protocol
log_type: structured
source_document: ''
source_url: ''
extraction_date: '2026-02-13'
source_file: ot-modbus-signatures.json
generated_at: '2026-02-13T07:34:34.063378'
field_count: 16
fields:
- field_name: transaction_id
  field_type: number
  description: Unique identifier for request/response matching (Modbus TCP)
  ecs_field: event.sequence
  cim_field: transaction_id
  asim_field: EventOriginalUid
  category: protocol
  display_name: Transaction ID
- field_name: unit_id
  field_type: number
  description: Slave device address (1-247)
  ecs_field: destination.address
  cim_field: dest_id
  asim_field: DstDvcId
  category: device
  display_name: Unit ID
- field_name: function_code
  field_type: number
  description: Modbus function code (1-127)
  ecs_field: event.code
  cim_field: signature_id
  asim_field: EventOriginalType
  category: protocol
  display_name: Function Code
- field_name: function_name
  field_type: string
  description: Human-readable function name (Read Coils, Write Register, etc.)
  ecs_field: event.action
  cim_field: action
  asim_field: DvcAction
  category: protocol
  display_name: Function Name
- field_name: register_address
  field_type: number
  description: Starting register/coil address (0-65535)
  ecs_field: event.code
  cim_field: object_path
  asim_field: TargetFilePath
  category: data
  display_name: Register Address
- field_name: register_count
  field_type: number
  description: Number of registers/coils to read/write
  ecs_field: file.size
  cim_field: bytes
  asim_field: SrcBytes
  category: data
  display_name: Register Count
- field_name: register_value
  field_type: string
  description: Value read from or written to register
  ecs_field: file.hash.md5
  cim_field: file_hash
  asim_field: TargetFileHashMd5
  category: data
  display_name: Register Value
- field_name: exception_code
  field_type: number
  description: Modbus exception code (1-11) for error responses
  ecs_field: error.code
  cim_field: error_code
  asim_field: EventResultDetails
  category: error
  display_name: Exception Code
- field_name: exception_name
  field_type: string
  description: Human-readable exception name (Illegal Function, Illegal Address, etc.)
  ecs_field: error.message
  cim_field: error_message
  asim_field: EventMessage
  category: error
  display_name: Exception Name
- field_name: source_ip
  field_type: ip
  description: Master/client IP address
  ecs_field: source.ip
  cim_field: src_ip
  asim_field: SrcIpAddr
  category: network
  display_name: Source IP
- field_name: destination_ip
  field_type: ip
  description: Slave/server IP address
  ecs_field: destination.ip
  cim_field: dest_ip
  asim_field: DstIpAddr
  category: network
  display_name: Destination IP
- field_name: source_port
  field_type: port
  description: Client ephemeral port
  ecs_field: source.port
  cim_field: src_port
  asim_field: SrcPortNumber
  category: network
  display_name: Source Port
- field_name: destination_port
  field_type: port
  description: Server port (typically 502 for Modbus TCP)
  ecs_field: destination.port
  cim_field: dest_port
  asim_field: DstPortNumber
  category: network
  display_name: Destination Port
- field_name: protocol_id
  field_type: number
  description: Modbus protocol identifier (always 0 for standard Modbus)
  ecs_field: network.iana_number
  cim_field: protocol
  asim_field: NetworkProtocol
  category: protocol
  display_name: Protocol ID
- field_name: length
  field_type: number
  description: Protocol data unit length in bytes
  ecs_field: network.bytes
  cim_field: bytes
  asim_field: NetworkBytes
  category: protocol
  display_name: PDU Length
- field_name: direction
  field_type: string
  description: Request or Response
  ecs_field: network.direction
  cim_field: direction
  asim_field: NetworkDirection
  category: protocol
  display_name: Direction
signatures:
- name: modbus_generic
  description: Generic Modbus TCP/RTU protocol detection
  regex_pattern: (?:function_code|fc|unit_id|slave_address|transaction_id)\s*[=:]\s*\d+
  priority: 10
  confidence: 0.85
  log_type: ot_traffic
  log_format: kv
- name: modbus_read_coils
  pattern: function_code[=:]\s*0?1\b|FC=0?1\b|Read Coils
  description: 'Modbus Function 01: Read Coils (Digital Outputs)'
  event_type: ot_traffic
  fields:
  - transaction_id
  - unit_id
  - function_code
  - register_address
  - register_count
- name: modbus_read_discrete_inputs
  pattern: function_code[=:]\s*0?2\b|FC=0?2\b|Read Discrete Inputs
  description: 'Modbus Function 02: Read Discrete Inputs'
  event_type: ot_traffic
  fields:
  - transaction_id
  - unit_id
  - function_code
  - register_address
  - register_count
- name: modbus_read_holding_registers
  pattern: function_code[=:]\s*0?3\b|FC=0?3\b|Read Holding Registers
  description: 'Modbus Function 03: Read Holding Registers'
  event_type: ot_traffic
  fields:
  - transaction_id
  - unit_id
  - function_code
  - register_address
  - register_count
- name: modbus_read_input_registers
  pattern: function_code[=:]\s*0?4\b|FC=0?4\b|Read Input Registers
  description: 'Modbus Function 04: Read Input Registers'
  event_type: ot_traffic
  fields:
  - transaction_id
  - unit_id
  - function_code
  - register_address
  - register_count
- name: modbus_write_single_coil
  pattern: function_code[=:]\s*0?5\b|FC=0?5\b|Write Single Coil
  description: 'Modbus Function 05: Write Single Coil - CRITICAL WRITE OPERATION'
  event_type: ot_traffic
  severity: medium
  fields:
  - transaction_id
  - unit_id
  - function_code
  - register_address
  - register_value
- name: modbus_write_single_register
  pattern: function_code[=:]\s*0?6\b|FC=0?6\b|Write Single Register
  description: 'Modbus Function 06: Write Single Register - CRITICAL WRITE OPERATION'
  event_type: ot_traffic
  severity: medium
  fields:
  - transaction_id
  - unit_id
  - function_code
  - register_address
  - register_value
- name: modbus_write_multiple_coils
  pattern: function_code[=:]\s*15\b|FC=15\b|Write Multiple Coils
  description: 'Modbus Function 15: Write Multiple Coils - HIGH RISK BULK WRITE'
  event_type: ot_traffic
  severity: high
  fields:
  - transaction_id
  - unit_id
  - function_code
  - register_address
  - register_count
- name: modbus_write_multiple_registers
  pattern: function_code[=:]\s*16\b|FC=16\b|Write Multiple Registers
  description: 'Modbus Function 16: Write Multiple Registers - HIGH RISK BULK WRITE'
  event_type: ot_traffic
  severity: high
  fields:
  - transaction_id
  - unit_id
  - function_code
  - register_address
  - register_count
- name: modbus_exception
  pattern: exception_code|Modbus Exception|function_code[=:]\s*(129|130|131|132|133|134|143|144)
  description: Modbus exception response (function code >= 128)
  event_type: ot_error
  fields:
  - transaction_id
  - unit_id
  - function_code
  - exception_code
  - exception_name
- name: modbus_diagnostics
  pattern: function_code[=:]\s*0?8\b|FC=0?8\b|Diagnostics
  description: 'Modbus Function 08: Diagnostics - Device troubleshooting'
  event_type: ot_traffic
  fields:
  - transaction_id
  - unit_id
  - function_code
- name: modbus_device_identification
  pattern: function_code[=:]\s*43\b|FC=43\b|Read Device Identification|MEI
  description: 'Modbus Function 43: Encapsulated Interface Transport / Device Identification'
  event_type: ot_traffic
  fields:
  - transaction_id
  - unit_id
  - function_code
