version: '1.0'
vendor: OWASP
product: ModSecurity WAF
product_full_name: OWASP ModSecurity Web Application Firewall
log_type: structured
source_document: ModSecurity 2 Data Formats
source_url: https://github.com/owasp-modsecurity/ModSecurity/wiki/ModSecurity-2-Data-Formats
extraction_date: '2026-01-02'
source_file: modsecurity-signatures.json
generated_at: '2026-02-13T07:34:33.800429'
categories:
- Header
- Request
- Response
- Trailer
- Alert
- Performance
- Sanitization
- Rules
field_count: 58
fields:
- field_name: timestamp
  field_type: datetime
  description: Transaction timestamp (e.g., 10/May/2024:12:34:56 +0000)
  ecs_field: '@timestamp'
  cim_field: _time
  asim_field: EventTime
  category: Header
- field_name: unique_id
  field_type: string
  description: Unique transaction identifier (Apache mod_unique_id format)
  ecs_field: event.id
  cim_field: unique_id
  asim_field: unique_id
  category: Header
- field_name: source_ip
  field_type: ip
  description: Client source IP address (IPv4 or IPv6)
  ecs_field: source.ip
  cim_field: src_ip
  asim_field: SrcIpAddr
  category: Header
- field_name: source_port
  field_type: integer
  description: Client source port number
  ecs_field: source.port
  cim_field: src_port
  asim_field: SrcPortNumber
  category: Header
- field_name: destination_ip
  field_type: ip
  description: Server destination IP address
  ecs_field: destination.ip
  cim_field: dest_ip
  asim_field: DstIpAddr
  category: Header
- field_name: destination_port
  field_type: integer
  description: Server destination port number (usually 80 or 443)
  ecs_field: destination.port
  cim_field: dest_port
  asim_field: DstPortNumber
  category: Header
- field_name: request_method
  field_type: string
  description: HTTP method (GET, POST, PUT, DELETE, etc.)
  ecs_field: http.request.method
  cim_field: request_method
  asim_field: request_method
  category: Request
- field_name: request_uri
  field_type: string
  description: Full request URI including query string
  ecs_field: url.full
  cim_field: request_uri
  asim_field: request_uri
  category: Request
- field_name: request_protocol
  field_type: string
  description: HTTP protocol version (HTTP/1.1, HTTP/2)
  ecs_field: network.transport
  cim_field: request_protocol
  asim_field: request_protocol
  category: Request
- field_name: request_headers
  field_type: object
  description: All HTTP request headers as key-value pairs
  ecs_field: owasp.modsecuritywaf.request_headers
  cim_field: owasp.modsecuritywaf.request_headers
  asim_field: owasp.modsecuritywaf.request_headers
  category: Request
- field_name: Host
  field_type: string
  description: HTTP Host header value
  ecs_field: url.domain
  cim_field: url_host
  asim_field: UrlHost
  category: Request
- field_name: User-Agent
  field_type: string
  description: Client User-Agent header
  ecs_field: user_agent.original
  cim_field: User-Agent
  asim_field: User-Agent
  category: Request
- field_name: Content-Type
  field_type: string
  description: Request Content-Type header
  ecs_field: owasp.modsecuritywaf.content_type
  cim_field: owasp.modsecuritywaf.content_type
  asim_field: owasp.modsecuritywaf.content_type
  category: Request
- field_name: Content-Length
  field_type: integer
  description: Request body length in bytes
  ecs_field: owasp.modsecuritywaf.content_length
  cim_field: owasp.modsecuritywaf.content_length
  asim_field: owasp.modsecuritywaf.content_length
  category: Request
- field_name: Cookie
  field_type: string
  description: HTTP Cookie header (may be sanitized)
  ecs_field: owasp.modsecuritywaf.cookie
  cim_field: owasp.modsecuritywaf.cookie
  asim_field: owasp.modsecuritywaf.cookie
  category: Request
- field_name: Referer
  field_type: string
  description: HTTP Referer header
  ecs_field: http.request.referrer
  cim_field: http_referrer
  asim_field: HttpReferrer
  category: Request
- field_name: X-Forwarded-For
  field_type: string
  description: Original client IP when behind proxy/load balancer
  ecs_field: source.ip
  cim_field: X-Forwarded-For
  asim_field: X-Forwarded-For
  category: Request
- field_name: request_body
  field_type: string
  description: Request body content (after dechunking/decompression)
  ecs_field: owasp.modsecuritywaf.request_body
  cim_field: owasp.modsecuritywaf.request_body
  asim_field: owasp.modsecuritywaf.request_body
  category: Request
- field_name: request_body_length
  field_type: integer
  description: Actual request body size in bytes
  ecs_field: owasp.modsecuritywaf.request_body_length
  cim_field: owasp.modsecuritywaf.request_body_length
  asim_field: owasp.modsecuritywaf.request_body_length
  category: Request
- field_name: response_protocol
  field_type: string
  description: Response HTTP protocol version
  ecs_field: network.transport
  cim_field: response_protocol
  asim_field: response_protocol
  category: Response
- field_name: response_status
  field_type: integer
  description: HTTP response status code (200, 403, 500, etc.)
  ecs_field: http.response.status_code
  cim_field: response_status
  asim_field: response_status
  category: Response
- field_name: response_headers
  field_type: object
  description: All HTTP response headers as key-value pairs
  ecs_field: owasp.modsecuritywaf.response_headers
  cim_field: owasp.modsecuritywaf.response_headers
  asim_field: owasp.modsecuritywaf.response_headers
  category: Response
- field_name: response_body
  field_type: string
  description: Response body before compression (Part E)
  ecs_field: owasp.modsecuritywaf.response_body
  cim_field: owasp.modsecuritywaf.response_body
  asim_field: owasp.modsecuritywaf.response_body
  category: Response
- field_name: response_body_length
  field_type: integer
  description: Response body size in bytes
  ecs_field: owasp.modsecuritywaf.response_body_length
  cim_field: owasp.modsecuritywaf.response_body_length
  asim_field: owasp.modsecuritywaf.response_body_length
  category: Response
- field_name: Action
  field_type: string
  description: Action taken for intercepted transactions (phase number)
  ecs_field: event.action
  cim_field: action
  asim_field: EventType
  category: Trailer
- field_name: Apache-Error
  field_type: string
  description: Apache error log messages (excluding ModSecurity)
  ecs_field: error.message
  cim_field: Apache-Error
  asim_field: Apache-Error
  category: Trailer
- field_name: Message
  field_type: array
  description: ModSecurity warnings/errors in order of occurrence
  ecs_field: message
  cim_field: msg
  asim_field: EventMessage
  category: Trailer
- field_name: Producer
  field_type: string
  description: ModSecurity version and component signatures
  ecs_field: owasp.modsecuritywaf.producer
  cim_field: owasp.modsecuritywaf.producer
  asim_field: owasp.modsecuritywaf.producer
  category: Trailer
- field_name: Response-Body-Transformed
  field_type: string
  description: Body transformation applied (e.g., Dechunked)
  ecs_field: owasp.modsecuritywaf.response_body_transformed
  cim_field: owasp.modsecuritywaf.response_body_transformed
  asim_field: owasp.modsecuritywaf.response_body_transformed
  category: Trailer
- field_name: Server
  field_type: string
  description: Web server identification and modules
  ecs_field: network.forwarded_ip
  cim_field: dhcp_server
  asim_field: DvcIpAddr
  category: Trailer
- field_name: WebApp-Info
  field_type: string
  description: Application ID, session ID, user ID (if available)
  ecs_field: user.id
  cim_field: WebApp-Info
  asim_field: WebApp-Info
  category: Trailer
- field_name: Stopwatch
  field_type: string
  description: Performance metrics in microseconds
  ecs_field: owasp.modsecuritywaf.stopwatch
  cim_field: owasp.modsecuritywaf.stopwatch
  asim_field: owasp.modsecuritywaf.stopwatch
  category: Performance
- field_name: stopwatch_timestamp
  field_type: integer
  description: Transaction timestamp since epoch (microseconds)
  ecs_field: event.action
  cim_field: stopwatch_timestamp
  asim_field: stopwatch_timestamp
  category: Performance
- field_name: stopwatch_duration
  field_type: integer
  description: Total transaction duration (microseconds)
  ecs_field: event.action
  cim_field: stopwatch_duration
  asim_field: stopwatch_duration
  category: Performance
- field_name: stopwatch_phase2_start
  field_type: integer
  description: Time to phase 2 start (microseconds)
  ecs_field: owasp.modsecuritywaf.stopwatch_phase2_start
  cim_field: owasp.modsecuritywaf.stopwatch_phase2_start
  asim_field: owasp.modsecuritywaf.stopwatch_phase2_start
  category: Performance
- field_name: stopwatch_phase2_complete
  field_type: integer
  description: Time to phase 2 completion (microseconds)
  ecs_field: owasp.modsecuritywaf.stopwatch_phase2_complete
  cim_field: owasp.modsecuritywaf.stopwatch_phase2_complete
  asim_field: owasp.modsecuritywaf.stopwatch_phase2_complete
  category: Performance
- field_name: stopwatch_response_buffered
  field_type: integer
  description: Time to full response body buffering (microseconds)
  ecs_field: owasp.modsecuritywaf.stopwatch_response_buffered
  cim_field: owasp.modsecuritywaf.stopwatch_response_buffered
  asim_field: owasp.modsecuritywaf.stopwatch_response_buffered
  category: Performance
- field_name: Sanitised-Args
  field_type: array
  description: Arguments redacted before logging
  ecs_field: owasp.modsecuritywaf.sanitised_args
  cim_field: owasp.modsecuritywaf.sanitised_args
  asim_field: owasp.modsecuritywaf.sanitised_args
  category: Sanitization
- field_name: Sanitised-Request-Headers
  field_type: array
  description: Request headers redacted before logging
  ecs_field: owasp.modsecuritywaf.sanitised_request_headers
  cim_field: owasp.modsecuritywaf.sanitised_request_headers
  asim_field: owasp.modsecuritywaf.sanitised_request_headers
  category: Sanitization
- field_name: Sanitised-Response-Headers
  field_type: array
  description: Response headers redacted before logging
  ecs_field: owasp.modsecuritywaf.sanitised_response_headers
  cim_field: owasp.modsecuritywaf.sanitised_response_headers
  asim_field: owasp.modsecuritywaf.sanitised_response_headers
  category: Sanitization
- field_name: rule_id
  field_type: string
  description: Unique rule identifier (e.g., 942100)
  ecs_field: rule.id
  cim_field: rule_id
  asim_field: RuleId
  category: Alert
- field_name: rule_rev
  field_type: string
  description: Rule revision number
  ecs_field: owasp.modsecuritywaf.rule_rev
  cim_field: owasp.modsecuritywaf.rule_rev
  asim_field: owasp.modsecuritywaf.rule_rev
  category: Alert
- field_name: rule_msg
  field_type: string
  description: Human-readable rule description/message
  ecs_field: owasp.modsecuritywaf.rule_msg
  cim_field: owasp.modsecuritywaf.rule_msg
  asim_field: owasp.modsecuritywaf.rule_msg
  category: Alert
- field_name: rule_severity
  field_type: string
  description: Event severity (EMERGENCY, ALERT, CRITICAL, ERROR, WARNING, NOTICE,
    INFO, DEBUG)
  ecs_field: event.severity
  cim_field: rule_severity
  asim_field: rule_severity
  category: Alert
- field_name: rule_file
  field_type: string
  description: Path to rule file containing the matched rule
  ecs_field: owasp.modsecuritywaf.rule_file
  cim_field: owasp.modsecuritywaf.rule_file
  asim_field: owasp.modsecuritywaf.rule_file
  category: Alert
- field_name: rule_line
  field_type: integer
  description: Line number in rule file
  ecs_field: owasp.modsecuritywaf.rule_line
  cim_field: owasp.modsecuritywaf.rule_line
  asim_field: owasp.modsecuritywaf.rule_line
  category: Alert
- field_name: rule_data
  field_type: string
  description: Transaction data fragment from logdata action
  ecs_field: event.action
  cim_field: rule_data
  asim_field: rule_data
  category: Alert
- field_name: rule_offset
  field_type: integer
  description: Byte offset of match within target data
  ecs_field: owasp.modsecuritywaf.rule_offset
  cim_field: owasp.modsecuritywaf.rule_offset
  asim_field: owasp.modsecuritywaf.rule_offset
  category: Alert
- field_name: rule_tags
  field_type: array
  description: Rule tags (OWASP_CRS, attack-sqli, CAPEC-66, etc.)
  ecs_field: owasp.modsecuritywaf.rule_tags
  cim_field: owasp.modsecuritywaf.rule_tags
  asim_field: owasp.modsecuritywaf.rule_tags
  category: Alert
- field_name: rule_maturity
  field_type: integer
  description: Rule maturity level (1-9)
  ecs_field: owasp.modsecuritywaf.rule_maturity
  cim_field: owasp.modsecuritywaf.rule_maturity
  asim_field: owasp.modsecuritywaf.rule_maturity
  category: Alert
- field_name: rule_accuracy
  field_type: integer
  description: Rule accuracy level (1-9)
  ecs_field: owasp.modsecuritywaf.rule_accuracy
  cim_field: owasp.modsecuritywaf.rule_accuracy
  asim_field: owasp.modsecuritywaf.rule_accuracy
  category: Alert
- field_name: rule_ver
  field_type: string
  description: Rule version (e.g., OWASP_CRS/4.0.0)
  ecs_field: owasp.modsecuritywaf.rule_ver
  cim_field: owasp.modsecuritywaf.rule_ver
  asim_field: owasp.modsecuritywaf.rule_ver
  category: Alert
- field_name: matched_rules
  field_type: array
  description: All rules that matched during transaction processing
  ecs_field: event.action
  cim_field: matched_rules
  asim_field: matched_rules
  category: Rules
- field_name: matched_var
  field_type: string
  description: Variable name that matched (ARGS:foo, REQUEST_URI)
  ecs_field: url.full
  cim_field: matched_var
  asim_field: matched_var
  category: Rules
- field_name: matched_var_name
  field_type: string
  description: Full variable name with collection
  ecs_field: owasp.modsecuritywaf.matched_var_name
  cim_field: owasp.modsecuritywaf.matched_var_name
  asim_field: owasp.modsecuritywaf.matched_var_name
  category: Rules
- field_name: tx.anomaly_score
  field_type: integer
  description: Cumulative anomaly score from all matched rules
  ecs_field: owasp.modsecuritywaf.tx_anomaly_score
  cim_field: owasp.modsecuritywaf.tx_anomaly_score
  asim_field: owasp.modsecuritywaf.tx_anomaly_score
  category: Rules
- field_name: tx.inbound_anomaly_score
  field_type: integer
  description: Inbound (request) anomaly score
  ecs_field: owasp.modsecuritywaf.tx_inbound_anomaly_score
  cim_field: owasp.modsecuritywaf.tx_inbound_anomaly_score
  asim_field: owasp.modsecuritywaf.tx_inbound_anomaly_score
  category: Rules
- field_name: tx.outbound_anomaly_score
  field_type: integer
  description: Outbound (response) anomaly score
  ecs_field: owasp.modsecuritywaf.tx_outbound_anomaly_score
  cim_field: owasp.modsecuritywaf.tx_outbound_anomaly_score
  asim_field: owasp.modsecuritywaf.tx_outbound_anomaly_score
  category: Rules
notes: ModSecurity is an open source, cross platform WAF engine for Apache, Nginx,
  and IIS. Audit logs are segmented into parts A-Z.
