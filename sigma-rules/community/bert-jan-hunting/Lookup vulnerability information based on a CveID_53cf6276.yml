title: Lookup vulnerability information based on a CveID
id: 7ddd80df-49f2-4067-a39d-bc194ac25261
status: experimental
level: medium
description: |
  KQL detection rule: Lookup vulnerability information based on a CveID
author: Bert-JanP
logsource:
  product: microsoft_security
  service: kql
detection:
  _kql_query: |
    let CVE = "CVE-2022-3602"; // Add your CVEid here
    DeviceTvmSoftwareVulnerabilities
    | where CveId == CVE
    | summarize VulnerableDevices = make_set(DeviceName) by CveId
    | join DeviceTvmSoftwareVulnerabilitiesKB on CveId
    | extend TotalDevices = array_length(VulnerableDevices)
    | project TotalDevices, CveId, VulnerabilitySeverityLevel, CvssScore, VulnerabilityDescription, VulnerableDevices
  condition: _kql_query
references:
  - https://github.com/Bert-JanP/Hunting-Queries-Detection-Rules
