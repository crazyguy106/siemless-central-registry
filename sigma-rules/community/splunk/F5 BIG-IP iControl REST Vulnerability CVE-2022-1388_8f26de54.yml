title: F5 BIG-IP iControl REST Vulnerability CVE-2022-1388
id: f7d5dade-6f29-50d7-9cb1-084aaffced1d
status: stable
level: high
description: |
  The following analytic detects attempts to exploit the F5 BIG-IP iControl REST API vulnerability (CVE-2022-1388) for unauthenticated remote code execution. It identifies suspicious URI paths and POST HTTP methods, along with specific request headers containing potential commands in the `utilcmdargs` field and a random base64 encoded value in the `X-F5-Auth-Token` field. This activity is significant as it targets a critical vulnerability that can allow attackers to execute arbitrary commands on t
author: Michael Haag, Splunk
logsource:
  product: splunk
detection:
  selection:
    url: '*/mgmt/tm/util/bash*'
    http_method: POST
    datamodel: Web
  condition: selection
tags:
  - attack.t1190
  - attack.t1133
references:
  - https://github.com/dk4trin/templates-nuclei/blob/main/CVE-2022-1388.yaml
  - https://www.randori.com/blog/vulnerability-analysis-cve-2022-1388/
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1388
  - https://twitter.com/da_667/status/1523770267327250438?s=20&t=-JnB_aNWuJFsmcOmxGUWLQ
  - https://github.com/horizon3ai/CVE-2022-1388/blob/main/CVE-2022-1388.py
custom_attributes:
  original_rule_id: bb1c2c30-107a-4e56-a4b9-1f7022867bfe
  source_format: splunk_spl