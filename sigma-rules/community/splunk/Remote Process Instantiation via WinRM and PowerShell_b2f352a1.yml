title: Remote Process Instantiation via WinRM and PowerShell
id: 3e8e3127-2af6-5ab2-8a30-b67cbc28ddd1
status: stable
level: high
description: |
  The following analytic detects the execution of `powershell.exe` with arguments used to start a process on a remote endpoint via the WinRM protocol, specifically targeting the `Invoke-Command` cmdlet. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on command-line executions and process telemetry. This activity is significant as it may indicate lateral movement or remote code execution attempts by adversaries. If confirmed malicious, this could allow attackers to ex
author: Mauricio Velazco, Splunk
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    process:
      - '*Invoke-Command*'
      - '*-ComputerName*'
  condition: selection
tags:
  - attack.t1021.006
references:
  - https://attack.mitre.org/techniques/T1021/006/
  - https://pentestlab.blog/2018/05/15/lateral-movement-winrm/
custom_attributes:
  original_rule_id: ba24cda8-4716-11ec-8009-3e22fbd008af
  source_format: splunk_spl