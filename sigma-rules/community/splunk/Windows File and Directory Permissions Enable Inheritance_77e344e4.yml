title: Windows File and Directory Permissions Enable Inheritance
id: 9dfc50b8-5c01-587e-a578-7d26390117bb
status: stable
level: low
description: |
  The following analytic detects the enabling of permission inheritance using ICACLS. This analytic identifies instances where ICACLS commands are used to enable permission inheritance on files or directories. The /inheritance:e flag, which restores inherited permissions from a parent directory, is monitored to detect changes that might reapply broader access control settings. Enabling inheritance can indicate legitimate administrative actions but may also signal attempts to override restrictive c
author: Teoderick Contreras, Splunk
logsource:
  product: windows
  category: file_event
detection:
  selection:
    process: '*/inheritance:e*'
    process_name:
      - icacls.exe
      - cacls.exe
      - xcacls.exe
  condition: selection
tags:
  - attack.t1222.001
references:
  - https://www.splunk.com/en_us/blog/security/-applocker-rules-as-defense-evasion-complete-analysis.html
custom_attributes:
  original_rule_id: 0247f90a-aca4-47b2-a94d-e30f445d7b41
  source_format: splunk_spl