title: Windows Find Interesting ACL with FindInterestingDomainAcl
id: bc60ca20-6972-50fb-90bb-6ea283874f40
status: stable
level: high
description: |
  The following analytic detects the execution of the `Find-InterestingDomainAcl` cmdlet, part of the PowerView toolkit, using PowerShell Script Block Logging (EventCode=4104). This detection leverages logs to identify when this command is run, which is significant as adversaries may use it to find misconfigured or unusual Access Control Lists (ACLs) within a domain. If confirmed malicious, this activity could allow attackers to identify privilege escalation opportunities or weak security configur
author: Gowthamaraj Rajendran, Mauricio Velazco, Splunk
logsource:
  product: windows
detection:
  selection:
    scriptblocktext: '*Find-InterestingDomainAcl*'
    eventcode: 4104
  condition: selection
tags:
  - attack.t1087.002
references:
  - https://powersploit.readthedocs.io/en/latest/Recon/Find-InterestingDomainAcl/
  - https://attack.mitre.org/techniques/T1087/002/
  - https://book.hacktricks.xyz/windows-hardening/basic-powershell-for-pentesters/powerview
custom_attributes:
  original_rule_id: e4a96dfd-667a-4487-b942-ccef5a1e81e8
  source_format: splunk_spl