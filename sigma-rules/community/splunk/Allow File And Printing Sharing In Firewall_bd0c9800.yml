title: Allow File And Printing Sharing In Firewall
id: 1dfbe630-4327-55df-838a-1411b0ab1bc4
status: stable
level: high
description: |
  The following analytic detects the modification of firewall settings to allow file and printer sharing. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on command-line executions involving 'netsh' commands that enable file and printer sharing. This activity is significant because it can indicate an attempt by ransomware to discover and encrypt files on additional machines connected to the compromised host. If confirmed malicious, this could lead to widespread file e
author: Teoderick Contreras, Splunk
logsource:
  product: splunk
  category: file_event
detection:
  selection:
    process:
      - '*firewall*'
      - '*group=\'
      - '*enable=Yes*'
  condition: selection
tags:
  - attack.t1562.007
references:
  - https://community.fortinet.com:443/t5/FortiEDR/How-FortiEDR-detects-and-blocks-Revil-Ransomware-aka-sodinokibi/ta-p/189638?externalID=FD52469
  - https://app.any.run/tasks/c0f98850-af65-4352-9746-fbebadee4f05/
custom_attributes:
  original_rule_id: ce27646e-d411-11eb-8a00-acde48001122
  source_format: splunk_spl