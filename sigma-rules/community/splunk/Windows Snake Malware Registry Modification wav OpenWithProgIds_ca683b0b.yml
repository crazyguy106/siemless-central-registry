title: Windows Snake Malware Registry Modification wav OpenWithProgIds
id: c9bc1606-9cf4-5135-a5a6-023d6b239504
status: stable
level: high
description: |
  The following analytic identifies modifications to the registry path .wav\\OpenWithProgIds, associated with the Snake Malware campaign. It leverages data from the Endpoint.Registry datamodel to detect changes in this specific registry location. This activity is significant because Snake's WerFault.exe uses this registry path to decrypt an encrypted blob containing critical components like the AES key, IV, and paths for its kernel driver and loader. If confirmed malicious, this could allow the at
author: Michael Haag, Splunk
logsource:
  product: windows
  category: registry_event
detection:
  selection:
    registry_path: '*\\.wav\\OpenWithProgIds\\*'
  condition: selection
tags:
  - attack.t1112
references:
  - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
custom_attributes:
  original_rule_id: 13cf8b79-805d-443c-bf52-f55bd7610dfd
  source_format: splunk_spl