title: Linux c89 Privilege Escalation
id: 7fe367a6-a9a0-5cc2-93fa-7ef66aad5578
status: stable
level: medium
description: |
  The following analytic detects the execution of the 'c89' command with elevated privileges, which can be used to compile and execute C programs as root. This detection leverages data from Endpoint Detection and Response (EDR) agents, focusing on process creation events that include command-line arguments. This activity is significant because it indicates a potential privilege escalation attempt, allowing a user to execute arbitrary commands as root. If confirmed malicious, this could lead to ful
author: Gowthamaraj Rajendran, Splunk
logsource:
  product: linux
detection:
  selection:
    process:
      - '*c89*'
      - '*-wrapper*'
      - '*sudo*'
  condition: selection
tags:
  - attack.t1548.003
references:
  - https://gtfobins.github.io/gtfobins/c89/
  - https://www.ibm.com/docs/en/zos/2.1.0?topic=guide-c89-compiler-invocation-using-host-environment-variables
custom_attributes:
  original_rule_id: 54c95f4d-3e5d-44be-9521-ea19ba62f7a8
  source_format: splunk_spl