title: Impacket Lateral Movement smbexec CommandLine Parameters
id: 6ec7dea5-8005-5f7d-9c0b-4d747ca50c0b
status: stable
level: high
description: |
  The following analytic identifies suspicious command-line parameters associated with the use of Impacket's smbexec.py for lateral movement. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on specific command-line patterns indicative of Impacket tool usage. This activity is significant as both Red Teams and adversaries use Impacket for remote code execution and lateral movement. If confirmed malicious, this activity could allow attackers to execute commands on remote
author: Michael Haag, Splunk
logsource:
  product: splunk
  category: process_creation
detection:
  selection:
    _spl_reference: true
  condition: selection
tags:
  - attack.t1021.002
  - attack.t1021.003
  - attack.t1047
  - attack.t1543.003
references:
  - https://attack.mitre.org/techniques/T1021/002/
  - https://attack.mitre.org/techniques/T1021/003/
  - https://attack.mitre.org/techniques/T1047/
  - https://attack.mitre.org/techniques/T1053/
  - https://attack.mitre.org/techniques/T1053/005/
custom_attributes:
  original_rule_id: bb3c1bac-6bdf-4aa0-8dc9-068b8b712a76
  source_format: splunk_spl