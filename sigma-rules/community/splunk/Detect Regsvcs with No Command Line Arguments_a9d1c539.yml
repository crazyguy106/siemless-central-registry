title: Detect Regsvcs with No Command Line Arguments
id: 4ee184df-a17d-5526-a093-aa996bcae79b
status: stable
level: high
description: |
  The following analytic detects instances of regsvcs.exe running without command line arguments. This behavior typically indicates process injection, where another process manipulates regsvcs.exe. The detection leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names, IDs, and command-line executions. This activity is significant as it may signal an attempt to evade detection and execute malicious code. If confirmed malicious, the attacker could achieve code exe
author: Michael Haag, Splunk
logsource:
  product: splunk
  category: process_creation
detection:
  selection:
    process:
      - '*regsvcs'
      - '*regsvcs.exe'
      - '*regsvcs.exe\'
  condition: selection
tags:
  - attack.t1218.009
references:
  - https://attack.mitre.org/techniques/T1218/009/
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.009/T1218.009.md
  - https://lolbas-project.github.io/lolbas/Binaries/Regsvcs/
custom_attributes:
  original_rule_id: 6b74d578-a02e-4e94-a0d1-39440d0bf254
  source_format: splunk_spl