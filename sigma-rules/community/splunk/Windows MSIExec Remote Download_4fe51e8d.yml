title: Windows MSIExec Remote Download
id: c4893d5c-a6a0-549d-9449-6ca8c1281273
status: stable
level: high
description: |
  The following analytic detects the use of msiexec.exe with an HTTP or HTTPS URL in the command line, indicating a remote file download attempt. This detection leverages data from Endpoint Detection and Response (EDR) agents, focusing on process execution logs that include command-line details. This activity is significant as it may indicate an attempt to download and execute potentially malicious software from a remote server. If confirmed malicious, this could lead to unauthorized code executio
author: Michael Haag, Splunk
logsource:
  product: windows
detection:
  selection:
    process:
      - '*http://*'
      - '*https://*'
  condition: selection
tags:
  - attack.t1218.007
references:
  - https://thedfirreport.com/2022/06/06/will-the-real-msiexec-please-stand-up-exploit-leads-to-data-exfiltration/
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.007/T1218.007.md
custom_attributes:
  original_rule_id: 6aa49ff2-3c92-4586-83e0-d83eb693dfda
  source_format: splunk_spl