title: Suspicious PlistBuddy Usage via OSquery
id: 149713e0-951c-5963-8423-0e9694b17494
status: experimental
level: high
description: |
  The following analytic detects the use of the PlistBuddy utility on macOS to create or modify property list (.plist) files. It leverages OSQuery to monitor process events, specifically looking for commands that interact with LaunchAgents and set properties like RunAtLoad. This activity is significant because PlistBuddy can be used to establish persistence mechanisms, as seen in malware like Silver Sparrow. If confirmed malicious, this could allow an attacker to maintain persistence, execute arbi
author: Michael Haag, Splunk
logsource:
  product: macos
detection:
  selection:
    _spl_reference: true
  condition: selection
tags:
  - attack.t1543.001
references:
  - https://www.marcosantadev.com/manage-plist-files-plistbuddy/
custom_attributes:
  original_rule_id: 20ba6c32-c733-4a32-b64e-2688cf231399
  source_format: splunk_spl