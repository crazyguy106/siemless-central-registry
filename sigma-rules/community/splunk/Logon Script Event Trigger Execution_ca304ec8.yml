title: Logon Script Event Trigger Execution
id: 3a445596-b837-5bc6-9d40-57029b1e703f
status: stable
level: high
description: |
  The following analytic detects the modification of the UserInitMprLogonScript registry entry, which is often used by attackers to establish persistence and gain privilege escalation upon system boot. It leverages data from the Endpoint.Registry data model, focusing on changes to the specified registry path. This activity is significant because it is a common technique used by APT groups and malware to ensure their payloads execute automatically when the system starts. If confirmed malicious, thi
author: Teoderick Contreras, Splunk
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    registry_path:
      - '*\\Environment\\UserInitMprLogonScript'
  condition: selection
tags:
  - attack.t1037.001
references:
  - https://attack.mitre.org/techniques/T1037/001/
custom_attributes:
  original_rule_id: 4c38c264-1f74-11ec-b5fa-acde48001122
  source_format: splunk_spl