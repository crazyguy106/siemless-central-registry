title: Linux AWK Privilege Escalation
id: a050bf28-0f67-52b0-ba24-f7bdfbcb8276
status: stable
level: medium
description: |
  The following analytic detects the use of the AWK command with elevated privileges to execute system commands. It leverages Endpoint Detection and Response (EDR) telemetry, specifically monitoring processes that include "sudo," "awk," and "BEGIN*system" in their command lines. This activity is significant because it indicates a potential privilege escalation attempt, where a user could gain root access by executing commands as the root user. If confirmed malicious, this could allow an attacker t
author: Gowthamaraj Rajendran, Splunk
logsource:
  product: linux
detection:
  selection:
    process:
      - '*sudo*'
      - '*awk*'
      - '*BEGIN*system*'
  condition: selection
tags:
  - attack.t1548.003
references:
  - https://www.hacknos.com/awk-privilege-escalation/
custom_attributes:
  original_rule_id: 4510cae0-96a2-4840-9919-91d262db210a
  source_format: splunk_spl