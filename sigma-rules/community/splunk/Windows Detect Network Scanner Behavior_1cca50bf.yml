title: Windows Detect Network Scanner Behavior
id: c0315b01-34f7-5e60-8d94-4ef717cf101b
status: stable
level: medium
description: |
  The following analytic detects when an application is used to connect a large number of unique ports/targets within a short time frame. Network enumeration may be used by adversaries as a method of discovery, lateral movement, or remote execution. This analytic may require significant tuning depending on the organization and applications being actively used, highly recommended to pre-populate the filter macro prior to activation.
author: Steven Dick
logsource:
  product: windows
  category: network_connection
detection:
  selection:
    app: '*\\*'
    span: 5m
    field: app
    dest_port:
      - 8443
      - 8080
      - 5353
      - 3268
      - 443
      - 389
      - 88
      - 80
      - 53
      - 25
  condition: selection
tags:
  - attack.t1595.001
  - attack.t1595.002
references:
  - https://attack.mitre.org/techniques/T1595
custom_attributes:
  original_rule_id: 78e678d2-bf64-4fe6-aa52-2f7b11dddee7
  source_format: splunk_spl