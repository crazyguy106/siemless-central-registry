title: Detect HTML Help URL in Command Line
id: 9f3459bb-9de5-5c53-a31d-1424ef0d8db2
status: stable
level: high
description: |
  The following analytic detects the execution of hh.exe (HTML Help) loading a Compiled HTML Help (CHM) file from a remote URL. This detection leverages data from Endpoint Detection and Response (EDR) agents, focusing on command-line executions containing URLs. This activity is significant as it can indicate an attempt to execute malicious scripts via CHM files, potentially leading to unauthorized code execution. If confirmed malicious, this could allow an attacker to run scripts using engines lik
author: Michael Haag, Splunk
logsource:
  product: splunk
  category: process_creation
detection:
  selection:
    _spl_reference: true
  condition: selection
tags:
  - attack.t1218.001
references:
  - https://attack.mitre.org/techniques/T1218/001/
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.001/T1218.001.md
  - https://lolbas-project.github.io/lolbas/Binaries/Hh/
  - https://blog.sevagas.com/?Hacking-around-HTA-files
  - https://gist.github.com/mgeeky/cce31c8602a144d8f2172a73d510e0e7
custom_attributes:
  original_rule_id: 8c5835b9-39d9-438b-817c-95f14c69a31e
  source_format: splunk_spl