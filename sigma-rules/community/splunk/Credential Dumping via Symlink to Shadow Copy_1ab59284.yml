title: Credential Dumping via Symlink to Shadow Copy
id: 0ff6e54c-df3f-519c-8fcb-eb7a9c252279
status: stable
level: high
description: |
  The following analytic detects the creation of a symlink to a shadow copy, which may indicate credential dumping attempts. It leverages the Endpoint.Processes data model in Splunk to identify processes executing commands containing "mklink" and "HarddiskVolumeShadowCopy". This activity is significant because attackers often use this technique to manipulate or delete shadow copies, hindering system backup and recovery efforts. If confirmed malicious, this could prevent data restoration, complicat
author: Patrick Bareiss, Splunk
logsource:
  product: splunk
  category: authentication
detection:
  selection:
    _spl_reference: true
  condition: selection
tags:
  - attack.t1003.003
references:
  - https://2017.zeronights.org/wp-content/uploads/materials/ZN17_Kheirkhabarov_Hunting_for_Credentials_Dumping_in_Windows_Environment.pdf
custom_attributes:
  original_rule_id: c5eac648-fae0-4263-91a6-773df1f4c903
  source_format: splunk_spl