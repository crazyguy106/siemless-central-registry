title: Windows Findstr GPP Discovery
id: d1572547-8ad6-5924-9017-35fedeb0080a
status: stable
level: high
description: |
  The following analytic detects the use of the findstr command to search for unsecured credentials in Group Policy Preferences (GPP). It leverages data from Endpoint Detection and Response (EDR) agents, focusing on command-line executions involving findstr.exe with references to SYSVOL and cpassword. This activity is significant because it indicates an attempt to locate and potentially decrypt embedded credentials in GPP, which could lead to unauthorized access. If confirmed malicious, this could
author: Mauricio Velazco, Splunk
logsource:
  product: windows
detection:
  selection:
    _spl_reference: true
  condition: selection
tags:
  - attack.t1552.006
references:
  - https://attack.mitre.org/techniques/T1552/006/
  - https://pentestlab.blog/2017/03/20/group-policy-preferences/
  - https://adsecurity.org/?p=2288
  - https://www.hackingarticles.in/credential-dumping-group-policy-preferences-gpp/
  - https://support.microsoft.com/en-us/topic/ms14-025-vulnerability-in-group-policy-preferences-could-allow-elevation-of-privilege-may-13-2014-60734e15-af79-26ca-ea53-8cd617073c30
custom_attributes:
  original_rule_id: 1631ac2d-f2a9-42fa-8a59-d6e210d472f5
  source_format: splunk_spl