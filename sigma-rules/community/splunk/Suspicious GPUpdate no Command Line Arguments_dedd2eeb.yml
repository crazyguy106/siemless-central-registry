title: Suspicious GPUpdate no Command Line Arguments
id: 6b7fe171-7eba-5a08-a1e4-9ea17ffaf31f
status: stable
level: high
description: |
  The following analytic detects the execution of gpupdate.exe without any command line arguments. This behavior is identified using data from Endpoint Detection and Response (EDR) agents, focusing on process execution logs. It is significant because gpupdate.exe typically runs with specific arguments, and its execution without them is often associated with malicious activities, such as those performed by Cobalt Strike. If confirmed malicious, this activity could indicate an attempt to execute una
author: Michael Haag, Splunk
logsource:
  product: splunk
  category: process_creation
detection:
  selection:
    process:
      - '*gpupdate'
      - '*gpupdate.exe'
      - '*gpupdate.exe\'
  condition: selection
tags:
  - attack.t1055
references:
  - https://raw.githubusercontent.com/xx0hcd/Malleable-C2-Profiles/0ef8cf4556e26f6d4190c56ba697c2159faa5822/crimeware/trick_ryuk.profile
  - https://www.cobaltstrike.com/blog/learn-pipe-fitting-for-all-of-your-offense-projects/
custom_attributes:
  original_rule_id: f308490a-473a-40ef-ae64-dd7a6eba284a
  source_format: splunk_spl