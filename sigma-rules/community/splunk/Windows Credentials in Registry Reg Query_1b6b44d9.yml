title: Windows Credentials in Registry Reg Query
id: 6b211c06-d45d-5dc3-a0df-fc8036d56b1f
status: stable
level: medium
description: |
  The following analytic identifies processes querying the registry for potential passwords or credentials. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on command-line executions that access specific registry paths known to store sensitive information. This activity is significant as it may indicate credential theft attempts, often used by adversaries or post-exploitation tools like winPEAS. If confirmed malicious, this behavior could lead to privilege escalation,
author: Teoderick Contreras, Splunk
logsource:
  product: windows
  category: authentication
detection:
  selection:
    process:
      - '*\\Software\\ORL\\WinVNC3\\Password*'
      - '*\\SOFTWARE\\RealVNC\\WinVNC4 /v password*'
      - '*\\CurrentControlSet\\Services\\SNMP*'
      - '*\\Software\\TightVNC\\Server*'
      - '*\\Software\\SimonTatham\\PuTTY\\Sessions*'
      - '*\\Software\\OpenSSH\\Agent\\Keys*'
      - '*password*'
  condition: selection
tags:
  - attack.t1552.002
references:
  - https://attack.mitre.org/techniques/T1552/002/
  - https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS
  - https://www.microsoft.com/en-us/security/blog/2022/10/14/new-prestige-ransomware-impacts-organizations-in-ukraine-and-poland/
custom_attributes:
  original_rule_id: a8b3124e-2278-4b73-ae9c-585117079fb2
  source_format: splunk_spl