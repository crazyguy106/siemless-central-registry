title: GetDomainComputer with PowerShell Script Block
id: 95fd1ca7-6704-59ee-849a-e46609b079fd
status: stable
level: high
description: |
  The following analytic detects the execution of the `Get-DomainComputer` commandlet using PowerShell Script Block Logging (EventCode=4104). This commandlet is part of PowerView, a tool often used for enumerating domain computers within Windows environments. The detection leverages script block text analysis to identify this specific command. Monitoring this activity is crucial as it can indicate an adversary's attempt to gather information about domain computers, which is a common step in Active
author: Mauricio Velazco, Splunk
logsource:
  product: windows
detection:
  selection:
    scriptblocktext: '*Get-DomainComputer*'
    eventcode: 4104
  condition: selection
tags:
  - attack.t1018
references:
  - https://attack.mitre.org/techniques/T1018/
  - https://powersploit.readthedocs.io/en/latest/Recon/Get-DomainComputer/
custom_attributes:
  original_rule_id: f64da023-b988-4775-8d57-38e512beb56e
  source_format: splunk_spl