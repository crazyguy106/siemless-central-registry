title: Windows Server Software Component GACUtil Install to GAC
id: 5fb4eb19-8c3b-5713-baf9-2b7d64ebcaa9
status: stable
level: high
description: |
  The following analytic detects the use of GACUtil.exe to add a DLL into the Global Assembly Cache (GAC). It leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names and command-line executions. This activity is significant because adding a DLL to the GAC allows it to be called by any application, potentially enabling widespread code execution. If confirmed malicious, this could allow an attacker to execute arbitrary code across the operating system, leading to 
author: Michael Haag, Splunk
logsource:
  product: windows
detection:
  selection:
    process:
      - '*-i *'
      - '*/i *'
  condition: selection
tags:
  - attack.t1505.004
references:
  - https://strontic.github.io/xcyclopedia/library/gacutil.exe-F2FE4DF74BD214EDDC1A658043828089.html
  - https://www.microsoft.com/en-us/security/blog/2022/12/12/iis-modules-the-evolution-of-web-shells-and-how-to-detect-them/
  - https://www.microsoft.com/en-us/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/
  - https://learn.microsoft.com/en-us/dotnet/framework/app-domains/gac
custom_attributes:
  original_rule_id: 7c025ef0-9e65-4c57-be39-1c13dbb1613e
  source_format: splunk_spl