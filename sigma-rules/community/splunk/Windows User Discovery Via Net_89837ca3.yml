title: Windows User Discovery Via Net
id: e96d7560-4559-5219-9a47-cadb86798164
status: stable
level: low
description: |
  The following analytic detects the execution of `net.exe` or `net1.exe` with command-line arguments `user` or `users` to query local user accounts. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names and command-line executions. This activity is significant as it indicates potential reconnaissance efforts by adversaries to enumerate local users, which is a common step in situational awareness and Active Directory discovery. If confirmed malicious, this 
author: Mauricio Velazco, Teoderick Contreras, Nasreddine Bencherchali, Splunk
logsource:
  product: windows
detection:
  selection:
    process:
      - '*user'
      - '*users'
      - '*users *'
      - '*user *'
      - '*/add'
      - '*/delete'
  condition: selection
tags:
  - attack.t1087.001
references:
  - https://attack.mitre.org/techniques/T1087/001/
custom_attributes:
  original_rule_id: 7742987e-88c1-476b-a626-a869e088ab72
  source_format: splunk_spl