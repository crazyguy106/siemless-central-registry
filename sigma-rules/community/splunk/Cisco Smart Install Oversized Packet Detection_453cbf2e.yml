title: Cisco Smart Install Oversized Packet Detection
id: 77fd5d99-b8b7-5513-bb38-afffa44d068e
status: stable
level: high
description: |
  This analytic detects oversized Cisco Smart Install (SMI) protocol messages by inspecting traffic to TCP port 4786 within the Network_Traffic data model. Abnormally large SMI payloads have been associated with exploitation and protocol abuse (e.g., CVE-2018-0171; activity reported by the "Static Tundra" threat actor). Monitoring message sizes over time can help identify possible attempts at remote code execution, denial of service, or reconnaissance against Cisco devices exposing Smart Install.
author: Bhavin Patel, Michael Haag, Splunk
logsource:
  product: splunk
detection:
  selection:
    datamodel: Network_Traffic
    dest_port: 4786
    transport: tcp
    span: 1h
  condition: selection
tags:
  - attack.t1190
references:
  - https://blog.talosintelligence.com/static-tundra/
  - https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180328-smi2
custom_attributes:
  original_rule_id: 3b8d2b4f-4e1e-4a9e-9b43-8a7a3a9c7e21
  source_format: splunk_spl