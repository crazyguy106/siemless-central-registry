title: Windows PowerShell Export PfxCertificate
id: e58012b5-be41-5ead-a398-16295b9d32a4
status: stable
level: medium
description: |
  The following analytic detects the use of the PowerShell cmdlet `export-pfxcertificate` by leveraging Script Block Logging. This activity is significant as it may indicate an adversary attempting to exfiltrate certificates from the Windows Certificate Store. Monitoring this behavior is crucial for identifying potential certificate theft, which can lead to unauthorized access and impersonation attacks. If confirmed malicious, this activity could allow attackers to compromise secure communications
author: Michael Haag, Splunk
logsource:
  product: windows
detection:
  selection:
    eventcode: 4104
    scriptblocktext:
      - '*export-pfxcertificate*'
  condition: selection
tags:
  - attack.t1552.004
  - attack.t1649
references:
  - https://dev.to/iamthecarisma/managing-windows-pfx-certificates-through-powershell-3pj
  - https://learn.microsoft.com/en-us/powershell/module/pki/export-pfxcertificate?view=windowsserver2022-ps
custom_attributes:
  original_rule_id: ed06725f-6da6-439f-9dcc-ab30e891297c
  source_format: splunk_spl