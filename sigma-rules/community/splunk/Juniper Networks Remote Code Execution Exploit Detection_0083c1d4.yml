title: Juniper Networks Remote Code Execution Exploit Detection
id: 5c017750-7b9c-5309-8ab7-7e0997a87771
status: stable
level: high
description: |
  The following analytic detects attempts to exploit a remote code execution vulnerability in Juniper Networks devices. It identifies requests to /webauth_operation.php?PHPRC=*, which are indicative of uploading and executing malicious PHP files. This detection leverages the Web data model, focusing on specific URL patterns and HTTP status codes. This activity is significant because it signals an attempt to gain unauthorized access and execute arbitrary code on the device. If confirmed malicious, 
author: Michael Haag, Splunk
logsource:
  product: splunk
  category: process_creation
detection:
  selection:
    datamodel: Web
    status: 200
    url:
      - '*/webauth_operation.php?PHPRC=*'
  condition: selection
tags:
  - attack.t1190
  - attack.t1105
  - attack.t1059
references:
  - https://supportportal.juniper.net/s/article/2023-08-Out-of-Cycle-Security-Bulletin-Junos-OS-SRX-Series-and-EX-Series-Multiple-vulnerabilities-in-J-Web-can-be-combined-to-allow-a-preAuth-Remote-Code-Execution?language=en_US
  - https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2023/CVE-2023-36844.yaml
  - https://thehackernews.com/2023/08/new-juniper-junos-os-flaws-expose.html
  - https://github.com/watchtowrlabs/juniper-rce_cve-2023-36844
  - https://labs.watchtowr.com/cve-2023-36844-and-friends-rce-in-juniper-firewalls/
custom_attributes:
  original_rule_id: 6cc4cc3d-b10a-4fac-be1e-55d384fc690e
  source_format: splunk_spl