title: CSC Net On The Fly Compilation
id: 2ee2b9f6-5201-5dce-b345-4f2af7e2c9c6
status: stable
level: low
description: |
  The following analytic detects the use of the .NET compiler csc.exe for on-the-fly compilation of potentially malicious .NET code. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on specific command-line patterns associated with csc.exe. This activity is significant because adversaries and malware often use this technique to evade detection by compiling malicious code at runtime. If confirmed malicious, this could allow attackers to execute arbitrary code, potential
author: Teoderick Contreras, Splunk
logsource:
  product: splunk
detection:
  selection:
    process:
      - '*/noconfig*'
      - '*/fullpaths*'
      - '*@*'
  condition: selection
tags:
  - attack.t1027.004
references:
  - https://app.any.run/tasks/ad4c3cda-41f2-4401-8dba-56cc2d245488/
  - https://tccontre.blogspot.com/2019/06/maicious-macro-that-compile-c-code-as.html
custom_attributes:
  original_rule_id: ea73128a-43ab-11ec-9753-acde48001122
  source_format: splunk_spl