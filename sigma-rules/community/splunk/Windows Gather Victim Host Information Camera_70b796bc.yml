title: Windows Gather Victim Host Information Camera
id: 3a57a75d-1dff-5f97-aa86-3d5c42ee7484
status: stable
level: medium
description: |
  The following analytic detects a PowerShell script that enumerates camera devices on the targeted host. This detection leverages PowerShell Script Block Logging, specifically looking for commands querying Win32_PnPEntity for camera-related information. This activity is significant as it is commonly observed in DCRat malware, which collects camera data to send to its command-and-control server. If confirmed malicious, this behavior could indicate an attempt to gather sensitive visual information 
author: Teoderick Contreras, Splunk
logsource:
  product: windows
detection:
  selection:
    scriptblocktext:
      - '*Image*'
      - '*Camera*'
    eventcode: 4104
  condition: selection
tags:
  - attack.t1592.001
references:
  - https://cert.gov.ua/article/405538
  - https://malpedia.caad.fkie.fraunhofer.de/details/win.dcrat
  - https://www.mandiant.com/resources/analyzing-dark-crystal-rat-backdoor
custom_attributes:
  original_rule_id: e4df4676-ea41-4397-b160-3ee0140dc332
  source_format: splunk_spl