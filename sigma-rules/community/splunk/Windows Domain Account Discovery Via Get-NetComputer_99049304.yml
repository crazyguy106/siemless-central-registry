title: Windows Domain Account Discovery Via Get-NetComputer
id: 4168ba16-cf8b-543f-9b34-759afc2204d1
status: stable
level: medium
description: |
  The following analytic detects the execution of the PowerView PowerShell cmdlet Get-NetComputer, which is used to query Active Directory for user account details such as "samaccountname," "accountexpires," "lastlogon," and more. It leverages Event ID 4104 from PowerShell Script Block Logging to identify this activity. This behavior is significant as it may indicate an attempt to gather user account information, which is often a precursor to further malicious actions. If confirmed malicious, this
author: Teoderick Contreras, Splunk
logsource:
  product: windows
detection:
  selection:
    scriptblocktext:
      - '*samaccountname*'
      - '*accountexpires*'
      - '*lastlogon*'
      - '*lastlogoff*'
      - '*pwdlastset*'
      - '*logoncount*'
    eventcode: 4104
  condition: selection
tags:
  - attack.t1087.002
references:
  - https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a
custom_attributes:
  original_rule_id: a7fbbc4e-4571-424a-b627-6968e1c939e4
  source_format: splunk_spl