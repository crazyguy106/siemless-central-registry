title: Process Kill Base On File Path
id: f240a9cb-b333-5b71-8d6e-b6bcac1dffb2
status: stable
level: high
description: |
  The following analytic detects the use of `wmic.exe` with the `delete` command to remove an executable path. This detection leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names, parent processes, and command-line executions. This activity is significant because it often indicates the initial stages of an adversary setting up malicious activities, such as cryptocurrency mining, on an endpoint. If confirmed malicious, this behavior could allow an attacker to 
author: Teoderick Contreras, Splunk
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    process:
      - '*process*'
      - '*executablepath*'
      - '*delete*'
  condition: selection
tags:
  - attack.t1562.001
references:
  - https://thedfirreport.com/2020/04/20/sqlserver-or-the-miner-in-the-basement/
custom_attributes:
  original_rule_id: 5ffaa42c-acdb-11eb-9ad3-acde48001122
  source_format: splunk_spl