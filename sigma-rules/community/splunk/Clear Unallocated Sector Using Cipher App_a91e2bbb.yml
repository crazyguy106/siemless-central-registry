title: Clear Unallocated Sector Using Cipher App
id: 21608649-3497-54fe-b622-5595473b7bdd
status: stable
level: high
description: |
  The following analytic detects the execution of `cipher.exe` with the `/w` flag to clear unallocated sectors on a disk. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names, command-line arguments, and parent processes. This activity is significant because it is a technique used by ransomware to prevent forensic recovery of deleted files. If confirmed malicious, this action could hinder incident response efforts by making it impossible to recover critica
author: Teoderick Contreras, Splunk
logsource:
  product: splunk
detection:
  selection:
    process_name: cipher.exe
    process: '*/w:*'
  condition: selection
tags:
  - attack.t1070.004
references:
  - https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/3/
  - https://www.sophos.com/en-us/medialibrary/PDFs/technical-papers/sophoslabs-ransomware-behavior-report.pdf
custom_attributes:
  original_rule_id: cd80a6ac-c9d9-11eb-8839-acde48001122
  source_format: splunk_spl