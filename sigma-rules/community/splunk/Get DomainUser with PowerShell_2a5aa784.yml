title: Get DomainUser with PowerShell
id: 729d9691-32c4-593f-84f6-549fc809c0fd
status: stable
level: high
description: |
  The following analytic detects the execution of `powershell.exe` with command-line arguments used to enumerate domain users via the `Get-DomainUser` command. This detection leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names and command-line executions mapped to the `Processes` node of the `Endpoint` data model. This activity is significant as it indicates potential reconnaissance efforts by adversaries or Red Teams using PowerView for Active Directory dis
author: Teoderick Contreras, Mauricio Velazco, Splunk
logsource:
  product: windows
detection:
  selection:
    process_name:
      - cmd.exe
      - powershell*
    process: '*Get-DomainUser*'
  condition: selection
tags:
  - attack.t1087.002
references:
  - https://powersploit.readthedocs.io/en/latest/Recon/Get-DomainUser/
custom_attributes:
  original_rule_id: 9a5a41d6-04e7-11ec-923c-acde48001122
  source_format: splunk_spl