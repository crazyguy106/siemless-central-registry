title: Windows Cabinet File Extraction Via Expand
id: b3af8f85-40e4-5814-a7c2-6451826f1253
status: stable
level: high
description: |
  Detects usage of expand.exe to extract Microsoft Cabinet (CAB) archives, with emphasis on extractions into `C:\\ProgramData` or similar staging locations. In recent APT37 activity, a CAB payload (e.g., wonder.cab) was expanded into ProgramData prior to persistence and execution. This behavior is a strong signal for ingress tool transfer and staging of payloads.
author: Michael Haag, Splunk
logsource:
  product: windows
  category: file_event
detection:
  selection:
    process_name: expand.exe
    process:
      - '*-F:*'
      - '*/F:*'
      - '*\\ProgramData\\*'
  condition: selection
tags:
  - attack.t1105
references:
  - https://www.zscaler.com/blogs/security-research/apt37-targets-windows-rust-backdoor-and-python-loader
custom_attributes:
  original_rule_id: 4e3e3b8c-6d3a-4b47-9f5a-9e3e0a0a6f2f
  source_format: splunk_spl