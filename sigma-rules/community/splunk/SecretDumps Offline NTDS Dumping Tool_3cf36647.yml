title: SecretDumps Offline NTDS Dumping Tool
id: 253fcd7f-7812-5ec9-b9f9-871ff2cf6f63
status: stable
level: high
description: |
  The following analytic detects the potential use of the secretsdump.py tool to dump NTLM hashes from a copy of ntds.dit and the SAM, SYSTEM, and SECURITY registry hives. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on specific command-line patterns and process names associated with secretsdump.py. This activity is significant because it indicates an attempt to extract sensitive credential information offline, which is a common post-exploitation technique. If conf
author: Teoderick Contreras, Splunk
logsource:
  product: windows
detection:
  selection:
    process_name: python*.exe
    process:
      - '*.py*'
      - '*-ntds*'
      - '*-system*'
      - '*-sam*'
      - '*-security*'
      - '*-bootkey*'
  condition: selection
tags:
  - attack.t1003.003
references:
  - https://github.com/SecureAuthCorp/impacket/blob/master/examples/secretsdump.py
custom_attributes:
  original_rule_id: 5672819c-be09-11eb-bbfb-acde48001122
  source_format: splunk_spl