title: Exploit Public-Facing Fortinet FortiNAC CVE-2022-39952
id: d672b329-7d03-579f-87d7-38b359880736
status: stable
level: high
description: |
  The following analytic detects attempts to exploit the Fortinet FortiNAC CVE-2022-39952 vulnerability. It identifies HTTP POST requests to the URI configWizard/keyUpload.jsp with a payload.zip file. The detection leverages the Web datamodel, analyzing fields such as URL, HTTP method, and user agent. This activity is significant as it indicates an attempt to exploit a known vulnerability, potentially leading to remote code execution. If confirmed malicious, attackers could gain control over the a
author: Michael Haag, Splunk
logsource:
  product: splunk
detection:
  selection:
    datamodel: Web
    url:
      - '*configWizard/keyUpload.jsp*'
  condition: selection
tags:
  - attack.t1190
  - attack.t1133
references:
  - https://github.com/horizon3ai/CVE-2022-39952
  - https://www.horizon3.ai/fortinet-fortinac-cve-2022-39952-deep-dive-and-iocs/
  - https://viz.greynoise.io/tag/fortinac-rce-attempt?days=30
custom_attributes:
  original_rule_id: 2038f5c6-5aba-4221-8ae2-ca76e2ca8b97
  source_format: splunk_spl