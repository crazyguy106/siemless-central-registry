title: Get ADUser with PowerShell
id: d927bf80-2bf3-5488-9959-8b081abee1c3
status: stable
level: low
description: |
  The following analytic detects the execution of `powershell.exe` with command-line arguments used to enumerate domain users via the `Get-ADUser` cmdlet. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names and command-line executions. This activity is significant as it may indicate an attempt by adversaries to gather information about domain users for situational awareness and Active Directory discovery. If confirmed malicious, this behavior could lead t
author: Teoderick Contreras, Mauricio Velazco, Splunk
logsource:
  product: windows
detection:
  selection:
    process_name:
      - cmd.exe
      - powershell*
    process:
      - '*Get-ADUser*'
      - '*-filter*'
  condition: selection
tags:
  - attack.t1087.002
references:
  - https://www.blackhillsinfosec.com/red-blue-purple/
  - https://attack.mitre.org/techniques/T1087/002/
  - https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-aduser?view=windowsserver2019-ps
custom_attributes:
  original_rule_id: 0b6ee3f4-04e3-11ec-a87d-acde48001122
  source_format: splunk_spl