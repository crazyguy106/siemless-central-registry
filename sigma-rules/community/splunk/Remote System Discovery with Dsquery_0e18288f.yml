title: Remote System Discovery with Dsquery
id: 39c33a2f-ad1d-5419-991c-84eb0454b4ad
status: stable
level: medium
description: |
  The following analytic detects the execution of `dsquery.exe` with the `computer` argument, which is used to discover remote systems within a domain. This detection leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names and command-line arguments. Remote system discovery is significant as it indicates potential reconnaissance activities by adversaries or Red Teams to map out network resources and Active Directory structures. If confirmed malicious, this activ
author: Mauricio Velazco, Splunk
logsource:
  product: splunk
detection:
  selection:
    process_name: dsquery.exe
    process: '*computer*'
  condition: selection
tags:
  - attack.t1018
references:
  - https://attack.mitre.org/techniques/T1018/
  - https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc732952(v=ws.11)
custom_attributes:
  original_rule_id: 9fb562f4-42f8-4139-8e11-a82edf7ed718
  source_format: splunk_spl