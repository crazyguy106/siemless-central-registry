title: Windows Snake Malware Kernel Driver Comadmin
id: aa6ef5a7-585b-5e96-be61-5d5d11b27fda
status: stable
level: high
description: |
  The following analytic detects the creation of the comadmin.dat file in the %windows%\system32\Com directory, which is associated with Snake Malware. This detection leverages the Endpoint.Filesystem data model to identify file creation events matching the specified path and filename. This activity is significant because the comadmin.dat file is part of Snake Malware's installation process, which includes dropping a kernel driver and a custom DLL. If confirmed malicious, this activity could allow
author: Michael Haag, Splunk
logsource:
  product: windows
detection:
  selection:
    file_path: '*\\windows\\system32\\com\\*'
    file_name: comadmin.dat
  condition: selection
tags:
  - attack.t1547.006
references:
  - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
custom_attributes:
  original_rule_id: 628d9c7c-3242-43b5-9620-7234c080a726
  source_format: splunk_spl