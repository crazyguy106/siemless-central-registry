title: Windows IIS Components Get-WebGlobalModule Module Query
id: 1d4de16c-6e06-5e7a-a593-888be3c74382
status: stable
level: low
description: |
  The following analytic identifies the execution of the PowerShell cmdlet Get-WebGlobalModule, which lists all IIS Modules installed on a system. It leverages PowerShell input data to detect this activity by capturing the module names and the image paths of the DLLs. This activity is significant for a SOC because it can indicate an attempt to enumerate installed IIS modules, which could be a precursor to exploiting vulnerabilities or misconfigurations. If confirmed malicious, this could allow an 
author: Michael Haag, Splunk
logsource:
  product: windows
detection:
  selection:
    _spl_reference: true
  condition: selection
tags:
  - attack.t1505.004
references:
  - https://help.splunk.com/en/splunk-cloud-platform/get-started/get-data-in/9.3.2411/get-windows-data/monitor-windows-data-with-powershell-scripts
  - https://gist.github.com/MHaggis/64396dfd9fc3734e1d1901a8f2f07040
  - https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1505.004
custom_attributes:
  original_rule_id: 20db5f70-34b4-4e83-8926-fa26119de173
  source_format: splunk_spl