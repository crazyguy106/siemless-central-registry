title: Detect SharpHound File Modifications
id: a4b0a9c8-6d26-5992-8c5f-e15b3e45d550
status: stable
level: high
description: |
  The following analytic detects the creation of files typically associated with SharpHound, a reconnaissance tool used for gathering domain and trust data. It leverages file modification events from the Endpoint.Filesystem data model, focusing on default file naming patterns like `*_BloodHound.zip` and various JSON files. This activity is significant as it indicates potential domain enumeration, which is a precursor to more targeted attacks. If confirmed malicious, an attacker could gain detailed
author: Michael Haag, Splunk
logsource:
  product: splunk
  category: file_event
detection:
  selection:
    file_name:
      - '*bloodhound.zip'
      - '*_computers.json'
      - '*_gpos.json'
      - '*_domains.json'
      - '*_users.json'
      - '*_groups.json'
      - '*_ous.json'
      - '*_containers.json'
  condition: selection
tags:
  - attack.t1069.001
  - attack.t1069.002
  - attack.t1087.001
  - attack.t1087.002
  - attack.t1482
references:
  - https://attack.mitre.org/software/S0521/
  - https://thedfirreport.com/?s=bloodhound
  - https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors
  - https://github.com/BloodHoundAD/SharpHound3
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.001/T1059.001.md#atomic-test-2---run-bloodhound-from-local-disk
custom_attributes:
  original_rule_id: 42b4b438-beed-11eb-ba1d-acde48001122
  source_format: splunk_spl