title: Windows AD Privileged Object Access Activity
id: 06580424-1c0c-54cc-86ca-4ecd6f63bde1
status: stable
level: high
description: |
  The following analytic detects access attempts to privileged Active Directory objects, such as Domain Admins or Enterprise Admins. It leverages Windows Security Event Code 4662 to identify when these sensitive objects are accessed. This activity is significant because such objects should rarely be accessed by normal users or processes, and unauthorized access attempts may indicate attacker enumeration or lateral movement within the domain. If confirmed malicious, this activity could allow attack
author: Steven Dick
logsource:
  product: windows
detection:
  selection:
    eventcode: 4662
    cn:
      - Account
      - Backup
      - Cert
      - Certificate
      - Domain
      - Domain
      - Enterprise
      - Enterprise
      - Group
      - Incoming
      - Microsoft
      - Network
      - Power
      - Print
      - Schema
      - Server
      - Exchange
      - Exchange
      - Organization
    field: ObjectName
    objectname:
      - CN=Account Operators
      - '*'
      - CN=Administrators
      - '*'
      - CN=Backup Operators
      - '*'
      - CN=Cert Publishers
      - '*'
      - CN=Certificate Service DCOM Access
      - '*'
      - CN=Domain Admins
      - '*'
      - CN=Domain Controllers
      - '*'
      - CN=Enterprise Admins
      - '*'
      - CN=Enterprise Read-only Domain Controllers
      - '*'
      - CN=Group Policy Creator Owners
      - '*'
      - CN=Incoming Forest Trust Builders
      - '*'
      - CN=Microsoft Exchange Servers
      - '*'
      - CN=Network Configuration Operators
      - '*'
      - CN=Power Users
      - '*'
      - CN=Print Operators
      - '*'
      - CN=Read-only Domain Controllers
      - '*'
      - CN=Replicators
      - '*'
      - CN=Schema Admins
      - '*'
      - CN=Server Operators
      - '*'
      - CN=Exchange Trusted Subsystem
      - '*'
      - CN=Exchange Windows Permission
      - '*'
      - CN=Organization Management
      - '*'
  condition: selection
tags:
  - attack.t1087.002
references:
  - https://medium.com/securonix-tech-blog/detecting-ldap-enumeration-and-bloodhound-s-sharphound-collector-using-active-directory-decoys-dfc840f2f644
  - https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4662
  - https://attack.mitre.org/tactics/TA0007/
custom_attributes:
  original_rule_id: dc2f58bc-8cd2-4e51-962a-694b963acde0
  source_format: splunk_spl