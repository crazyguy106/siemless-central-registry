title: Windows InstallUtil URL in Command Line
id: 51531d3c-dce1-538c-810b-9f13e9ea2169
status: stable
level: high
description: |
  The following analytic detects the use of Windows InstallUtil.exe with an HTTP or HTTPS URL in the command line. This is identified through Endpoint Detection and Response (EDR) telemetry, focusing on command-line executions containing URLs. This activity is significant as it may indicate an attempt to download and execute malicious code, potentially bypassing application control mechanisms. If confirmed malicious, this could lead to unauthorized code execution, privilege escalation, or persiste
author: Michael Haag, Splunk
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    process:
      - '*http://*'
      - '*https://*'
  condition: selection
tags:
  - attack.t1218.004
references:
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.004/T1218.004.md
  - https://gist.github.com/DanielRTeixeira/0fd06ec8f041f34a32bf5623c6dd479d
custom_attributes:
  original_rule_id: 28e06670-43df-11ec-a569-acde48001122
  source_format: splunk_spl