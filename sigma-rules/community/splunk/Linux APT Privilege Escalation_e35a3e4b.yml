title: Linux APT Privilege Escalation
id: 97de31a1-13c8-5bc0-993e-bf1afd594833
status: stable
level: medium
description: |
  The following analytic detects the use of the Advanced Package Tool (APT) with elevated privileges via sudo on Linux systems. It leverages Endpoint Detection and Response (EDR) telemetry to identify processes where APT commands are executed with sudo rights. This activity is significant because it indicates a user can run system commands as root, potentially leading to unauthorized root shell access. If confirmed malicious, this could allow an attacker to escalate privileges, execute arbitrary c
author: Gowthamaraj Rajendran, Splunk
logsource:
  product: linux
detection:
  selection:
    process:
      - '*apt*'
      - '*APT::Update::Pre-Invoke::*'
      - '*sudo*'
  condition: selection
tags:
  - attack.t1548.003
references:
  - https://gtfobins.github.io/gtfobins/apt/
  - https://www.digitalocean.com/community/tutorials/what-is-apt
custom_attributes:
  original_rule_id: 4d5a05fa-77d9-4fd0-af9c-05704f9f9a88
  source_format: splunk_spl