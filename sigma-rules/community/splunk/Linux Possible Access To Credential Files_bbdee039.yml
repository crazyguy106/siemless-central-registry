title: Linux Possible Access To Credential Files
id: 0a2491fd-38b1-51c0-bd26-7771b0676f7e
status: stable
level: medium
description: |
  The following analytic detects attempts to access or dump the contents of /etc/passwd and /etc/shadow files on Linux systems. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on processes like 'cat', 'nano', 'vim', and 'vi' accessing these files. This activity is significant as it may indicate credential dumping, a technique used by adversaries to gain persistence or escalate privileges. If confirmed malicious, attackers could obtain hashed passwords for offline crac
author: Teoderick Contreras, Splunk
logsource:
  product: linux
  category: file_event
detection:
  selection:
    process_name:
      - cat
      - nano*
      - vim*
      - vi*
    process:
      - '*/etc/shadow*'
      - '*/etc/passwd*'
  condition: selection
tags:
  - attack.t1003.008
references:
  - https://askubuntu.com/questions/445361/what-is-difference-between-etc-shadow-and-etc-passwd
  - https://attack.mitre.org/techniques/T1003/008/
custom_attributes:
  original_rule_id: 16107e0e-71fc-11ec-b862-acde48001122
  source_format: splunk_spl