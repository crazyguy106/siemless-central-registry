title: Remote Process Instantiation via WMI
id: afe998d8-1805-540e-99ee-803180c500d5
status: stable
level: high
description: |
  The following analytic detects the execution of wmic.exe with parameters to spawn a process on a remote system. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on command-line executions and process telemetry mapped to the `Processes` node of the `Endpoint` data model. This activity is significant as WMI can be abused for lateral movement and remote code execution, often used by adversaries and Red Teams. If confirmed malicious, this could allow attackers to execute
author: Mauricio Velazco, Splunk
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    process:
      - '*/node:*'
      - '*process*'
      - '*call*'
      - '*create*'
  condition: selection
tags:
  - attack.t1047
references:
  - https://attack.mitre.org/techniques/T1047/
  - https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/create-method-in-class-win32-process
custom_attributes:
  original_rule_id: d25d2c3d-d9d8-40ec-8fdf-e86fe155a3da
  source_format: splunk_spl