title: Windows Explorer LNK Exploit Process Launch With Padding
id: 06b5b8fa-c5a2-59b1-9b2b-4cdec0c8673d
status: stable
level: high
description: |
  This detection identifies instances where Windows Explorer.exe spawns PowerShell or cmd.exe processes with abnormally large padding (50 or more spaces) in the command line. This specific pattern is a key indicator of the ZDI-CAN-25373 Windows shortcut zero-day vulnerability exploitation, where threat actors craft malicious LNK files containing padded content to trigger code execution. The excessive spacing in the command line is used to manipulate the way Windows processes the shortcut file, ena
author: Michael Haag, AJ King, Splunk, Jesse Hunter, Splunk Community Contributor
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    parent_process_path: '*\\explorer.exe'
    process_path:
      - '*\\cmd.exe'
      - '*\\powershell.exe'
    process: .*?\s{50,}.*
  condition: selection
tags:
  - attack.t1059.001
  - attack.t1204.002
references:
  - https://www.trendmicro.com/en_us/research/25/c/windows-shortcut-zero-day-exploit.html
custom_attributes:
  original_rule_id: 8775fcf3-05e4-4525-bba2-a56e39d8d050
  source_format: splunk_spl