title: Rundll32 Shimcache Flush
id: 4fb03370-dfd6-5379-973e-4feb90d6de2c
status: stable
level: high
description: |
  The following analytic detects the execution of a suspicious rundll32 command line used to clear the shim cache. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on process execution logs and command-line arguments. This activity is significant because clearing the shim cache is an anti-forensic technique aimed at evading detection and removing forensic artifacts. If confirmed malicious, this action could hinder incident response efforts, allowing an attacker to cove
author: Teoderick Contreras, Splunk
logsource:
  product: splunk
detection:
  selection:
    process: '*apphelp.dll,ShimFlushCache*'
  condition: selection
tags:
  - attack.t1112
references:
  - https://blueteamops.medium.com/shimcache-flush-89daff28d15e
custom_attributes:
  original_rule_id: a913718a-25b6-11ec-96d3-acde48001122
  source_format: splunk_spl