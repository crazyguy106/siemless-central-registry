title: GetDomainController with PowerShell Script Block
id: 31ce5619-63e5-543b-b4ab-b11ac4f91d0c
status: stable
level: high
description: |
  The following analytic detects the execution of the `Get-DomainController` commandlet using PowerShell Script Block Logging (EventCode=4104). This commandlet is part of PowerView, a tool often used for domain enumeration. The detection leverages script block text to identify this specific activity. Monitoring this behavior is crucial as it may indicate an adversary or Red Team performing reconnaissance to map out domain controllers. If confirmed malicious, this activity could lead to further dom
author: Mauricio Velazco, Splunk
logsource:
  product: windows
detection:
  selection:
    scriptblocktext: '*Get-DomainController*'
    eventcode: 4104
  condition: selection
tags:
  - attack.t1018
references:
  - https://attack.mitre.org/techniques/T1018/
  - https://powersploit.readthedocs.io/en/latest/Recon/Get-DomainController/
custom_attributes:
  original_rule_id: 676b600a-a94d-4951-b346-11329431e6c1
  source_format: splunk_spl