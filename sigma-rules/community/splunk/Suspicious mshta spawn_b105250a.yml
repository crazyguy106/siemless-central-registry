title: Suspicious mshta spawn
id: 62e377bf-e06b-5e79-a6a3-ac52eaf54abc
status: stable
level: high
description: |
  The following analytic detects the spawning of mshta.exe by wmiprvse.exe or svchost.exe. This behavior is identified using Endpoint Detection and Response (EDR) data, focusing on process creation events where the parent process is either wmiprvse.exe or svchost.exe. This activity is significant as it may indicate the use of a DCOM object to execute malicious scripts via mshta.exe, a common tactic in sophisticated attacks. If confirmed malicious, this could allow an attacker to execute arbitrary 
author: Michael Haag, Splunk
logsource:
  product: windows
detection:
  selection:
    _spl_reference: true
  condition: selection
tags:
  - attack.t1218.005
references:
  - https://codewhitesec.blogspot.com/2018/07/lethalhta.html
  - https://github.com/redcanaryco/AtomicTestHarnesses
  - https://redcanary.com/blog/introducing-atomictestharnesses/
custom_attributes:
  original_rule_id: 4d33a488-5b5f-11eb-ae93-0242ac130002
  source_format: splunk_spl