title: JetBrains TeamCity Authentication Bypass CVE-2024-27198
id: bcad9062-76f3-59f5-8159-caf60de4700a
status: stable
level: high
description: |
  The following analytic identifies attempts to exploit the JetBrains TeamCity Authentication Bypass vulnerability (CVE-2024-27198). It detects suspicious POST requests to the `/app/rest/users` and `/app/rest/users/id:1/tokens` endpoints, which are indicative of attempts to create new administrator users or generate admin access tokens without authentication. This detection leverages the Web datamodel and CIM-compliant log sources, such as Nginx or TeamCity logs. This activity is significant as it
author: Michael Haag, Splunk
logsource:
  product: splunk
  category: authentication
detection:
  selection:
    url:
      - '*jsp=/app/rest/users;.jsp'
      - '*?jsp=/app/rest/users;.jsp'
      - '*?jsp=.*/app/rest/users/id:*/tokens;*'
    datamodel: Web
    status:
      - 200
      - 200
    http_method: POST
  condition: selection
tags:
  - attack.t1190
references:
  - https://github.com/projectdiscovery/nuclei-templates/pull/9279/files
  - https://www.rapid7.com/blog/post/2024/03/04/etr-cve-2024-27198-and-cve-2024-27199-jetbrains-teamcity-multiple-authentication-bypass-vulnerabilities-fixed/
  - https://blog.jetbrains.com/teamcity/2024/03/teamcity-2023-11-4-is-out/
  - https://blog.jetbrains.com/teamcity/2024/03/additional-critical-security-issues-affecting-teamcity-on-premises-cve-2024-27198-and-cve-2024-27199-update-to-2023-11-4-now/
  - https://github.com/yoryio/CVE-2024-27198/blob/main/CVE-2024-27198.py
custom_attributes:
  original_rule_id: fbcc04c7-8a79-453c-b3a9-c232c423bdd4
  source_format: splunk_spl