title: Windows Impair Defense Add Xml Applocker Rules
id: 8d01cefa-a011-5506-9c0a-9f41a1a378f8
status: stable
level: low
description: |
  The following analytic detects the use of a PowerShell commandlet to import an AppLocker XML policy. This behavior is identified by monitoring processes that execute the "Import-Module Applocker" and "Set-AppLockerPolicy" commands with the "-XMLPolicy" parameter. This activity is significant because it can indicate an attempt to disable or bypass security controls, as seen in the Azorult malware. If confirmed malicious, this could allow an attacker to disable antivirus products, leading to furth
author: Teoderick Contreras, Splunk
logsource:
  product: windows
detection:
  selection:
    process:
      - '*Import-Module Applocker*'
      - '*Set-AppLockerPolicy *'
      - '* -XMLPolicy *'
  condition: selection
tags:
  - attack.t1562.001
references:
  - https://app.any.run/tasks/a6f2ffe2-e6e2-4396-ae2e-04ea0143f2d8/
custom_attributes:
  original_rule_id: 467ed9d9-8035-470e-ad5e-ae5189283033
  source_format: splunk_spl