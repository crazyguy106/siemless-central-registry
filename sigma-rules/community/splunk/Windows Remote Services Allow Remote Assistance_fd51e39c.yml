title: Windows Remote Services Allow Remote Assistance
id: 68330e68-3221-547c-99ca-2cb3cbf1cd64
status: stable
level: medium
description: |
  The following analytic detects modifications in the Windows registry to enable remote desktop assistance on a targeted machine. It leverages data from the Endpoint.Registry datamodel, specifically monitoring changes to the "Control\\Terminal Server\\fAllowToGetHelp" registry path. This activity is significant because enabling remote assistance via registry is uncommon and often associated with adversaries or malware like Azorult. If confirmed malicious, this could allow an attacker to remotely a
author: Teoderick Contreras, Splunk
logsource:
  product: windows
detection:
  selection:
    registry_path: '*\\Control\\Terminal Server\\fAllowToGetHelp*'
    registry_value_data: 0x00000001
  condition: selection
tags:
  - attack.t1021.001
references:
  - https://docs.microsoft.com/en-us/windows-hardware/customize/desktop/unattend/microsoft-windows-remoteassistance-exe-fallowtogethelp
  - https://app.any.run/tasks/a6f2ffe2-e6e2-4396-ae2e-04ea0143f2d8/
custom_attributes:
  original_rule_id: 9bce3a97-bc97-4e89-a1aa-ead151c82fbb
  source_format: splunk_spl