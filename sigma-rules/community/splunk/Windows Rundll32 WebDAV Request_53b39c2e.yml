title: Windows Rundll32 WebDAV Request
id: 0299aff8-11ba-50bf-99fd-59ccee27499e
status: stable
level: high
description: |
  The following analytic identifies the execution of rundll32.exe with command-line arguments loading davclnt.dll and the davsetcookie function to access a remote WebDAV instance. This detection leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names and command-line executions. This activity is significant as it may indicate an attempt to exploit CVE-2023-23397, a known vulnerability. If confirmed malicious, this could allow an attacker to execute remote code o
author: Michael Haag, Splunk
logsource:
  product: windows
detection:
  selection:
    process:
      - '*\\windows\\system32\\davclnt.dll'
      - '*davsetcookie*'
      - '*\\windows\\syswow64\\davclnt.dll'
      - '*davsetcookie*'
  condition: selection
tags:
  - attack.t1048.003
references:
  - https://strontic.github.io/xcyclopedia/library/davclnt.dll-0EA3050E7CC710526E330C413C165DA0.html
  - https://twitter.com/ACEResponder/status/1636116096506818562?s=20
  - https://twitter.com/domchell/status/1635999068282408962?s=20
  - https://msrc.microsoft.com/blog/2023/03/microsoft-mitigates-outlook-elevation-of-privilege-vulnerability/
  - https://www.pwndefend.com/2023/03/15/the-long-game-persistent-hash-theft/
custom_attributes:
  original_rule_id: 320099b7-7eb1-4153-a2b4-decb53267de2
  source_format: splunk_spl