title: Windows PowerView AD Access Control List Enumeration
id: d2da20a4-c6a3-5ab5-bdb8-5aa796e1e691
status: stable
level: high
description: |
  The following analytic detects the execution of PowerView PowerShell cmdlets `Get-ObjectAcl` or `Get-DomainObjectAcl`, which are used to enumerate Access Control List (ACL) permissions for Active Directory objects. It leverages Event ID 4104 from PowerShell Script Block Logging to identify this activity. This behavior is significant as it may indicate an attempt to discover weak permissions in Active Directory, potentially leading to privilege escalation. If confirmed malicious, attackers could 
author: Mauricio Velazco, Splunk
logsource:
  product: windows
detection:
  selection:
    eventcode: 4104
  condition: selection
tags:
  - attack.t1078.002
  - attack.t1069
references:
  - https://attack.mitre.org/techniques/T1078/002/
  - https://medium.com/r3d-buck3t/enumerating-access-controls-in-active-directory-c06e2efa8b89
  - https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/abusing-active-directory-acls-aces
  - https://powersploit.readthedocs.io/en/latest/Recon/Get-DomainObjectAcl/
custom_attributes:
  original_rule_id: 39405650-c364-4e1e-a740-32a63ef042a6
  source_format: splunk_spl