title: Windows PowerShell Export Certificate
id: 549caf88-a65f-5233-9e67-89554f1e3540
status: stable
level: medium
description: |
  The following analytic detects the use of the PowerShell Cmdlet `export-certificate` by leveraging Script Block Logging. This activity is significant as it may indicate an adversary attempting to exfiltrate certificates from the local Certificate Store on a Windows endpoint. Monitoring this behavior is crucial because stolen certificates can be used to impersonate users, decrypt sensitive data, or facilitate further attacks. If confirmed malicious, this activity could lead to unauthorized access
author: Michael Haag, Splunk
logsource:
  product: windows
detection:
  selection:
    eventcode: 4104
    scriptblocktext:
      - '*export-certificate*'
  condition: selection
tags:
  - attack.t1552.004
  - attack.t1649
references:
  - https://dev.to/iamthecarisma/managing-windows-pfx-certificates-through-powershell-3pj
  - https://learn.microsoft.com/en-us/powershell/module/pki/export-certificate?view=windowsserver2022-ps
custom_attributes:
  original_rule_id: 5e38ded4-c964-41f4-8cb6-4a1a53c6929f
  source_format: splunk_spl