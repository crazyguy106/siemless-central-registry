title: Windows Binary Proxy Execution Mavinject DLL Injection
id: f7753133-65aa-5284-a04a-c2b2460e49c0
status: stable
level: high
description: |
  The following analytic detects the use of mavinject.exe for DLL injection into running processes, identified by specific command-line parameters such as /INJECTRUNNING and /HMODULE. This detection leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names and command-line executions. This activity is significant because it indicates potential arbitrary code execution, a common tactic for malware deployment and persistence. If confirmed malicious, this could allow
author: Michael Haag, Splunk
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    process:
      - '*injectrunning*'
      - '*hmodule=0x*'
  condition: selection
tags:
  - attack.t1218.013
references:
  - https://attack.mitre.org/techniques/T1218/013/
  - https://posts.specterops.io/mavinject-exe-functionality-deconstructed-c29ab2cf5c0e
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218/T1218.md#atomic-test-1---mavinject---inject-dll-into-running-process
custom_attributes:
  original_rule_id: ccf4b61b-1b26-4f2e-a089-f2009c569c57
  source_format: splunk_spl