title: Interactive Session on Remote Endpoint with PowerShell
id: 912bc40e-ea91-56c2-9ed6-13a554881919
status: stable
level: high
description: |
  The following analytic detects the use of the `Enter-PSSession` cmdlet to establish an interactive session on a remote endpoint via the WinRM protocol. It leverages PowerShell Script Block Logging (EventCode=4104) to identify this activity by searching for specific script block text patterns. This behavior is significant as it may indicate lateral movement or remote code execution attempts by adversaries. If confirmed malicious, this activity could allow attackers to execute commands remotely, p
author: Mauricio Velazco, Splunk
logsource:
  product: windows
detection:
  selection:
    scriptblocktext:
      - '*Enter-PSSession*'
      - '*-ComputerName*'
    eventcode: 4104
  condition: selection
tags:
  - attack.t1021.006
references:
  - https://attack.mitre.org/techniques/T1021/006/
  - https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/enter-pssession?view=powershell-7.2
custom_attributes:
  original_rule_id: a4e8f3a4-48b2-11ec-bcfc-3e22fbd008af
  source_format: splunk_spl