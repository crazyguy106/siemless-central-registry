title: Remote Process Instantiation via WMI and PowerShell
id: d395bfd6-35bb-5b87-8234-b1ad006f5066
status: stable
level: high
description: |
  The following analytic detects the execution of `powershell.exe` using the `Invoke-WmiMethod` cmdlet to start a process on a remote endpoint via WMI. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on command-line executions and process telemetry. This activity is significant as it indicates potential lateral movement or remote code execution attempts by adversaries. If confirmed malicious, this could allow attackers to execute arbitrary code on remote systems, lead
author: Mauricio Velazco, Splunk
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    process:
      - '*Invoke-WmiMethod*'
      - '*-CN*'
      - '*-Class Win32_Process*'
      - '*-Name create*'
  condition: selection
tags:
  - attack.t1047
references:
  - https://attack.mitre.org/techniques/T1047/
  - https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/invoke-wmimethod?view=powershell-5.1
custom_attributes:
  original_rule_id: 112638b4-4634-11ec-b9ab-3e22fbd008af
  source_format: splunk_spl