title: Linux Ngrok Reverse Proxy Usage
id: c090fe53-154f-5dcd-abfc-4e482850d7d6
status: stable
level: medium
description: |
  The following analytic detects the use of Ngrok on a Linux operating system. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names and command-line arguments associated with Ngrok. This activity is significant because Ngrok can be used by adversaries to establish reverse proxies, potentially bypassing network defenses. If confirmed malicious, this could allow attackers to create persistent, unauthorized access channels, facilitating data exfiltration or f
author: Michael Haag, Splunk
logsource:
  product: linux
detection:
  selection:
    process_name: ngrok
    process:
      - '*start*'
      - '*--config*'
      - '*http*'
      - '*authtoken*'
      - '*http*'
      - '*tcp*'
  condition: selection
tags:
  - attack.t1572
  - attack.t1090
  - attack.t1102
references:
  - https://ngrok.com
  - https://www.cisa.gov/uscert/sites/default/files/publications/aa22-320a_joint_csa_iranian_government-sponsored_apt_actors_compromise_federal%20network_deploy_crypto%20miner_credential_harvester.pdf
custom_attributes:
  original_rule_id: bc84d574-708c-467d-b78a-4c1e20171f97
  source_format: splunk_spl