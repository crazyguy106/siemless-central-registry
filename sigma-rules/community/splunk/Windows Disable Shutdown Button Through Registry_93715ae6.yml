title: Windows Disable Shutdown Button Through Registry
id: 5dcdb668-e849-5ebc-9685-944558ded95e
status: stable
level: medium
description: |
  The following analytic detects suspicious registry modifications that disable the shutdown button on a user's logon screen. It leverages data from the Endpoint.Registry data model, specifically monitoring changes to registry paths associated with shutdown policies. This activity is significant because it is a tactic used by malware, particularly ransomware like KillDisk, to hinder system usability and prevent the removal of malicious changes. If confirmed malicious, this could impede system reco
author: Teoderick Contreras, Splunk, Steven Dick
logsource:
  product: windows
  category: registry_event
detection:
  selection:
    registry_path:
      - '*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\shutdownwithoutlogon'
      - '*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoClose'
    registry_value_data:
      - 0x00000000
      - 0x00000001
  condition: selection
tags:
  - attack.t1112
references:
  - https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ransom.msil.screenlocker.a/
custom_attributes:
  original_rule_id: 55fb2958-9ecd-11ec-a06a-acde48001122
  source_format: splunk_spl