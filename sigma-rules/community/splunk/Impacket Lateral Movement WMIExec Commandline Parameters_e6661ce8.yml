title: Impacket Lateral Movement WMIExec Commandline Parameters
id: 35bd45a8-fbeb-5bc9-ac01-d08ab6fdd105
status: stable
level: high
description: |
  The following analytic detects the use of Impacket's `wmiexec.py` tool for lateral movement by identifying specific command-line parameters. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on processes spawned by `wmiprvse.exe` with command-line patterns indicative of Impacket usage. This activity is significant as Impacket tools are commonly used by adversaries for remote code execution and lateral movement within a network. If confirmed malicious, this could allow
author: Michael Haag, Splunk
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    _spl_reference: true
  condition: selection
tags:
  - attack.t1021.002
  - attack.t1021.003
  - attack.t1047
  - attack.t1543.003
references:
  - https://attack.mitre.org/techniques/T1021/002/
  - https://attack.mitre.org/techniques/T1021/003/
  - https://attack.mitre.org/techniques/T1047/
  - https://attack.mitre.org/techniques/T1053/
  - https://attack.mitre.org/techniques/T1053/005/
custom_attributes:
  original_rule_id: d6e464e4-5c6a-474e-82d2-aed616a3a492
  source_format: splunk_spl