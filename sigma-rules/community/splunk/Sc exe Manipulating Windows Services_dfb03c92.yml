title: Sc exe Manipulating Windows Services
id: b2c96892-2ac2-57af-a785-28292d1f98d2
status: stable
level: high
description: |
  The following analytic detects the creation or modification of Windows services using the sc.exe command. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names and command-line arguments. This activity is significant because manipulating Windows services can be a method for attackers to establish persistence, escalate privileges, or execute arbitrary code. If confirmed malicious, this behavior could allow an attacker to maintain long-term access, disrupt 
author: Rico Valdez, Splunk
logsource:
  product: windows
detection:
  selection:
    process:
      - '* create *'
      - '* config *'
  condition: selection
tags:
  - attack.t1543.003
references:
  - https://www.secureworks.com/blog/drokbk-malware-uses-github-as-dead-drop-resolver
custom_attributes:
  original_rule_id: f0c693d8-2a89-4ce7-80b4-98fea4c3ea6d
  source_format: splunk_spl