title: GetWmiObject Ds Computer with PowerShell
id: 9c1152cf-4449-5141-8ad7-af8db34df81b
status: stable
level: high
description: |
  The following analytic detects the execution of `powershell.exe` with command-line arguments that utilize the `Get-WmiObject` cmdlet to discover remote systems, specifically targeting the `DS_Computer` parameter. This detection leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names and command-line executions. This activity is significant as it indicates potential reconnaissance efforts by adversaries to enumerate domain computers and gather situational aware
author: Mauricio Velazco, Splunk
logsource:
  product: windows
detection:
  selection:
    process_name: powershell.exe
    process:
      - '*namespace root\\directory\\ldap*'
      - '*class ds_computer*'
  condition: selection
tags:
  - attack.t1018
references:
  - https://attack.mitre.org/techniques/T1018/
custom_attributes:
  original_rule_id: 7141122c-3bc2-4aaa-ab3b-7a85a0bbefc3
  source_format: splunk_spl