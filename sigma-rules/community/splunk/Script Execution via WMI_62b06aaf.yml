title: Script Execution via WMI
id: d70be6e6-c4b2-5055-b425-2ef7d1be2772
status: stable
level: high
description: |
  The following analytic detects the execution of scripts via Windows Management Instrumentation (WMI) by monitoring the process 'scrcons.exe'. This detection leverages data from Endpoint Detection and Response (EDR) agents, focusing on process creation events. WMI-based script execution is significant because adversaries often use it to perform malicious activities stealthily, such as system compromise, data exfiltration, or establishing persistence. If confirmed malicious, this activity could al
author: Rico Valdez, Michael Haag, Splunk
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    _spl_reference: true
  condition: selection
tags:
  - attack.t1047
references:
  - https://redcanary.com/blog/child-processes/
custom_attributes:
  original_rule_id: aa73f80d-d728-4077-b226-81ea0c8be589
  source_format: splunk_spl