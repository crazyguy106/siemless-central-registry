title: Windows Time Based Evasion via Choice Exec
id: 9b70a3b4-72c0-5d2c-b712-18b6acfd3996
status: stable
level: medium
description: |
  The following analytic detects the use of choice.exe in batch files as a delay tactic, a technique observed in SnakeKeylogger malware. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names and command-line executions. This activity is significant as it indicates potential time-based evasion techniques used by malware to avoid detection. If confirmed malicious, this behavior could allow attackers to execute code stealthily, delete malicious files, and pers
author: Teoderick Contreras, Splunk
logsource:
  product: windows
detection:
  selection:
    process:
      - '*/T*'
      - '*/N*'
  condition: selection
tags:
  - attack.t1497.003
references:
  - https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/choice
  - https://malpedia.caad.fkie.fraunhofer.de/details/win.404keylogger
custom_attributes:
  original_rule_id: d5f54b38-10bf-4b3a-b6fc-85949862ed50
  source_format: splunk_spl