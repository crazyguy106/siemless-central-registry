title: Windows Modify Registry Default Icon Setting
id: 010a23ef-3893-59f6-86d4-b077f6a92125
status: stable
level: medium
description: |
  The following analytic detects suspicious modifications to the Windows registry's default icon settings, a technique associated with Lockbit ransomware. It leverages data from the Endpoint Registry data model, focusing on changes to registry paths under "*HKCR\\*\\defaultIcon\\(Default)*". This activity is significant as it is uncommon for normal users to modify these settings, and such changes can indicate ransomware infection or other malware. If confirmed malicious, this could lead to system 
author: Teoderick Contreras, Splunk
logsource:
  product: windows
  category: registry_event
detection:
  selection:
    registry_path:
      - '*\\defaultIcon\\(Default)*'
      - '*HKCR\\*'
  condition: selection
tags:
  - attack.t1112
references:
  - https://blogs.vmware.com/security/2022/10/lockbit-3-0-also-known-as-lockbit-black.html
  - https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/
custom_attributes:
  original_rule_id: a7a7afdb-3c58-45b6-9bff-63e5acfd9d40
  source_format: splunk_spl