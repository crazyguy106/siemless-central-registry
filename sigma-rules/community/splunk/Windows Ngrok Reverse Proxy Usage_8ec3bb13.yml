title: Windows Ngrok Reverse Proxy Usage
id: 8db70695-d44a-573a-93d4-bf11f32d13f0
status: stable
level: medium
description: |
  The following analytic detects the execution of ngrok.exe on a Windows operating system. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names and command-line arguments. This activity is significant because while ngrok is a legitimate tool for creating secure tunnels, it is increasingly used by adversaries to bypass network defenses and establish reverse proxies. If confirmed malicious, this could allow attackers to exfiltrate data, maintain persistence,
author: Michael Haag, Splunk
logsource:
  product: windows
detection:
  selection:
    process:
      - '*start*'
      - '*--config*'
      - '*http*'
      - '*authtoken*'
      - '*http*'
      - '*tcp*'
  condition: selection
tags:
  - attack.t1572
  - attack.t1090
  - attack.t1102
references:
  - https://www.cisa.gov/uscert/sites/default/files/publications/aa22-320a_joint_csa_iranian_government-sponsored_apt_actors_compromise_federal%20network_deploy_crypto%20miner_credential_harvester.pdf
custom_attributes:
  original_rule_id: e2549f2c-0aef-408a-b0c1-e0f270623436
  source_format: splunk_spl