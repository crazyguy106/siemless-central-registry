title: BCDEdit Failure Recovery Modification
id: 22acea01-1b48-599a-9f8f-b8b8b4a5a2c5
status: stable
level: high
description: |
  The following analytic detects modifications to the Windows error recovery boot configurations using bcdedit.exe with flags such as "recoveryenabled" and "no". It leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names, parent processes, and command-line executions. This activity is significant because ransomware often disables recovery options to prevent system restoration, making it crucial for SOC analysts to investigate. If confirmed malicious, this could 
author: Michael Haag, Splunk
logsource:
  product: windows
detection:
  selection:
    process:
      - '*recoveryenabled*'
      - '* no*'
  condition: selection
tags:
  - attack.t1490
references:
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1490/T1490.md#atomic-test-4---windows---disable-windows-recovery-console-repair
custom_attributes:
  original_rule_id: 809b31d2-5462-11eb-ae93-0242ac130002
  source_format: splunk_spl