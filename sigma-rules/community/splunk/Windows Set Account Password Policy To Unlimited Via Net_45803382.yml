title: Windows Set Account Password Policy To Unlimited Via Net
id: a420d965-09ff-5cfc-a365-4d9bfe1bf4eb
status: stable
level: medium
description: |
  The following analytic detects the use of net.exe to update user account policies to set passwords as non-expiring. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on command-line executions involving "/maxpwage:unlimited" or "/maxpwage:49710", which achieve a similar outcome theoretically. This activity is significant as it can indicate an attempt to maintain persistence, escalate privileges, evade defenses, or facilitate lateral movement. If confirmed malicious, t
author: Teoderick Contreras, Nasreddine Bencherchali, Splunk
logsource:
  product: windows
  category: authentication
detection:
  selection:
    process:
      - '* accounts *'
      - '* /maxpwage:unlimited'
      - '/maxpwage:49710'
  condition: selection
tags:
  - attack.t1489
references:
  - https://app.any.run/tasks/a6f2ffe2-e6e2-4396-ae2e-04ea0143f2d8/
  - https://docs.microsoft.com/en-us/troubleshoot/windows-server/networking/net-commands-on-operating-systems
custom_attributes:
  original_rule_id: 11f93009-8083-43fd-82a7-821fcbdc8342
  source_format: splunk_spl