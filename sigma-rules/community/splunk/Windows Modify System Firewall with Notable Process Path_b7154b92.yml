title: Windows Modify System Firewall with Notable Process Path
id: a8533216-2b1f-5d76-bdff-32162d968d37
status: stable
level: high
description: |
  The following analytic detects suspicious modifications to system firewall rules, specifically allowing execution of applications from notable and potentially malicious file paths. This detection leverages data from Endpoint Detection and Response (EDR) agents, focusing on command-line executions involving firewall rule changes. This activity is significant as it may indicate an adversary attempting to bypass firewall restrictions to execute malicious files. If confirmed malicious, this could al
author: Teoderick Contreras, Will Metcalf, Splunk
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    process:
      - '*\\windows\\fonts\\*'
      - '*\\windows\\temp\\*'
      - '*\\users\\public\\*'
      - '*\\windows\\debug\\*'
      - '*\\Users\\Administrator\\Music\\*'
      - '*\\Windows\\servicing\\*'
      - '*\\Users\\Default\\*'
      - '*Recycle.bin*'
      - '*\\Windows\\Media\\*'
      - \\Windows\\repair\\*
      - '*\\temp\\*'
      - '*\\PerfLogs\\*'
  condition: selection
tags:
  - attack.t1562.004
references:
  - https://www.splunk.com/en_us/blog/security/more-than-just-a-rat-unveiling-njrat-s-mbr-wiping-capabilities.html
custom_attributes:
  original_rule_id: cd6d7410-9146-4471-a418-49edba6dadc4
  source_format: splunk_spl