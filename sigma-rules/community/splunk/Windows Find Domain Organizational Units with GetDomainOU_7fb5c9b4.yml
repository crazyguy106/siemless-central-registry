title: Windows Find Domain Organizational Units with GetDomainOU
id: 049dc2af-fe41-5e0e-8b8c-46d543477971
status: stable
level: high
description: |
  The following analytic detects the execution of the `Get-DomainOU` cmdlet, a part of the PowerView toolkit used for Windows domain enumeration. It leverages PowerShell Script Block Logging (EventCode=4104) to identify this activity. Detecting `Get-DomainOU` usage is significant as adversaries may use it to gather information about organizational units within Active Directory, which can facilitate lateral movement or privilege escalation. If confirmed malicious, this activity could allow attacker
author: Gowthamaraj Rajendran, Mauricio Velazco, Splunk
logsource:
  product: windows
detection:
  selection:
    scriptblocktext: '*Get-DomainOU*'
    eventcode: 4104
  condition: selection
tags:
  - attack.t1087.002
references:
  - https://powersploit.readthedocs.io/en/latest/Recon/Get-DomainOU/
  - https://attack.mitre.org/techniques/T1087/002/
  - https://book.hacktricks.xyz/windows-hardening/basic-powershell-for-pentesters/powerview
custom_attributes:
  original_rule_id: 0ada2f82-b7af-40cc-b1d7-1e5985afcb4e
  source_format: splunk_spl