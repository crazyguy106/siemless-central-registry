title: Detect SharpHound Usage
id: fdc35c12-a5d0-5cf4-914c-412f783f1eee
status: stable
level: high
description: |
  The following analytic detects the usage of the SharpHound binary by identifying its original filename, `SharpHound.exe`, and the process name. This detection leverages data from Endpoint Detection and Response (EDR) agents, focusing on process metadata and command-line executions. SharpHound is a tool used for Active Directory enumeration, often by attackers during the reconnaissance phase. If confirmed malicious, this activity could allow an attacker to map out the network, identify high-value
author: Michael Haag, Splunk
logsource:
  product: splunk
detection:
  selection:
    _spl_reference: true
  condition: selection
tags:
  - attack.t1069.001
  - attack.t1069.002
  - attack.t1087.001
  - attack.t1087.002
  - attack.t1482
references:
  - https://attack.mitre.org/software/S0521/
  - https://thedfirreport.com/?s=bloodhound
  - https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors
  - https://github.com/BloodHoundAD/SharpHound3
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.001/T1059.001.md#atomic-test-2---run-bloodhound-from-local-disk
custom_attributes:
  original_rule_id: dd04b29a-beed-11eb-87bc-acde48001122
  source_format: splunk_spl