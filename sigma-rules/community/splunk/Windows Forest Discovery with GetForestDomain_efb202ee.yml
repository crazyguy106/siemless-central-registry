title: Windows Forest Discovery with GetForestDomain
id: 69b72e8e-f9d7-5e01-9bce-8dc3c088d7e1
status: stable
level: high
description: |
  The following analytic detects the execution of the `Get-ForestDomain` cmdlet, a component of the PowerView toolkit used for Windows domain enumeration. It leverages PowerShell Script Block Logging (EventCode=4104) to identify this activity. Detecting `Get-ForestDomain` is significant because adversaries and Red Teams use it to gather detailed information about Active Directory forest and domain configurations. If confirmed malicious, this activity could enable attackers to understand the domain
author: Gowthamaraj Rajendran, Mauricio Velazco, Splunk
logsource:
  product: windows
detection:
  selection:
    scriptblocktext: '*Get-ForestDomain*'
    eventcode: 4104
  condition: selection
tags:
  - attack.t1087.002
references:
  - https://powersploit.readthedocs.io/en/latest/Recon/Get-ForestDomain/
  - https://attack.mitre.org/techniques/T1087/002/
  - https://book.hacktricks.xyz/windows-hardening/basic-powershell-for-pentesters/powerview
custom_attributes:
  original_rule_id: a14803b2-4bd9-4c08-8b57-c37980edebe8
  source_format: splunk_spl