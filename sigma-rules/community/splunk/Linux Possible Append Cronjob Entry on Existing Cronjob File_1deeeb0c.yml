title: Linux Possible Append Cronjob Entry on Existing Cronjob File
id: f728d33e-ccae-503c-8cde-fc961293a445
status: stable
level: low
description: |
  The following analytic detects potential tampering with cronjob files on a Linux system by identifying 'echo' commands that append code to existing cronjob files. It leverages logs from Endpoint Detection and Response (EDR) agents, focusing on process names, parent processes, and command-line executions. This activity is significant because adversaries often use it for persistence or privilege escalation. If confirmed malicious, this could allow attackers to execute unauthorized code automatical
author: Teoderick Contreras, Splunk
logsource:
  product: linux
  category: file_event
detection:
  selection:
    process:
      - '*/etc/cron*'
      - '*/var/spool/cron/*'
      - '*/etc/anacrontab*'
  condition: selection
tags:
  - attack.t1053.003
references:
  - https://attack.mitre.org/techniques/T1053/003/
  - https://blog.aquasec.com/threat-alert-kinsing-malware-container-vulnerability
  - https://www.intezer.com/blog/research/kaiji-new-chinese-linux-malware-turning-to-golang/
custom_attributes:
  original_rule_id: b5b91200-5f27-11ec-bb4e-acde48001122
  source_format: splunk_spl