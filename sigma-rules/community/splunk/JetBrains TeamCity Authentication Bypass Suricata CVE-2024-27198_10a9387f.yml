title: JetBrains TeamCity Authentication Bypass Suricata CVE-2024-27198
id: df5b4e09-d586-57c7-85cf-d09c06426ee3
status: stable
level: high
description: |
  The following analytic detects attempts to exploit the CVE-2024-27198 vulnerability in JetBrains TeamCity on-premises servers, which allows attackers to bypass authentication mechanisms. It leverages Suricata HTTP traffic logs to identify suspicious POST requests to the `/app/rest/users` and `/app/rest/users/id:1/tokens` endpoints. This activity is significant because it can lead to unauthorized administrative access, enabling attackers to gain full control over the TeamCity server, including pr
author: Michael Haag, Splunk
logsource:
  product: splunk
  category: authentication
detection:
  selection:
    url:
      - '*jsp=/app/rest/users;.jsp'
      - '*?jsp=/app/rest/users;.jsp'
      - '*?jsp=.*/app/rest/users/id:*/tokens;*'
    status:
      - 200
      - 200
    http_method: POST
  condition: selection
tags:
  - attack.t1190
references:
  - https://github.com/projectdiscovery/nuclei-templates/pull/9279/files
  - https://www.rapid7.com/blog/post/2024/03/04/etr-cve-2024-27198-and-cve-2024-27199-jetbrains-teamcity-multiple-authentication-bypass-vulnerabilities-fixed/
  - https://blog.jetbrains.com/teamcity/2024/03/teamcity-2023-11-4-is-out/
  - https://blog.jetbrains.com/teamcity/2024/03/additional-critical-security-issues-affecting-teamcity-on-premises-cve-2024-27198-and-cve-2024-27199-update-to-2023-11-4-now/
custom_attributes:
  original_rule_id: fbcc04c7-8a79-453c-b3a9-c232c423bdd3
  source_format: splunk_spl