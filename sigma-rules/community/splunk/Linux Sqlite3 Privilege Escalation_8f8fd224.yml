title: Linux Sqlite3 Privilege Escalation
id: 01e49d62-0670-523b-a39e-b0ced9fca20e
status: stable
level: medium
description: |
  The following analytic detects the execution of the sqlite3 command with elevated privileges, which can be exploited for privilege escalation. It leverages Endpoint Detection and Response (EDR) telemetry to identify instances where sqlite3 is used in conjunction with shell commands and sudo. This activity is significant because it indicates a potential attempt to gain root access, which could lead to full system compromise. If confirmed malicious, an attacker could execute arbitrary commands as 
author: Gowthamaraj Rajendran, Splunk
logsource:
  product: linux
detection:
  selection:
    process:
      - '*sqlite3*'
      - '*.shell*'
      - '*sudo*'
  condition: selection
tags:
  - attack.t1548.003
references:
  - https://gtfobins.github.io/gtfobins/sqlite3/
  - https://manpages.ubuntu.com/manpages/trusty/en/man1/sqlite3.1.html
custom_attributes:
  original_rule_id: ab75dbb7-c3ba-4689-9c1b-8d2717bdcba1
  source_format: splunk_spl