title: Windows PowerShell FakeCAPTCHA Clipboard Execution
id: 678b42f3-d83f-5ede-a53b-d160f359786b
status: stable
level: high
description: |
  This detection identifies potential FakeCAPTCHA/ClickFix clipboard hijacking campaigns by looking for PowerShell execution with hidden window parameters and distinctive strings related to fake CAPTCHA verification. These campaigns use social engineering to trick users into pasting malicious PowerShell commands from their clipboard, typically delivering information stealers or remote access trojans.
author: Michael Haag, Splunk
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    process:
      - '*click*'
      - '*verify*'
      - '*check*'
      - '*human*'
      - '*bot*'
      - '*token*'
      - '*challenge*'
  condition: selection
tags:
  - attack.t1059.001
  - attack.t1204.001
  - attack.t1059.003
references:
  - https://urlhaus.abuse.ch/
  - https://www.proofpoint.com/us/blog/threat-insight/security-brief-clickfix-social-engineering-technique-floods-threat-landscape
  - https://reliaquest.com/blog/using-captcha-for-compromise/
  - https://attack.mitre.org/techniques/T1204/001/
  - https://github.com/MHaggis/ClickGrab
custom_attributes:
  original_rule_id: d81d4d3d-76b5-4f21-ab51-b17d5164c106
  source_format: splunk_spl