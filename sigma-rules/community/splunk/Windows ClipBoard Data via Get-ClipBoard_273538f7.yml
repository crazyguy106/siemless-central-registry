title: Windows ClipBoard Data via Get-ClipBoard
id: 28f36ad4-188d-5a82-b5b8-643e34a728c4
status: stable
level: medium
description: |
  The following analytic detects the execution of the PowerShell command 'Get-Clipboard' to retrieve clipboard data. It leverages PowerShell Script Block Logging (EventCode 4104) to identify instances where this command is used. This activity is significant because it can indicate an attempt to steal sensitive information such as usernames, passwords, or other confidential data copied to the clipboard. If confirmed malicious, this behavior could lead to unauthorized access to sensitive information
author: Teoderick Contreras, Splunk
logsource:
  product: windows
detection:
  selection:
    scriptblocktext: '*Get-Clipboard*'
    eventcode: 4104
  condition: selection
tags:
  - attack.t1115
references:
  - https://attack.mitre.org/techniques/T1115/
  - https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS
  - https://www.microsoft.com/en-us/security/blog/2022/10/14/new-prestige-ransomware-impacts-organizations-in-ukraine-and-poland/
custom_attributes:
  original_rule_id: ab73289e-2246-4de0-a14b-67006c72a893
  source_format: splunk_spl