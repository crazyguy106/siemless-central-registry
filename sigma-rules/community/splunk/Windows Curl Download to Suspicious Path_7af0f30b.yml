title: Windows Curl Download to Suspicious Path
id: 9acc183c-78b0-56c4-8065-1f7a6583433d
status: stable
level: high
description: |
  The following analytic detects the use of Windows Curl.exe to download a file to a suspicious location, such as AppData, ProgramData, or Public directories. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on command-line executions that include the -O or --output options. This activity is significant because downloading files to these locations can indicate an attempt to bypass security controls or establish persistence. If confirmed malicious, this behavior could l
author: Michael Haag, Nasreddine Bencherchali, Splunk
logsource:
  product: windows
detection:
  selection:
    process:
      - '*:\\PerfLogs\\*'
      - '*:\\Windows\\Temp\\*'
      - '*\\AppData\\*'
      - '*\\ProgramData\\*'
      - '*\\Users\\Public\\*'
      - '*%AppData%*'
      - '*%Public%*'
      - '*%Temp%*'
      - '*%tmp%*'
  condition: selection
tags:
  - attack.t1105
references:
  - https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/
  - https://attack.mitre.org/techniques/T1105/
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1105/T1105.md
custom_attributes:
  original_rule_id: c32f091e-30db-11ec-8738-acde48001122
  source_format: splunk_spl