title: Potential Telegram API Request Via CommandLine
id: 145c5507-b86d-5d8e-9fd9-024859f8a4e5
status: stable
level: medium
description: |
  The following analytic detects the presence of "api.telegram.org" in the CommandLine of a process. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on process execution logs that include command-line details. This activity can be significant as the telegram API has been used as an exfiltration mechanism or even as a C2 channel. If confirmed malicious, this could allow an attacker or malware to exfiltrate data or receive additional C2 instruction, potentially leading 
author: Nasreddine Bencherchali, Splunk, Zaki Zarkasih Al Mustafa
logsource:
  product: splunk
  category: process_creation
detection:
  selection:
    process:
      - '*-osint -url*'
      - '* --single-argument*'
  condition: selection
tags:
  - attack.t1102.002
  - attack.t1041
references:
  - https://www.virustotal.com/gui/file/0b3ef5e04329cefb5bb4bf30b3edcb32d1ec6bbcb29d22695a079bfb5b56e8ac/behavior
  - https://www.virustotal.com/gui/file/72c59eeb15b5ec1d95e72e4b06a030bc058822bc10e5cb807e78a4624d329666/behavior
  - https://www.virustotal.com/gui/file/72c59eeb15b5ec1d95e72e4b06a030bc058822bc10e5cb807e78a4624d329666/content
  - https://www.virustotal.com/gui/file/1c4541bf70b6e251ef024ec4dde8dce400539c2368461c0d90e15a81b11ace44/content
custom_attributes:
  original_rule_id: d6b0d627-d0bf-46b1-936f-c48284767d21
  source_format: splunk_spl