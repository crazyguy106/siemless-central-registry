title: Windows Disable Change Password Through Registry
id: 469095c0-9bb8-57d6-ac4d-f2d1de3501f1
status: stable
level: medium
description: |
  The following analytic detects a suspicious registry modification that disables the Change Password feature on a Windows host. It identifies changes to the registry path "*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableChangePassword" with a value of "0x00000001". This activity is significant as it can prevent users from changing their passwords, a tactic often used by ransomware to maintain control over compromised systems. If confirmed malicious, this could hinder use
author: Teoderick Contreras, Splunk, Steven Dick
logsource:
  product: windows
  category: authentication
detection:
  selection:
    registry_path: '*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableChangePassword'
    registry_value_data: 0x00000001
  condition: selection
tags:
  - attack.t1112
references:
  - https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ransom_heartbleed.thdobah
custom_attributes:
  original_rule_id: 0df33e1a-9ef6-11ec-a1ad-acde48001122
  source_format: splunk_spl