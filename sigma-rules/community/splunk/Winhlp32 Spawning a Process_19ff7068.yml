title: Winhlp32 Spawning a Process
id: 5c758bd9-80c9-5f88-9c19-372efc30c2b5
status: stable
level: high
description: |
  The following analytic detects winhlp32.exe spawning a child process that loads a file from appdata, programdata, or temp directories. This detection leverages data from Endpoint Detection and Response (EDR) agents, focusing on process creation events. This activity is significant because winhlp32.exe has known vulnerabilities and can be exploited to execute malicious code. If confirmed malicious, an attacker could use this technique to execute arbitrary scripts, escalate privileges, or maintain
author: Michael Haag, Splunk
logsource:
  product: splunk
  category: process_creation
detection:
  selection:
    process:
      - '*\\appdata\\*'
      - '*\\programdata\\*'
      - '*\\temp\\*'
  condition: selection
tags:
  - attack.t1055
references:
  - https://www.exploit-db.com/exploits/16541
  - https://tria.ge/210929-ap75vsddan
  - https://www.virustotal.com/gui/file/cb77b93150cb0f7fe65ce8a7e2a5781e727419451355a7736db84109fa215a89
custom_attributes:
  original_rule_id: d17dae9e-2618-11ec-b9f5-acde48001122
  source_format: splunk_spl