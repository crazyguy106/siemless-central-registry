title: Detect HTML Help Using InfoTech Storage Handlers
id: 03850b9d-64ac-574a-b2d0-b46f83dc7a41
status: stable
level: high
description: |
  The following analytic detects the execution of hh.exe (HTML Help) using InfoTech Storage Handlers to load Windows script code from a Compiled HTML Help (CHM) file. This detection leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names and command-line executions. This activity is significant because it can be used to execute malicious scripts embedded within CHM files, potentially leading to code execution. If confirmed malicious, this technique could allow a
author: Michael Haag, Splunk
logsource:
  product: windows
detection:
  selection:
    process:
      - '*its:*'
      - '*mk:@MSITStore:*'
  condition: selection
tags:
  - attack.t1218.001
references:
  - https://attack.mitre.org/techniques/T1218/001/
  - https://www.kb.cert.org/vuls/id/851869
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.001/T1218.001.md
  - https://lolbas-project.github.io/lolbas/Binaries/Hh/
  - https://gist.github.com/mgeeky/cce31c8602a144d8f2172a73d510e0e7
custom_attributes:
  original_rule_id: 0b2eefa5-5508-450d-b970-3dd2fb761aec
  source_format: splunk_spl