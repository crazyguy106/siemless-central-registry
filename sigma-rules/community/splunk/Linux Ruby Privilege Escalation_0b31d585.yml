title: Linux Ruby Privilege Escalation
id: 65bb7647-3405-5b25-85a2-32be9ab796b3
status: stable
level: medium
description: |
  The following analytic detects the execution of Ruby commands with elevated privileges on a Linux system. It identifies processes where Ruby is used with the `-e` flag to execute commands via `sudo`, leveraging Endpoint Detection and Response (EDR) telemetry. This activity is significant because it indicates a potential privilege escalation attempt, allowing a user to execute commands as root. If confirmed malicious, this could lead to full system compromise, enabling an attacker to gain root ac
author: Gowthamaraj Rajendran, Splunk
logsource:
  product: linux
detection:
  selection:
    process:
      - '*ruby*-e*'
      - '*exec*'
      - '*sudo*'
  condition: selection
tags:
  - attack.t1548.003
references:
  - https://gtfobins.github.io/gtfobins/ruby/
custom_attributes:
  original_rule_id: 097b28b5-7004-4d40-a715-7e390501788b
  source_format: splunk_spl