title: Windows InstallUtil in Non Standard Path
id: 4b874d94-d91a-534f-b5ca-df96dc7c5643
status: stable
level: high
description: |
  The following analytic detects the execution of InstallUtil.exe from non-standard paths. It leverages Endpoint Detection and Response (EDR) data, focusing on process names and original file names outside typical directories. This activity is significant because InstallUtil.exe is often used by attackers to execute malicious code or scripts. If confirmed malicious, this behavior could allow an attacker to bypass security controls, execute arbitrary code, and potentially gain unauthorized access o
author: Michael Haag, Splunk
logsource:
  product: windows
detection:
  selection:
    process_path:
      - '*\\Windows\\ADWS\\*'
      - '*\\Windows\\SysWOW64*'
      - '*\\Windows\\system32*'
      - '*\\Windows\\NetworkController\\*'
      - '*\\Windows\\SystemApps\\*'
      - '*\\WinSxS\\*'
      - '*\\Windows\\Microsoft.NET\\*'
  condition: selection
tags:
  - attack.t1036.003
  - attack.t1218.004
references:
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1036.003/T1036.003.yaml
  - https://attack.mitre.org/techniques/T1036/003/
  - https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/
  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.004/T1218.004.md
custom_attributes:
  original_rule_id: dcf74b22-7933-11ec-857c-acde48001122
  source_format: splunk_spl