title: Windows Powershell Logoff User via Quser
id: 7bdcf396-7ca9-5eaa-8ca2-e2419ef31f8d
status: stable
level: medium
description: |
  The following analytic detects the process of logging off a user through the use of the quser and logoff commands. By monitoring for these commands, the analytic identifies actions where a user session is forcibly terminated, which could be part of an administrative task or a potentially unauthorized access attempt. This detection helps identify potential misuse or malicious activity where a userâ€™s access is revoked without proper authorization, providing insight into potential security incident
author: Teoderick Contreras, Splunk
logsource:
  product: windows
detection:
  selection:
    scriptblocktext: '*quser*logoff*'
    eventcode: 4104
  condition: selection
tags:
  - attack.t1059.001
  - attack.t1531
references:
  - https://devblogs.microsoft.com/scripting/automating-quser-through-powershell/
custom_attributes:
  original_rule_id: 6d70780d-4cfe-4820-bafd-1b43941986b5
  source_format: splunk_spl