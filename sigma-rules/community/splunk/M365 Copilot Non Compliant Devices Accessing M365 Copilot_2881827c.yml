title: M365 Copilot Non Compliant Devices Accessing M365 Copilot
id: 41d3bb87-63d1-5ae1-b74f-9a918d82dac2
status: stable
level: medium
description: |
  Detects M365 Copilot access from non-compliant or unmanaged devices that violate corporate security policies, indicating potential shadow IT usage, BYOD policy violations, or compromised endpoint access. The detection filters M365 Copilot Graph API events where deviceDetail.isCompliant=false or deviceDetail.isManaged=false, then aggregates by user, operating system, and browser to calculate metrics including event counts, unique IPs and locations, and compliance/management status over time. User
author: Rod Soto
logsource:
  product: splunk
detection:
  selection:
    appdisplayname:
      - '*Copilot*'
      - M365ChatClient
    iscompliant: 'false'
    ismanaged: 'false'
    user: userPrincipalName
  condition: selection
tags:
  - attack.t1562
references:
  - https://www.splunk.com/en_us/blog/artificial-intelligence/m365-copilot-log-analysis-splunk.html
custom_attributes:
  original_rule_id: e26bc52d-9cbc-4743-9745-e8781d935042
  source_format: splunk_spl