title: Allow Network Discovery In Firewall
id: 4f48cf4b-528c-565a-a6df-802aa63bb2f3
status: stable
level: high
description: |
  The following analytic detects a suspicious modification to the firewall to allow network discovery on a machine. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on command-line executions involving the 'netsh' command to enable network discovery. This activity is significant because it is commonly used by ransomware, such as REvil and RedDot, to discover and compromise additional machines on the network. If confirmed malicious, this could lead to widespread file en
author: Teoderick Contreras, Splunk
logsource:
  product: splunk
  category: network_connection
detection:
  selection:
    process:
      - '*firewall*'
      - '*group=\'
      - '*enable*'
      - '*Yes*'
  condition: selection
tags:
  - attack.t1562.007
references:
  - https://community.fortinet.com:443/t5/FortiEDR/How-FortiEDR-detects-and-blocks-Revil-Ransomware-aka-sodinokibi/ta-p/189638?externalID=FD52469
  - https://app.any.run/tasks/c0f98850-af65-4352-9746-fbebadee4f05/
custom_attributes:
  original_rule_id: ccd6a38c-d40b-11eb-85a5-acde48001122
  source_format: splunk_spl