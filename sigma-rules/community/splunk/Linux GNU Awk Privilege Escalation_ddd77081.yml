title: Linux GNU Awk Privilege Escalation
id: 2bda032c-8615-590b-af0f-1d7d118bf0b4
status: stable
level: medium
description: |
  The following analytic detects the execution of the 'gawk' command with elevated privileges on a Linux system. It leverages Endpoint Detection and Response (EDR) telemetry to identify command-line executions where 'gawk' is used with 'sudo' and 'BEGIN{system' patterns. This activity is significant because it indicates a potential privilege escalation attempt, allowing a user to execute system commands as root. If confirmed malicious, this could lead to full root access, enabling the attacker to 
author: Gowthamaraj Rajendran, Splunk
logsource:
  product: linux
detection:
  selection:
    process:
      - '*gawk*'
      - '*BEGIN*{system*'
      - '*sudo*'
  condition: selection
tags:
  - attack.t1548.003
references:
  - https://gtfobins.github.io/gtfobins/gawk/
  - https://www.geeksforgeeks.org/gawk-command-in-linux-with-examples/
custom_attributes:
  original_rule_id: 0dcf43b9-50d8-42a6-acd9-d1c9201fe6ae
  source_format: splunk_spl