title: Windows Snake Malware Service Create
id: 0666f9ae-b142-51ae-9b91-3472bfdec873
status: stable
level: high
description: |
  The following analytic detects the creation of a new service named WerFaultSvc with a binary path in the Windows WinSxS directory. It leverages Windows System logs, specifically EventCode 7045, to identify this activity. This behavior is significant because it indicates the presence of Snake malware, which uses this service to maintain persistence by blending in with legitimate Windows services. If confirmed malicious, this activity could allow an attacker to execute Snake malware components, le
author: Michael Haag, Splunk
logsource:
  product: windows
  category: file_event
detection:
  selection:
    imagepath:
      - '*\\windows\\winSxS\\*'
      - '*\Werfault.exe'
    eventcode: 7045
  condition: selection
tags:
  - attack.t1547.006
  - attack.t1569.002
references:
  - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
custom_attributes:
  original_rule_id: 64eb091f-8cab-4b41-9b09-8fb4942377df
  source_format: splunk_spl