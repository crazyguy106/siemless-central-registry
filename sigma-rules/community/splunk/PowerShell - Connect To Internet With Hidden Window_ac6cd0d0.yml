title: PowerShell - Connect To Internet With Hidden Window
id: 063d1cb9-7838-572f-ae71-38f38eacdb44
status: stable
level: low
description: |
  The following analytic detects PowerShell commands using the WindowStyle parameter to hide the window while connecting to the Internet. This behavior is identified through Endpoint Detection and Response (EDR) telemetry, focusing on command-line executions that include variations of the WindowStyle parameter. This activity is significant because it attempts to bypass default PowerShell execution policies and conceal its actions, which is often indicative of malicious intent. If confirmed malicio
author: David Dorsey, Michael Haag Splunk
logsource:
  product: windows
detection:
  selection:
    _spl_reference: true
  condition: selection
tags:
  - attack.t1059.001
references:
  - https://regexr.com/663rr
  - https://github.com/redcanaryco/AtomicTestHarnesses/blob/master/Windows/TestHarnesses/T1059.001_PowerShell/OutPowerShellCommandLineParameter.ps1
  - https://ss64.com/ps/powershell.html
  - https://twitter.com/M_haggis/status/1440758396534214658?s=20
  - https://blog.netlab.360.com/ten-families-of-malicious-samples-are-spreading-using-the-log4j2-vulnerability-now/
custom_attributes:
  original_rule_id: ee18ed37-0802-4268-9435-b3b91aaa18db
  source_format: splunk_spl