title: JetBrains TeamCity Limited Auth Bypass Suricata CVE-2024-27199
id: d5193653-a52e-54e1-be8e-5d71cc8cc6e7
status: stable
level: high
description: |
  The following analytic identifies attempts to exploit CVE-2024-27199, a critical vulnerability in JetBrains TeamCity web server, allowing unauthenticated access to specific endpoints. It detects unusual access patterns to vulnerable paths such as /res/, /update/, and /.well-known/acme-challenge/ by monitoring HTTP traffic logs via Suricata. This activity is significant as it could indicate an attacker bypassing authentication to access or modify system settings. If confirmed malicious, this coul
author: Michael Haag, Splunk
logsource:
  product: splunk
  category: authentication
detection:
  selection:
    status: 200
    http_method: GET
    url:
      - '*../admin/diagnostic.jsp*'
      - '*../app/https/settings/*'
      - '*../app/pipeline*'
      - '*../app/oauth/space/createBuild.html*'
      - '*../res/*'
      - '*../update/*'
      - '*../.well-known/acme-challenge/*'
      - '*../app/availableRunners*'
      - '*../app/https/settings/setPort*'
      - '*../app/https/settings/certificateInfo*'
      - '*../app/https/settings/defaultHttpsPort*'
      - '*../app/https/settings/fetchFromAcme*'
      - '*../app/https/settings/removeCertificate*'
      - '*../app/https/settings/uploadCertificate*'
      - '*../app/https/settings/termsOfService*'
      - '*../app/https/settings/triggerAcmeChallenge*'
      - '*../app/https/settings/cancelAcmeChallenge*'
      - '*../app/https/settings/getAcmeOrder*'
      - '*../app/https/settings/setRedirectStrategy*'
  condition: selection
tags:
  - attack.t1190
references:
  - https://github.com/projectdiscovery/nuclei-templates/blob/f644ec82dfe018890c6aa308967424d26c0f1522/http/cves/2024/CVE-2024-27199.yaml
  - https://www.rapid7.com/blog/post/2024/03/04/etr-cve-2024-27198-and-cve-2024-27199-jetbrains-teamcity-multiple-authentication-bypass-vulnerabilities-fixed/
  - https://blog.jetbrains.com/teamcity/2024/03/teamcity-2023-11-4-is-out/
  - https://blog.jetbrains.com/teamcity/2024/03/additional-critical-security-issues-affecting-teamcity-on-premises-cve-2024-27198-and-cve-2024-27199-update-to-2023-11-4-now/
custom_attributes:
  original_rule_id: a1e68dcd-2e24-4434-bd0e-b3d4de139d58
  source_format: splunk_spl