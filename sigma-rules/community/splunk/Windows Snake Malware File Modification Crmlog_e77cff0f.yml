title: Windows Snake Malware File Modification Crmlog
id: d2f49c98-9355-563c-aea1-e556c060c583
status: stable
level: high
description: |
  The following analytic identifies the creation of a .crmlog file within the %windows%\Registration directory, typically with a format of <RANDOM_GUID>.<RANDOM_GUID>.crmlog. This detection leverages the Endpoint.Filesystem datamodel to monitor file creation events in the specified directory. This activity is significant as it is associated with the Snake malware, which uses this file for its operations. If confirmed malicious, this could indicate the presence of Snake malware, leading to potentia
author: Michael Haag, Splunk
logsource:
  product: windows
  category: file_event
detection:
  selection:
    file_path: '*\\windows\\registration\\*'
    file_name: '*.crmlog'
  condition: selection
tags:
  - attack.t1027
references:
  - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
custom_attributes:
  original_rule_id: 27187e0e-c221-471d-a7bd-04f698985ff6
  source_format: splunk_spl