title: Confluence Pre-Auth RCE via OGNL Injection CVE-2023-22527
id: b3e146be-1209-5c52-a286-c8a40eaf6e7a
status: stable
level: high
description: |
  The following analytic identifies attempts to exploit a critical template injection vulnerability (CVE-2023-22527) in outdated Confluence Data Center and Server versions. It detects POST requests to the "/template/aui/text-inline.vm" endpoint with HTTP status codes 200 or 202, indicating potential OGNL injection attacks. This activity is significant as it allows unauthenticated attackers to execute arbitrary code remotely. If confirmed malicious, attackers could gain full control over the affect
author: Michael Haag, Splunk
logsource:
  product: splunk
  category: authentication
detection:
  selection:
    url: '*/template/aui/text-inline.vm*'
    datamodel: Web
    http_method: POST
    status:
      - 200
      - 202
  condition: selection
tags:
  - attack.t1190
references:
  - https://github.com/cleverg0d/CVE-2023-22527
  - https://confluence.atlassian.com/security/cve-2023-22527-rce-remote-code-execution-vulnerability-in-confluence-data-center-and-confluence-server-1333990257.html
custom_attributes:
  original_rule_id: f56936c0-ae6f-4eeb-91ff-ecc1448c6105
  source_format: splunk_spl