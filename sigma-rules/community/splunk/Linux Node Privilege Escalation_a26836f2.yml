title: Linux Node Privilege Escalation
id: 2ae48147-b25f-56ae-b109-2da164145bd6
status: stable
level: medium
description: |
  The following analytic identifies the execution of Node.js with elevated privileges using sudo, specifically when spawning child processes. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on command-line executions that include specific Node.js commands. This activity is significant because running Node.js as a superuser without dropping privileges can allow unauthorized access to the file system and potential privilege escalation. If confirmed malicious, this could
author: Gowthamaraj Rajendran, Splunk
logsource:
  product: linux
detection:
  selection:
    process:
      - '*sudo*node*'
      - '*-e*'
      - '*child_process.spawn*'
      - '*stdio*'
  condition: selection
tags:
  - attack.t1548.003
references:
  - https://gtfobins.github.io/gtfobins/docker/
  - https://en.wikipedia.org/wiki/Node.js
custom_attributes:
  original_rule_id: 2e58a4ff-398f-42f4-8fd0-e01ebfe2a8ce
  source_format: splunk_spl