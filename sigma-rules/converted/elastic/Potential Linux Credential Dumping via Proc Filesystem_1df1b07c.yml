title: Potential Linux Credential Dumping via Proc Filesystem
id: ef100a2e-ecd4-4f72-9d1e-2f779ff3c311
status: stable
level: medium
description: 'Identifies the execution of the mimipenguin exploit script which is
  linux adaptation of Windows tool mimikatz.

  Mimipenguin exploit script is used to dump clear text passwords from a currently
  logged-in user. The tool exploits a

  known vulnerability CVE-2018-20781. Malicious actors can exploit the cleartext credentials
  in memory by dumping the

  process and extracting lines that have a high probability of containing cleartext
  passwords.'
author: Elastic (converted by SIEMLess)
date: '2023-04-26'
modified: '2025-03-20'
logsource:
  product: linux
  category: process_creation
detection:
  selection:
    _original_eql: "sequence by host.id, process.parent.name with maxspan=1m\n  [process\
      \ where host.os.type == \"linux\" and process.name == \"ps\" and event.action\
      \ in (\"exec\", \"start\", \"exec_event\")\n   and process.args in (\"-eo\"\
      , \"pid\", \"command\")]\n  [process where host.os.type == \"linux\" and process.name\
      \ == \"strings\" and event.action in (\"exec\", \"start\", \"exec_event\")\n\
      \   and process.args : \"/tmp/*\"]"
  condition: selection
  _conversion_note: Complex EQL with sequence - requires manual review
tags:
- attack.credential_access
- attack.t1003
- attack.t1003.007
- attack.t1212
references:
- https://github.com/huntergregal/mimipenguin
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20781
