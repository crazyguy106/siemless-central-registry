title: Potential Pspy Process Monitoring Detected
id: bdb04043-f0e3-4efa-bdee-7d9d13fa9edc
status: stable
level: low
description: 'This rule leverages auditd to monitor for processes scanning different
  processes within the /proc directory using the

  openat syscall. This is a strong indication for the usage of the pspy utility. Attackers
  may leverage the pspy process

  monitoring utility to monitor system processes without requiring root permissions,
  in order to find potential privilege

  escalation vectors.'
author: Elastic (converted by SIEMLess)
date: '2023-07-20'
modified: '2025-01-24'
logsource:
  product: linux
  category: process_creation
detection:
  selection:
    _original_eql: "sequence by process.pid, host.id with maxspan=5s\n  [file where\
      \ host.os.type == \"linux\" and auditd.data.syscall == \"openat\" and file.path\
      \ == \"/proc\" and\n   auditd.data.a0 : (\"ffffffffffffff9c\", \"ffffff9c\"\
      ) and auditd.data.a2 : (\"80000\", \"88000\") and\n   not process.name in (\"\
      agentbeat\", \"packetbeat\")\n  ] with runs=10"
  condition: selection
  _conversion_note: Complex EQL with sequence - requires manual review
tags:
- attack.discovery
- attack.t1057
- attack.t1082
references:
- https://github.com/DominicBreuker/pspy
