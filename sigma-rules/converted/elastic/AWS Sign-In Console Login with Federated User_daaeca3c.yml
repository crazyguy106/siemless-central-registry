title: AWS Sign-In Console Login with Federated User
id: 1f45720e-5ea8-11ef-90d2-f661ea17fbce
status: stable
level: medium
description: 'Identifies when a federated user logs into the AWS Management Console.
  Federated users are typically given temporary

  credentials to access AWS services. If a federated user logs into the AWS Management
  Console without using MFA, it may

  indicate a security risk, as MFA adds an additional layer of security to the authentication
  process. However, CloudTrail

  does not record whether a Federated User utilized MFA as part of authentication
  — that MFA decision often occurs at a

  third-party IdP (e.g., Okta, Azure AD, Google). As a result, CloudTrail fields such
  as MFAUsed / mfaAuthenticated appear

  as “No/false” for federated console logins even if IdP MFA was required. This alert
  should be correlated with IdP

  authentication logs to verify whether MFA was enforced for the session. Increase
  priority if you find a related

  "GetSigninToken" event whose source IP / ASN / geo or user-agent differs from the
  subsequent "ConsoleLogin" (possible

  token relay/abuse). Same-IP/UA pairs within a short window are more consistent with
  expected operator behavior and can

  be triaged with lower severity.'
author: Elastic (converted by SIEMLess)
date: '2024-08-19'
modified: '2025-10-09'
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    event_dataset: aws.cloudtrail
    event_provider: signin.amazonaws.com
    event_action: ConsoleLogin
    aws_cloudtrail_user_identity_type: FederatedUser
    event_outcome: success
  condition: selection
tags:
- attack.initial_access
- attack.t1078.004
- attack.t1078
references:
- https://hackingthe.cloud/aws/post_exploitation/create_a_console_session_from_iam_credentials/
