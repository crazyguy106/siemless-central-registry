title: Unusual Network Connection via RunDLL32
id: 52aaab7b-b51c-441a-89ce-4387b3aea886
status: stable
level: medium
description: 'Identifies unusual instances of rundll32.exe making outbound network
  connections. This may indicate adversarial Command

  and Control activity.'
author: Elastic (converted by SIEMLess)
date: '2020-02-18'
modified: '2025-08-28'
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    _original_eql: "sequence by host.id, process.entity_id with maxspan=1m\n  [process\
      \ where host.os.type == \"windows\" and event.type == \"start\" and process.name\
      \ : \"rundll32.exe\" and\n  (\n    process.args_count == 1 and\n\n    /* Excludes\
      \ bug where a missing closing quote sets args_count to 1 despite extra args\
      \ */\n    not process.command_line regex~ \"\"\"\\\".*\\.exe[^\\\"].* \"\"\"\
      \  )]\n  [network where host.os.type == \"windows\" and process.name : \"rundll32.exe\"\
      \ and\n   not cidrmatch(destination.ip, \"10.0.0.0/8\", \"127.0.0.0/8\", \"\
      169.254.0.0/16\", \"172.16.0.0/12\", \"192.0.0.0/24\",\n       \"192.0.0.0/29\"\
      , \"192.0.0.8/32\", \"192.0.0.9/32\", \"192.0.0.10/32\", \"192.0.0.170/32\"\
      , \"192.0.0.171/32\",\n       \"192.0.2.0/24\", \"192.31.196.0/24\", \"192.52.193.0/24\"\
      , \"192.168.0.0/16\", \"192.88.99.0/24\", \"224.0.0.0/4\",\n       \"100.64.0.0/10\"\
      , \"192.175.48.0/24\",\"198.18.0.0/15\", \"198.51.100.0/24\", \"203.0.113.0/24\"\
      , \"240.0.0.0/4\", \"::1\",\n       \"FE80::/10\", \"FF00::/8\")]"
  condition: selection
  _conversion_note: Complex EQL with sequence - requires manual review
tags:
- attack.defense_evasion
- attack.command_and_control
- attack.t1071.001
- attack.t1218.011
- attack.t1218
- attack.t1071
references:
- https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml
- https://redcanary.com/threat-detection-report/techniques/rundll32/
