title: Privilege Escalation via SUID/SGID
id: 28eb3afe-131d-48b0-a8fc-9784f3d54f3c
status: stable
level: medium
description: 'Identifies instances where a process is executed with user/group ID
  0 (root), and a real user/group ID that is not 0.

  This is indicative of a process that has been granted SUID/SGID permissions, allowing
  it to run with elevated

  privileges. Attackers may leverage a misconfiguration for exploitation in order
  to escalate their privileges to root, or

  establish a backdoor for persistence.'
author: Elastic (converted by SIEMLess)
date: '2024-06-17'
modified: '2025-07-02'
logsource:
  product: linux
  category: process_creation
detection:
  selection:
    _original_eql: "process where host.os.type == \"linux\" and event.type == \"start\"\
      \ and event.action == \"exec\" and (\n  (process.user.id == \"0\" and process.real_user.id\
      \ != \"0\") or\n  (process.group.id == \"0\" and process.real_group.id != \"\
      0\")\n) and (\n  process.name in (\n    \"aa-exec\", \"ab\", \"agetty\", \"\
      alpine\", \"ar\", \"arj\", \"arp\", \"as\", \"ascii-xfr\", \"ash\", \"aspell\"\
      ,\n    \"atobm\", \"awk\", \"base32\", \"base64\", \"basenc\", \"basez\", \"\
      bash\", \"bc\", \"bridge\", \"busctl\",\n    \"busybox\", \"bzip2\", \"cabal\"\
      , \"capsh\", \"cat\", \"choom\", \"chown\", \"chroot\", \"clamscan\", \"cmp\"\
      ,\n    \"column\", \"comm\", \"cp\", \"cpio\", \"cpulimit\", \"csh\", \"csplit\"\
      , \"csvtool\", \"cupsfilter\", \"curl\",\n    \"cut\", \"dash\", \"date\", \"\
      dd\", \"debugfs\", \"dialog\", \"diff\", \"dig\", \"distcc\", \"dmsetup\", \"\
      docker\",\n    \"dosbox\", \"ed\", \"efax\", \"elvish\", \"emacs\", \"env\"\
      , \"eqn\", \"espeak\", \"expand\", \"expect\", \"file\",\n    \"find\", \"fish\"\
      , \"flock\", \"fmt\", \"fold\", \"gawk\", \"gcore\", \"gdb\", \"genie\", \"\
      genisoimage\", \"gimp\",\n    \"grep\", \"gtester\", \"gzip\", \"hd\", \"head\"\
      , \"hexdump\", \"highlight\", \"hping3\", \"iconv\", \"install\",\n    \"ionice\"\
      , \"ispell\", \"jjs\", \"join\", \"jq\", \"jrunscript\", \"julia\", \"ksh\"\
      , \"ksshell\", \"kubectl\",\n    \"ld.so\", \"less\", \"links\", \"logsave\"\
      , \"look\", \"lua\", \"make\", \"mawk\", \"minicom\", \"more\",\n    \"mosquitto\"\
      , \"msgattrib\", \"msgcat\", \"msgconv\", \"msgfilter\", \"msgmerge\", \"msguniq\"\
      , \"multitime\",\n    \"mv\", \"nasm\", \"nawk\", \"ncftp\", \"nft\", \"nice\"\
      , \"nl\", \"nm\", \"nmap\", \"node\", \"nohup\", \"ntpdate\",\n    \"od\", \"\
      openssl\", \"openvpn\", \"pandoc\", \"paste\", \"perf\", \"perl\", \"pexec\"\
      , \"pg\", \"php\", \"pidstat\",\n    \"pr\", \"ptx\", \"python\", \"rc\", \"\
      readelf\", \"restic\", \"rev\", \"rlwrap\", \"rsync\", \"rtorrent\",\n    \"\
      run-parts\", \"rview\", \"rvim\", \"sash\", \"scanmem\", \"sed\", \"setarch\"\
      , \"setfacl\", \"setlock\", \"shuf\",\n    \"soelim\", \"softlimit\", \"sort\"\
      , \"sqlite3\", \"ss\", \"ssh-agent\", \"ssh-keygen\", \"ssh-keyscan\",\n   \
      \ \"sshpass\", \"start-stop-daemon\", \"stdbuf\", \"strace\", \"strings\", \"\
      sysctl\", \"systemctl\", \"tac\",\n    \"tail\", \"taskset\", \"tbl\", \"tclsh\"\
      , \"tee\", \"terraform\", \"tftp\", \"tic\", \"time\", \"timeout\", \"troff\"\
      ,\n    \"ul\", \"unexpand\", \"uniq\", \"unshare\", \"unsquashfs\", \"unzip\"\
      , \"update-alternatives\", \"uudecode\",\n    \"uuencode\", \"vagrant\", \"\
      varnishncsa\", \"view\", \"vigr\", \"vim\", \"vimdiff\", \"vipw\", \"w3m\",\
      \ \"watch\",\n    \"wc\", \"wget\", \"whiptail\", \"xargs\", \"xdotool\", \"\
      xmodmap\", \"xmore\", \"xxd\", \"xz\", \"yash\", \"zsh\",\n    \"zsoelim\"\n\
      \  ) or\n  process.name == \"ip\" and (\n    (process.args == \"-force\" and\
      \ process.args in (\"-batch\", \"-b\")) or (process.args == \"exec\")\n  )\n\
      ) and not process.parent.name == \"spine\""
  condition: selection
  _conversion_note: Complex EQL with join - requires manual review
tags:
- attack.persistence
- attack.privilege_escalation
- attack.t1548.001
- attack.t1068
- attack.t1548
references:
- https://gtfobins.github.io/#+suid
- https://www.elastic.co/security-labs/primer-on-persistence-mechanisms
