title: Suspicious WMIC XSL Script Execution
id: 7f370d54-c0eb-4270-ac5a-9a6020585dc6
status: stable
level: medium
description: 'Identifies WMIC allowlist bypass techniques by alerting on suspicious
  execution of scripts. When WMIC loads scripting

  libraries it may be indicative of an allowlist bypass.'
author: Elastic (converted by SIEMLess)
date: '2020-09-02'
modified: '2025-03-20'
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    _original_eql: "sequence by process.entity_id with maxspan = 2m\n[process where\
      \ host.os.type == \"windows\" and event.type == \"start\" and\n   (process.name\
      \ : \"WMIC.exe\" or process.pe.original_file_name : \"wmic.exe\") and\n   process.args\
      \ : (\"format*:*\", \"/format*:*\", \"*-format*:*\") and\n   not process.command_line\
      \ : (\"* /format:table *\", \"* /format:table\")]\n[any where host.os.type ==\
      \ \"windows\" and (event.category == \"library\" or (event.category == \"process\"\
      \ and event.action : \"Image loaded*\")) and\n (?dll.name : (\"jscript.dll\"\
      , \"vbscript.dll\") or file.name : (\"jscript.dll\", \"vbscript.dll\"))]"
  condition: selection
  _conversion_note: Complex EQL with sequence - requires manual review
tags:
- attack.defense_evasion
- attack.execution
- attack.t1220
- attack.t1047
