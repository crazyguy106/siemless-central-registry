title: Process Creation via Secondary Logon
id: 42eeee3d-947f-46d3-a14d-7036b962c266
status: stable
level: medium
description: 'Identifies process creation with alternate credentials. Adversaries
  may create a new process with a different token to

  escalate privileges and bypass access controls.'
author: Elastic (converted by SIEMLess)
date: '2022-08-30'
modified: '2025-11-14'
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    _original_eql: "sequence by winlog.computer_name with maxspan=1m\n\n[authentication\
      \ where host.os.type == \"windows\" and event.action:\"logged-in\" and\n event.outcome\
      \ == \"success\" and user.id : (\"S-1-5-21-*\", \"S-1-12-1-*\") and\n\n /* seclogon\
      \ service */\n process.name == \"svchost.exe\" and\n winlog.event_data.LogonProcessName\
      \ : \"seclogo*\" and source.ip == \"::1\" ] by winlog.event_data.TargetLogonId\n\
      \n[process where host.os.type == \"windows\" and event.type == \"start\"] by\
      \ winlog.event_data.TargetLogonId"
  condition: selection
  _conversion_note: Complex EQL with sequence - requires manual review
tags:
- attack.privilege_escalation
- attack.t1134
- attack.t1134.002
- attack.t1134.003
references:
- https://attack.mitre.org/techniques/T1134/002/
