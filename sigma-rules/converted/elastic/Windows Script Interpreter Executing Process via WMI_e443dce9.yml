title: Windows Script Interpreter Executing Process via WMI
id: b64b183e-1a76-422d-9179-7b389513e74d
status: stable
level: medium
description: 'Identifies use of the built-in Windows script interpreters (cscript.exe
  or wscript.exe) being used to execute a process

  via Windows Management Instrumentation (WMI). This may be indicative of malicious
  activity.'
author: Elastic (converted by SIEMLess)
date: '2020-11-27'
modified: '2025-03-20'
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    _original_eql: "sequence by host.id with maxspan = 5s\n    [any where host.os.type\
      \ == \"windows\" and\n     (event.category : (\"library\", \"driver\") or (event.category\
      \ == \"process\" and event.action : \"Image loaded*\")) and\n     (?dll.name\
      \ : \"wmiutils.dll\" or file.name : \"wmiutils.dll\") and process.name : (\"\
      wscript.exe\", \"cscript.exe\")]\n    [process where host.os.type == \"windows\"\
      \ and event.type == \"start\" and\n     process.parent.name : \"wmiprvse.exe\"\
      \ and\n     user.domain != \"NT AUTHORITY\" and\n     (process.pe.original_file_name\
      \ :\n        (\n          \"cscript.exe\",\n          \"wscript.exe\",\n   \
      \       \"PowerShell.EXE\",\n          \"Cmd.Exe\",\n          \"MSHTA.EXE\"\
      ,\n          \"RUNDLL32.EXE\",\n          \"REGSVR32.EXE\",\n          \"MSBuild.exe\"\
      ,\n          \"InstallUtil.exe\",\n          \"RegAsm.exe\",\n          \"RegSvcs.exe\"\
      ,\n          \"msxsl.exe\",\n          \"CONTROL.EXE\",\n          \"EXPLORER.EXE\"\
      ,\n          \"Microsoft.Workflow.Compiler.exe\",\n          \"msiexec.exe\"\
      \n        ) or\n      process.executable : (\"C:\\\\Users\\\\*.exe\", \"C:\\\
      \\ProgramData\\\\*.exe\")\n     )\n    ]"
  condition: selection
  _conversion_note: Complex EQL with sequence - requires manual review
tags:
- attack.initial_access
- attack.execution
- attack.t1566
- attack.t1059.005
- attack.t1059
- attack.t1566.001
- attack.t1047
