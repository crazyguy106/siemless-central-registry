title: AWS IAM AdministratorAccess Policy Attached to Role
id: dde13d58-bc39-4aa0-87fd-b4bdbf4591da
status: stable
level: medium
description: 'An adversary with access to a set of compromised credentials may attempt
  to persist or escalate privileges by attaching

  additional permissions to compromised IAM roles. This rule looks for use of the
  IAM AttachRolePolicy API operation to

  attach the highly permissive AdministratorAccess AWS managed policy to an existing
  IAM role.'
author: Elastic (converted by SIEMLess)
date: '2024-05-31'
modified: '2025-10-13'
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    event_dataset: aws.cloudtrail
    event_provider: iam.amazonaws.com
    event_action: AttachRolePolicy
    event_outcome: success
  condition: selection
tags:
- attack.persistence
- attack.privilege_escalation
- attack.t1098
- attack.t1098.003
references:
- https://docs.aws.amazon.com/IAM/latest/APIReference/API_AttachRolePolicy.html
- https://docs.aws.amazon.com/aws-managed-policy/latest/reference/AdministratorAccess.html
- https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/
falsepositives:
- "    While this can be normal behavior, it should be investigated to ensure validity.\
  \ Verify whether the user identity\n    should be using the IAM `AttachRolePolicy`\
  \ API operation to attach the `AdministratorAccess` policy to the target\n    role.\n\
  \    "
