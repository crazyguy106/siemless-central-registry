title: Network Connection via Sudo Binary
id: 30e1e9f2-eb9c-439f-aff6-1e3068e99384
status: stable
level: low
description: 'Detects network connections initiated by the "sudo" binary. This behavior
  is uncommon and may occur in instances where

  reverse shell shellcode is injected into a process run with elevated permissions
  via "sudo". Attackers may attempt to

  inject shellcode into processes running as root, to escalate privileges.'
author: Elastic (converted by SIEMLess)
date: '2024-01-15'
modified: '2025-02-04'
logsource:
  product: linux
  category: process_creation
detection:
  selection:
    _original_eql: "sequence by host.id, process.entity_id with maxspan=5s\n  [process\
      \ where host.os.type == \"linux\" and event.type == \"start\" and event.action\
      \ == \"exec\"]\n  [network where host.os.type == \"linux\" and event.type ==\
      \ \"start\" and\n  event.action in (\"connection_attempted\", \"ipv4_connection_attempt_event\"\
      ) and process.name == \"sudo\" and not (\n    destination.ip == null or destination.ip\
      \ == \"0.0.0.0\" or cidrmatch(\n      destination.ip, \"10.0.0.0/8\", \"127.0.0.0/8\"\
      , \"169.254.0.0/16\", \"172.16.0.0/12\", \"192.0.0.0/24\", \"192.0.0.0/29\"\
      ,\n      \"192.0.0.8/32\", \"192.0.0.9/32\", \"192.0.0.10/32\", \"192.0.0.170/32\"\
      , \"192.0.0.171/32\", \"192.0.2.0/24\",\n      \"192.31.196.0/24\", \"192.52.193.0/24\"\
      , \"192.168.0.0/16\", \"192.88.99.0/24\", \"224.0.0.0/4\", \"100.64.0.0/10\"\
      ,\n      \"192.175.48.0/24\",\"198.18.0.0/15\", \"198.51.100.0/24\", \"203.0.113.0/24\"\
      , \"240.0.0.0/4\", \"::1\", \"FE80::/10\",\n      \"FF00::/8\", \"172.31.0.0/16\"\
      \n    )\n  )]"
  condition: selection
  _conversion_note: Complex EQL with sequence - requires manual review
tags:
- attack.privilege_escalation
- attack.t1548.003
- attack.t1055.008
- attack.t1055
- attack.t1548
