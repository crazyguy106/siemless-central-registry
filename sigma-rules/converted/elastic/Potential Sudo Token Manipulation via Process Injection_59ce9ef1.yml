title: Potential Sudo Token Manipulation via Process Injection
id: ff9bc8b9-f03b-4283-be58-ee0a16f5a11b
status: stable
level: medium
description: 'This rule detects potential sudo token manipulation attacks through
  process injection by monitoring the use of a

  debugger (gdb) process followed by a successful uid change event during the execution
  of the sudo process. A sudo token

  manipulation attack is performed by injecting into a process that has a valid sudo
  token, which can then be used by

  attackers to activate their own sudo token. This attack requires ptrace to be enabled
  in conjunction with the existence

  of a living process that has a valid sudo token with the same uid as the current
  user.'
author: Elastic (converted by SIEMLess)
date: '2023-07-31'
modified: '2025-07-02'
logsource:
  product: linux
  category: process_creation
detection:
  selection:
    _original_eql: "sequence by host.id, process.session_leader.entity_id with maxspan=15s\n\
      [ process where host.os.type == \"linux\" and event.type == \"start\" and event.action\
      \ == \"exec\" and\n  process.name == \"gdb\" and process.user.id != \"0\" and\
      \ process.group.id != \"0\" ]\n[ process where host.os.type == \"linux\" and\
      \ event.action == \"uid_change\" and event.type == \"change\" and\n  process.name\
      \ == \"sudo\" and process.user.id == \"0\" and process.group.id == \"0\" ]"
  condition: selection
  _conversion_note: Complex EQL with sequence - requires manual review
tags:
- attack.privilege_escalation
- attack.t1548.003
- attack.t1055.008
- attack.t1055
- attack.t1548
references:
- https://github.com/nongiach/sudo_inject
