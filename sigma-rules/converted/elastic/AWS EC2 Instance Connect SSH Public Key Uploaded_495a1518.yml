title: AWS EC2 Instance Connect SSH Public Key Uploaded
id: 873b5452-074e-11ef-852e-f661ea17fbcc
status: stable
level: medium
description: 'Identifies when a new SSH public key is uploaded to an AWS EC2 instance
  using the EC2 Instance Connect service. This

  action could indicate an adversary attempting to maintain access to the instance.
  The rule detects the

  SendSerialConsoleSSHPublicKey or SendSSHPublicKey API actions, which are logged
  when manually uploading an SSH key

  to an EC2 instance or serial connection. It is important to know that this API call
  happens automatically by the EC2

  Instance Connect service when a user connects to an EC2 instance using the EC2 Instance
  Connect service via the CLI or

  AWS Management Console.'
author: Elastic (converted by SIEMLess)
date: '2024-04-30'
modified: '2025-09-05'
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    event_dataset: aws.cloudtrail
    event_provider: ec2-instance-connect.amazonaws.com
    event_action: (SendSSHPublicKey
    event_outcome: success
  condition: selection
tags:
- attack.lateral_movement
- attack.privilege_escalation
- attack.t1098
- attack.t1021.004
- attack.t1098.004
- attack.t1021
references:
- https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques
- https://medium.parttimepolymath.net/aws-ec2-instance-connect-a-very-neat-trick-4d2fc0c28010
- https://stratus-red-team.cloud/attack-techniques/AWS/aws.lateral-movement.ec2-instance-connect/
- https://cloud.hacktricks.xyz/pentesting-cloud/aws-security/aws-privilege-escalation/aws-ec2-privesc
- https://docs.aws.amazon.com/ec2-instance-connect/latest/APIReference/API_SendSSHPublicKey.html
- https://docs.aws.amazon.com/ec2-instance-connect/latest/APIReference/API_SendSerialConsoleSSHPublicKey.html
falsepositives:
- Administrators may upload SSH public keys to EC2 instances for legitimate purposes.
