title: Network Connections Initiated Through XDG Autostart Entry
id: dd52d45a-4602-4195-9018-ebe0f219c273
status: stable
level: medium
description: 'Detects network connections initiated through Cross-Desktop Group (XDG)
  autostart entries for GNOME and XFCE-based Linux

  distributions. XDG Autostart entries can be used to execute arbitrary commands or
  scripts when a user logs in. This rule

  helps to identify potential malicious activity where an attacker may have modified
  XDG autostart scripts to establish

  persistence on the system.'
author: Elastic (converted by SIEMLess)
date: '2024-06-03'
modified: '2025-02-04'
logsource:
  product: linux
  category: process_creation
detection:
  selection:
    _original_eql: "sequence by host.id, process.entity_id with maxspan=1s\n  [process\
      \ where host.os.type == \"linux\" and event.type == \"start\" and event.action\
      \ == \"exec\" and (\n     (process.parent.executable == \"/usr/bin/xfce4-session\"\
      ) or\n     (process.executable == \"/bin/sh\" and process.args == \"-e\" and\
      \ process.args == \"-u\" and\n      process.args == \"-c\" and process.args\
      \ : \"export GIO_LAUNCHED_DESKTOP_FILE_PID=$$;*\")\n   )\n  ]\n  [network where\
      \ host.os.type == \"linux\" and event.type == \"start\" and event.action ==\
      \ \"connection_attempted\" and not (\n     destination.ip == null or destination.ip\
      \ == \"0.0.0.0\" or cidrmatch(\n       destination.ip, \"10.0.0.0/8\", \"127.0.0.0/8\"\
      , \"169.254.0.0/16\", \"172.16.0.0/12\", \"192.0.0.0/24\", \"192.0.0.0/29\"\
      ,\n       \"192.0.0.8/32\", \"192.0.0.9/32\", \"192.0.0.10/32\", \"192.0.0.170/32\"\
      , \"192.0.0.171/32\", \"192.0.2.0/24\",\n       \"192.31.196.0/24\", \"192.52.193.0/24\"\
      , \"192.168.0.0/16\", \"192.88.99.0/24\", \"224.0.0.0/4\", \"100.64.0.0/10\"\
      ,\n       \"192.175.48.0/24\",\"198.18.0.0/15\", \"198.51.100.0/24\", \"203.0.113.0/24\"\
      , \"240.0.0.0/4\", \"::1\", \"FE80::/10\",\n       \"FF00::/8\", \"172.31.0.0/16\"\
      \n       ) or\n       process.name in (\n         \"telegram-desktop\", \"firefox\"\
      , \"gnome-calculator\", \"remmina\", \"spotify\", \"librewolf\", \"fortitraylauncher\"\
      ,\n         \"flameshot\", \"thunderbird\", \"update-manager\", \"warp-terminal\"\
      , \"obs\", \"transmission-gtk\"\n       )\n     )\n  ]"
  condition: selection
  _conversion_note: Complex EQL with sequence - requires manual review
tags:
- attack.persistence
- attack.t1547
- attack.t1547.013
references:
- https://specifications.freedesktop.org/autostart-spec/autostart-spec-latest.html
- https://hadess.io/the-art-of-linux-persistence/
- https://www.elastic.co/security-labs/primer-on-persistence-mechanisms
