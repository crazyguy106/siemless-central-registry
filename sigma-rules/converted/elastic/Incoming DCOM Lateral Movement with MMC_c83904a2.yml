title: Incoming DCOM Lateral Movement with MMC
id: 51ce96fb-9e52-4dad-b0ba-99b54440fc9a
status: stable
level: high
description: 'Identifies the use of Distributed Component Object Model (DCOM) to run
  commands from a remote host, which are launched

  via the MMC20 Application COM Object. This behavior may indicate an attacker abusing
  a DCOM application to move

  laterally.'
author: Elastic (converted by SIEMLess)
date: '2020-11-06'
modified: '2025-03-20'
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    _original_eql: "sequence by host.id with maxspan=1m\n [network where host.os.type\
      \ == \"windows\" and event.type == \"start\" and process.name : \"mmc.exe\"\
      \ and source.port >= 49152 and\n destination.port >= 49152 and source.ip !=\
      \ \"127.0.0.1\" and source.ip != \"::1\" and\n  network.direction : (\"incoming\"\
      , \"ingress\") and network.transport == \"tcp\"\n ] by process.entity_id\n [process\
      \ where host.os.type == \"windows\" and event.type == \"start\" and process.parent.name\
      \ : \"mmc.exe\"\n ] by process.parent.entity_id"
  condition: selection
  _conversion_note: Complex EQL with sequence - requires manual review
tags:
- attack.defense_evasion
- attack.lateral_movement
- attack.t1021.003
- attack.t1218.014
- attack.t1218
- attack.t1021
references:
- https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/
