title: Suspicious Passwd File Event Action
id: 71d6a53d-abbd-40df-afee-c21fff6aafb0
status: stable
level: medium
description: 'Monitors for the generation of a passwd password entry via openssl,
  followed by a file write activity on the

  "/etc/passwd" file. The "/etc/passwd" file in Linux stores user account information,
  including usernames, user IDs,

  group IDs, home directories, and default shell paths. Attackers may exploit a misconfiguration
  in the "/etc/passwd" file

  permissions or other privileges to add a new entry to the "/etc/passwd" file with
  root permissions, and leverage this

  new user account to login as root.'
author: Elastic (converted by SIEMLess)
date: '2024-01-22'
modified: '2025-02-04'
logsource:
  product: linux
  category: process_creation
detection:
  selection:
    _original_eql: "sequence by host.id, process.parent.pid with maxspan=1m\n  [process\
      \ where host.os.type == \"linux\" and event.type == \"start\" and event.action\
      \ == \"exec\" and\n   process.name == \"openssl\" and process.args == \"passwd\"\
      \ and user.id != \"0\"]\n  [file where host.os.type == \"linux\" and file.path\
      \ == \"/etc/passwd\" and process.parent.pid != 1 and\n   not auditd.data.a2\
      \ == \"80000\" and event.outcome == \"success\" and user.id != \"0\"]"
  condition: selection
  _conversion_note: Complex EQL with sequence - requires manual review
tags:
- attack.privilege_escalation
- attack.t1068
