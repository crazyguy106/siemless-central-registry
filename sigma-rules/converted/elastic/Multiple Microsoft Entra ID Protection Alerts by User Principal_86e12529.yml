title: Multiple Microsoft Entra ID Protection Alerts by User Principal
id: bcf0e362-0a2f-4f5e-9dd8-0d34f901781f
status: stable
level: high
description: 'Identifies more than two Microsoft Entra ID Protection alerts associated
  to the user principal in a short time period.

  Microsoft Entra ID Protection alerts are triggered by suspicious sign-in activity,
  such as anomalous IP addresses, risky

  sign-ins, or other risk detections. Multiple alerts in a short time frame may indicate
  an ongoing attack or compromised

  account.'
author: Elastic (converted by SIEMLess)
date: '2025-04-30'
modified: '2025-09-08'
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    _original_eql: 'sequence by azure.identityprotection.properties.user_principal_name
      with maxspan=10m

      [any where event.module == "azure" and event.dataset == "azure.identity_protection"]
      with runs=2'
  condition: selection
  _conversion_note: Complex EQL with sequence - requires manual review
tags:
- attack.initial_access
- attack.t1078.004
- attack.t1078
references:
- https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/reference-azure-monitor-sign-ins-log-schema
- https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/overview-identity-protection
- https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/howto-identity-protection-investigate-risk
- https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/howto-identity-protection-investigate-risk#investigation-framework
