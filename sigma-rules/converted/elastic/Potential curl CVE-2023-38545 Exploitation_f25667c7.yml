title: Potential curl CVE-2023-38545 Exploitation
id: f41296b4-9975-44d6-9486-514c6f635b2d
status: stable
level: medium
description: 'Detects potential exploitation of curl CVE-2023-38545 by monitoring
  for vulnerable command line arguments in conjunction

  with an unusual command line length. A flaw in curl version <= 8.3 makes curl vulnerable
  to a heap based buffer overflow

  during the SOCKS5 proxy handshake. Upgrade to curl version >= 8.4 to patch this
  vulnerability. This exploit can be

  executed with and without the use of environment variables. For increased visibility,
  enable the collection of

  http_proxy, HTTPS_PROXY and ALL_PROXY environment variables based on the instructions
  provided in the setup guide of

  this rule.'
author: Elastic (converted by SIEMLess)
date: '2023-10-11'
modified: '2025-02-04'
logsource:
  product: linux
  category: process_creation
detection:
  selection:
    host_os_type: linux
    event_type: start
    event_action: exec
    process_name: curl
  condition: selection
tags:
- attack.execution
- attack.t1203
references:
- https://curl.se/docs/CVE-2023-38545.html
- https://daniel.haxx.se/blog/2023/10/11/curl-8-4-0/
- https://twitter.com/_JohnHammond/status/1711986412554531015
