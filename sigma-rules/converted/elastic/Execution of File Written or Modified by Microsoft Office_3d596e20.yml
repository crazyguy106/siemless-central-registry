title: Execution of File Written or Modified by Microsoft Office
id: 0d8ad79f-9025-45d8-80c1-4f0cd3c5e8e5
status: stable
level: high
description: 'Identifies an executable created by a Microsoft Office application and
  subsequently executed. These processes are often

  launched via scripts inside documents or during exploitation of Microsoft Office
  applications.'
author: Elastic (converted by SIEMLess)
date: '2020-09-02'
modified: '2024-08-06'
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    _original_eql: "sequence with maxspan=2h\n  [file where host.os.type == \"windows\"\
      \ and event.type != \"deletion\" and file.extension : \"exe\" and\n     (process.name\
      \ : \"WINWORD.EXE\" or\n      process.name : \"EXCEL.EXE\" or\n      process.name\
      \ : \"OUTLOOK.EXE\" or\n      process.name : \"POWERPNT.EXE\" or\n      process.name\
      \ : \"eqnedt32.exe\" or\n      process.name : \"fltldr.exe\" or\n      process.name\
      \ : \"MSPUB.EXE\" or\n      process.name : \"MSACCESS.EXE\")\n  ] by host.id,\
      \ file.path\n  [process where host.os.type == \"windows\" and event.type ==\
      \ \"start\" and \n   not (process.name : \"NewOutlookInstaller.exe\" and process.code_signature.subject_name\
      \ : \"Microsoft Corporation\" and process.code_signature.trusted == true) and\
      \ \n   not (process.name : \"ShareFileForOutlook-v*.exe\" and process.code_signature.subject_name\
      \ : \"Citrix Systems, Inc.\" and process.code_signature.trusted == true)\n \
      \ ] by host.id, process.executable"
  condition: selection
  _conversion_note: Complex EQL with sequence - requires manual review
tags:
- attack.initial_access
- attack.execution
- attack.t1566
- attack.t1566.001
- attack.t1566.002
