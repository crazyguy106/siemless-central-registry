title: Incoming DCOM Lateral Movement with ShellBrowserWindow or ShellWindows
id: 8f919d4b-a5af-47ca-a594-6be59cd924a4
status: stable
level: medium
description: 'Identifies use of Distributed Component Object Model (DCOM) to run commands
  from a remote host, which are launched via

  the ShellBrowserWindow or ShellWindows Application COM Object. This behavior may
  indicate an attacker abusing a DCOM

  application to stealthily move laterally.'
author: Elastic (converted by SIEMLess)
date: '2020-11-06'
modified: '2025-03-20'
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    _original_eql: "sequence by host.id with maxspan=5s\n [network where host.os.type\
      \ == \"windows\" and event.type == \"start\" and process.name : \"explorer.exe\"\
      \ and\n  network.direction : (\"incoming\", \"ingress\") and network.transport\
      \ == \"tcp\" and\n  source.port > 49151 and destination.port > 49151 and source.ip\
      \ != \"127.0.0.1\" and source.ip != \"::1\"\n ] by process.entity_id\n [process\
      \ where host.os.type == \"windows\" and event.type == \"start\" and\n  process.parent.name\
      \ : \"explorer.exe\"\n ] by process.parent.entity_id"
  condition: selection
  _conversion_note: Complex EQL with sequence - requires manual review
tags:
- attack.lateral_movement
- attack.t1021.003
- attack.t1021
references:
- https://enigma0x3.net/2017/01/23/lateral-movement-via-dcom-round-2/
