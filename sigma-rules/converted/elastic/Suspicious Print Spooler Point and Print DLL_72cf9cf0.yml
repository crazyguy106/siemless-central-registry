title: Suspicious Print Spooler Point and Print DLL
id: bd7eefee-f671-494e-98df-f01daf9e5f17
status: stable
level: high
description: 'Detects attempts to exploit a privilege escalation vulnerability (CVE-2020-1030)
  related to the print spooler service.

  Exploitation involves chaining multiple primitives to load an arbitrary DLL into
  the print spooler process running as

  SYSTEM.'
author: Elastic (converted by SIEMLess)
date: '2020-11-26'
modified: '2025-08-28'
logsource:
  product: windows
  category: registry_event
detection:
  selection:
    _original_eql: "sequence by host.id with maxspan=30s\n[registry where host.os.type\
      \ == \"windows\" and\n   registry.value : \"SpoolDirectory\" and\n   registry.path\
      \ : \"*\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print\\\\\
      Printers\\\\*\\\\SpoolDirectory\" and\n   registry.data.strings : \"C:\\\\Windows\\\
      \\System32\\\\spool\\\\drivers\\\\x64\\\\4\"]\n[registry where host.os.type\
      \ == \"windows\" and\n   registry.value : \"Module\" and\n   registry.path :\
      \ \"*\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print\\\\\
      Printers\\\\*\\\\CopyFiles\\\\Payload\\\\Module\" and\n   registry.data.strings\
      \ : \"C:\\\\Windows\\\\System32\\\\spool\\\\drivers\\\\x64\\\\4\\\\*\"]"
  condition: selection
  _conversion_note: Complex EQL with sequence - requires manual review
tags:
- attack.privilege_escalation
- attack.t1068
references:
- https://www.accenture.com/us-en/blogs/cyber-defense/discovering-exploiting-shutting-down-dangerous-windows-print-spooler-vulnerability
- https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES/blob/master/Privilege%20Escalation/privesc_sysmon_cve_20201030_spooler.evtx
- https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2020-1030
