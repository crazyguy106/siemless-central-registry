title: Potential privilege escalation via CVE-2022-38028
id: dffbd37c-d4c5-46f8-9181-5afdd9172b4c
status: stable
level: high
description: Identifies a privilege escalation attempt via exploiting CVE-2022-38028
  to hijack the print spooler service execution.
author: Elastic (converted by SIEMLess)
date: '2024-04-23'
modified: '2025-09-11'
logsource:
  product: windows
  category: file_event
detection:
  selection:
    host_os_type: windows
    file_path|contains:
    - ?:\\$WINDOWS.~BT\\NewOS\\Windows\\WinSxS\\*\\MPDW-constraints.js
    - \\Device\\HarddiskVolume*\\$WINDOWS.~BT\\NewOS\\Windows\\WinSxS\\*\\MPDW-constraints.js
    process_executable|contains:
    - ?:\\$WINDOWS.~BT\\Sources\\SetupHost.exe
    - ?:\\Windows\\System32\\taskhostw.exe
  condition: selection
tags:
- attack.defense_evasion
- attack.privilege_escalation
- attack.t1068
- attack.t1036
references:
- https://www.microsoft.com/en-us/security/blog/2024/04/22/analyzing-forest-blizzards-custom-post-compromise-tool-for-exploiting-cve-2022-38028-to-obtain-credentials/
