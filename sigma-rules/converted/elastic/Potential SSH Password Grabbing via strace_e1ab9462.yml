title: Potential SSH Password Grabbing via strace
id: 9eaa3fb1-3f70-48ed-bb0e-d7ae4d3c8f28
status: stable
level: medium
description: 'Detects potential SSH password grabbing via the use of strace on sshd
  processes. Attackers may use strace to capture

  sensitive information, such as passwords, by tracing system calls made by the sshd
  process. This rule looks for a sequence

  of events where an sshd process ends followed closely by the start of a strace process.
  This may be indicative of an attacker

  attempting to capture SSH credentials.'
author: Elastic (converted by SIEMLess)
date: '2025-11-10'
modified: '2025-11-10'
logsource:
  product: linux
  category: process_creation
detection:
  selection:
    _original_eql: "sequence by host.id with maxspan=3s\n  [process where host.os.type\
      \ == \"linux\" and event.type == \"end\" and process.name == \"sshd\"]\n  [process\
      \ where host.os.type == \"linux\" and event.type == \"start\" and event.action\
      \ == \"exec\" and process.name == \"strace\"]"
  condition: selection
  _conversion_note: Complex EQL with sequence - requires manual review
tags:
- attack.persistence
- attack.credential_access
- attack.t1556
- attack.t1554
references:
- https://github.com/braindead-sec/ssh-grabber
- https://dfir.ch/posts/strace/
